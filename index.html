<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Dieta Personalizada - Dra. Giovana Nutricionista</title>

    
    <!-- Meta Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1002938195345180');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1002938195345180&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->

     <!-- Clarity tracking code -->
<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "rtz89p15pn");
    
</script>
<!-- ✅ OTIMIZAÇÕES CRÍTICAS -->
<meta http-equiv="Cache-Control" content="public, max-age=31536000">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//www.facebook.com">
    <!-- ✅ FONTS OTIMIZADAS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

    <style>
    
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2c7a2c;
            --secondary: #4a9f4a;
            --accent: #6cc04a;
            --dark: #0a0a0a;
            --light: #ffffff;
            --gray: #1a1a1a;
            --success: #00ff88;
            --danger: #ff3366;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: 
                radial-gradient(circle at 20% 80%, rgba(44, 122, 44, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(108, 192, 74, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(74, 159, 74, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            color: var(--light);
        }

        /* ✨ CONTADOR DE USUÁRIOS ATIVOS - DESIGN ELEGANTE */
        #activeUsersCounter {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 50px;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.4),
                0 0 20px rgba(0, 255, 136, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateX(100%);
            opacity: 0;
            animation: slideInCounter 1s ease-out 2s forwards;
        }

        @keyframes slideInCounter {
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        #activeUsersCounter:hover {
            transform: translateX(0) scale(1.05);
            border-color: rgba(0, 255, 136, 0.6);
            box-shadow: 
                0 12px 48px rgba(0, 0, 0, 0.5),
                0 0 30px rgba(0, 255, 136, 0.4);
        }

        .active-indicator {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulseGreen 2s ease-in-out infinite;
            position: relative;
        }

        .active-indicator::after {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: var(--success);
            border-radius: 50%;
            opacity: 0.3;
            animation: pulseGreen 2s ease-in-out infinite 0.5s;
        }

        @keyframes pulseGreen {
            0%, 100% { 
                transform: scale(1); 
                opacity: 1; 
            }
            50% { 
                transform: scale(1.4); 
                opacity: 0.7; 
            }
        }

        .counter-text {
            font-size: 13px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            letter-spacing: 0.3px;
        }

        .counter-number {
            font-size: 15px;
            font-weight: 800;
            color: var(--success);
            margin: 0 2px;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .counter-number.updating {
            transform: scale(1.2);
            color: #00ff88;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        /* ✨ VERSÃO MOBILE DO CONTADOR */
        @media (max-width: 768px) {
            #activeUsersCounter {
                top: 70px;
                right: 12px;
                padding: 10px 16px;
                border-radius: 25px;
                max-width: calc(100vw - 24px);
            }
            
            .counter-text {
                font-size: 12px;
            }
            
            .counter-number {
                font-size: 14px;
            }
            
            #activeUsersCounter:hover {
                transform: translateX(0) scale(1.02);
            }
        }
 .option-card:hover:not(.selected):not([data-processing="true"]) {
            transform: translateY(-4px) scale(1.01) !important;
            border-color: rgba(44, 122, 44, 0.4) !important;
            background: rgba(44, 122, 44, 0.05) !important;
            box-shadow: 0 12px 24px rgba(44, 122, 44, 0.15) !important;
        }

        .option-card[data-processing="true"] {
            pointer-events: none !important;
            opacity: 0.8 !important;
        }
        /* ✨ CONTADOR ALTERNATIVO PARA LANDING PAGE */
        #landingUsersInfo {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 25px;
            padding: 8px 16px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--success);
            font-weight: 600;
            margin-left: 15px;
            animation: gentlePulse 3s ease-in-out infinite;
        }

        @keyframes gentlePulse {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.02); }
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--accent);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
            opacity: 0.3;
        }

        .particle:nth-child(odd) {
            background: var(--primary);
            animation-duration: 8s;
        }

        .particle:nth-child(3n) {
            background: var(--secondary);
            animation-duration: 10s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.3; }
            50% { transform: translateY(-100px) rotate(180deg); opacity: 0.8; }
        }

        .header {
            position: relative;
            z-index: 100;
            padding: 20px 0;
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(44, 122, 44, 0.2);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 0 4px 20px rgba(44, 122, 44, 0.3);
        }

        .trust-indicators {
            display: flex;
            align-items: center;
            gap: 20px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .trust-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            min-height: calc(100vh - 80px);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 10;
        }

        .landing-card, .quiz-card {
            background: rgba(26, 26, 26, 0.9);
            backdrop-filter: blur(30px);
            border-radius: 32px;
            padding: 50px;
            width: 100%;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(44, 122, 44, 0.2);
            box-shadow: 
                0 32px 64px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transform: translateY(20px);
            opacity: 0;
            animation: slideInUp 1s ease-out 0.2s forwards;
            text-align: center;
        }

        @keyframes slideInUp {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .landing-card::before, .quiz-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--primary), var(--accent), var(--secondary));
            border-radius: 32px;
            padding: 2px;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: xor;
            -webkit-mask-composite: xor;
            opacity: 0.6;
            animation: borderGlow 3s ease-in-out infinite alternate;
        }

        @keyframes borderGlow {
            0% { opacity: 0.3; }
            100% { opacity: 0.8; }
        }

        .badge {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            margin-bottom: 30px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes pulseBright {
            0% { 
                transform: scale(1); 
                box-shadow: 0 8px 32px rgba(0, 255, 100, 0.4), 0 0 20px rgba(0, 255, 100, 0.3);
            }
            50% { 
                transform: scale(1.05); 
                box-shadow: 0 15px 50px rgba(0, 255, 100, 0.7), 0 0 40px rgba(0, 255, 100, 0.6);
            }
            100% { 
                transform: scale(1); 
                box-shadow: 0 8px 32px rgba(0, 255, 100, 0.4), 0 0 20px rgba(0, 255, 100, 0.3);
            }
        }

        .main-title {
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--light), rgba(255, 255, 255, 0.8));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }

        .subtitle {
            font-size: 22px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 40px;
            line-height: 1.4;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .doctor-section {
            margin: 50px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .doctor-photo {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            position: relative;
            animation: float-gentle 3s ease-in-out infinite;
            overflow: hidden;
            box-shadow: 
                0 20px 40px rgba(44, 122, 44, 0.3),
                inset 0 4px 8px rgba(255, 255, 255, 0.1);
        }

        .doctor-photo::after {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 50%;
            z-index: -1;
            opacity: 0.5;
            animation: pulse 2s ease-in-out infinite;
        }

        .doctor-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            border: 4px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes float-gentle {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .doctor-info {
            max-width: 600px;
        }

        .doctor-name {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--accent), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .doctor-credentials {
            font-size: 18px;
            color: var(--accent);
            margin-bottom: 25px;
            font-weight: 600;
        }

        .doctor-description {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
            text-align: left;
            margin-bottom: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(44, 122, 44, 0.2);
        }

        .stat-number {
            font-size: 28px;
            font-weight: 900;
            color: var(--accent);
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 600;
        }

        .benefits-section {
            margin: 50px 0;
            text-align: left;
        }

        .benefits-title {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 30px;
            text-align: center;
            background: linear-gradient(135deg, var(--accent), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .benefit-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            border: 1px solid rgba(44, 122, 44, 0.2);
            transition: all 0.3s ease;
        }

        .benefit-item:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
            background: rgba(44, 122, 44, 0.1);
        }

        .benefit-icon {
            font-size: 24px;
            min-width: 24px;
        }

        .benefit-text {
            font-size: 15px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.4;
        }

        .cta-section {
            background: linear-gradient(135deg, rgba(44, 122, 44, 0.15), rgba(108, 192, 74, 0.1));
            border: 2px solid rgba(44, 122, 44, 0.3);
            border-radius: 24px;
            padding: 40px;
            margin-top: 40px;
        }

        .cta-title {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 15px;
            color: var(--light);
        }

        .cta-subtitle {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .cta-button {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(44, 122, 44, 0.4);
            width: 100%;
            max-width: 400px;
            position: relative;
            overflow: hidden;
        }

        .cta-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }

        .cta-button:hover::before {
            left: 100%;
        }

        .cta-button:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 12px 48px rgba(44, 122, 44, 0.6);
        }

        .disclaimer {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 20px;
            line-height: 1.4;
        }

        /* QUIZ STYLES */
        .progress-section {
            margin-bottom: 40px;
            position: relative;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .progress-text {
            font-size: 14px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .progress-doctor {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--accent);
            font-weight: 600;
        }

        .doctor-pulse {
            width: 8px;
            height: 8px;
            background: var(--accent);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
            border-radius: 10px;
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0%;
            position: relative;
            box-shadow: 0 0 20px rgba(44, 122, 44, 0.5);
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .question-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .question-number {
            width: 60px;
            height: 60px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 800;
            margin: 0 auto 20px;
            box-shadow: 0 8px 32px rgba(44, 122, 44, 0.4);
            position: relative;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .question-number::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 22px;
            z-index: -1;
            opacity: 0.3;
        }

        .question-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--light), rgba(255, 255, 255, 0.8));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }

        .question-subtitle {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.5;
            max-width: 600px;
            margin: 0 auto;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 50px;
        }

        .option-card {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 24px;
    padding: 30px;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    text-align: center;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
        }
.option-card:active {
    transform: translateY(-2px) scale(0.98);
    transition: transform 0.1s ease;
}

@media (max-width: 768px) {
    .options-grid {
        -webkit-overflow-scrolling: touch;
        touch-action: pan-y;
    }
    
    .option-card {
        min-height: 80px;
    }
}
        .option-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .option-card:hover::before {
            left: 100%;
        }

        .option-card:hover:not(.selected) {
    transform: translateY(-4px) scale(1.01);
    border-color: rgba(44, 122, 44, 0.4);
    box-shadow: 
        0 12px 24px rgba(44, 122, 44, 0.15),
        0 0 0 1px rgba(44, 122, 44, 0.1);
    background: rgba(44, 122, 44, 0.05);
}

.option-card.selected {
    transform: translateY(-8px) scale(1.05) !important;
    border-color: var(--primary) !important;
    background: linear-gradient(135deg, rgba(44, 122, 44, 0.2), rgba(108, 192, 74, 0.1)) !important;
    box-shadow: 
        0 24px 48px rgba(44, 122, 44, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2) !important;
}

        .option-card.selected .option-icon {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            transform: scale(1.1);
            box-shadow: 0 8px 32px rgba(44, 122, 44, 0.4);
        }

        .option-icon {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            margin: 0 auto 20px;
            transition: all 0.4s ease;
            position: relative;
        }

        .option-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--light);
        }

        .option-description {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.5;
        }

        .form-grid {
            display: grid;
            gap: 25px;
            margin-bottom: 50px;
        }

        .input-group {
            position: relative;
        }

        .input-label {
            display: block;
            font-size: 16px;
            font-weight: 600;
            color: var(--light);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .input-field {
            width: 100%;
            padding: 20px 24px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            font-size: 18px;
            color: var(--light);
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(44, 122, 44, 0.1);
            box-shadow: 0 0 0 4px rgba(44, 122, 44, 0.1);
            transform: translateY(-2px);
        }

        .input-field::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
        }

        .btn {
            padding: 18px 36px;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
            border: 2px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 8px 32px rgba(44, 122, 44, 0.4);
            position: relative;
            border: 2px solid transparent;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 12px 48px rgba(44, 122, 44, 0.6);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .results-container {
            text-align: center;
            animation: revealAnimation 1s ease-out;
        }

        .success-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: successBounce 1s ease-out;
        }

        @keyframes successBounce {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .reveal-title {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--success), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .reveal-subtitle {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 40px;
            line-height: 1.5;
        }

        .results-grid {
            display: grid;
            gap: 30px;
        }

        .mega-result-card {
            background: rgba(20, 20, 20, 0.95);
            border: 3px solid var(--primary);
            border-radius: 32px;
            padding: 40px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(44, 122, 44, 0.3);
            text-align: center;
        }

        .result-badge {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            margin-bottom: 20px;
        }

        .result-value {
            font-size: 72px;
            font-weight: 900;
            color: var(--danger);
            text-shadow: 0 0 30px rgba(255, 51, 102, 0.5);
            margin-bottom: 10px;
            animation: numberPulse 2s ease-in-out infinite;
        }

        .result-label {
            font-size: 24px;
            font-weight: 800;
            color: var(--accent);
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timeline-row {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(0, 0, 0, 0.4);
            padding: 12px 20px;
            border-radius: 12px;
            border: 1px solid rgba(44, 122, 44, 0.3);
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .results-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(44, 122, 44, 0.2);
        }

        .metric-card.calories {
            border-color: var(--primary);
            background: rgba(44, 122, 44, 0.1);
        }

        .metric-icon {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .metric-value {
            font-size: 32px;
            font-weight: 900;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .metric-label {
            font-size: 16px;
            font-weight: 700;
            color: var(--light);
            margin-bottom: 5px;
        }

        .metric-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }

        .cta-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(44, 122, 44, 0.4);
            width: 100%;
            max-width: 400px;
        }

        .cta-primary:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 12px 48px rgba(44, 122, 44, 0.6);
        }

        /* HIDE CLASSES */
        .hidden {
            display: none !important;
        }

        .cta-button.loading {
            pointer-events: none;
            opacity: 0.8;
        }

        .cta-button.loading::after {
            content: '';
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes revealAnimation {
            from { opacity: 0; transform: scale(0.9) translateY(30px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        
        @keyframes numberPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes doctorPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes processingGlow {
            0%, 100% { 
                border-color: rgba(44, 122, 44, 0.3); 
                box-shadow: 0 0 20px rgba(44, 122, 44, 0.2); 
            }
            50% { 
                border-color: rgba(44, 122, 44, 0.8); 
                box-shadow: 0 0 30px rgba(44, 122, 44, 0.5); 
            }
        }
        
        .processing {
            animation: processingGlow 2s ease-in-out infinite !important;
            background: rgba(44, 122, 44, 0.15) !important;
            border-color: rgba(44, 122, 44, 0.5) !important;
        }
        
        .completed {
            background: rgba(0, 255, 136, 0.15) !important;
            border-color: rgba(0, 255, 136, 0.5) !important;
        }
        
        @keyframes countUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .header {
                padding: 15px 0;
            }

            .header-content {
                flex-direction: column;
                gap: 12px;
                padding: 0 15px;
            }

            .trust-indicators {
                order: -1;
                flex-wrap: wrap;
                justify-content: center;
                gap: 15px;
            }

            .trust-item {
                font-size: 11px;
            }

            .logo {
                font-size: 20px;
            }

            .logo-icon {
                width: 35px;
                height: 35px;
                font-size: 18px;
            }

            .container {
                padding: 15px 12px;
                min-height: calc(100vh - 60px);
            }

            .landing-card, .quiz-card {
                padding: 25px 20px;
                border-radius: 20px;
                box-shadow: 
                    0 20px 40px rgba(0, 0, 0, 0.3),
                    inset 0 1px 0 rgba(255, 255, 255, 0.1);
            }

            .badge {
                font-size: 12px;
                padding: 6px 16px;
                margin-bottom: 25px;
            }

            .main-title {
                font-size: 28px;
                margin-bottom: 15px;
                line-height: 1.2;
            }

            .subtitle {
                font-size: 16px;
                margin-bottom: 25px;
                line-height: 1.4;
            }

            .doctor-section {
                margin: 35px 0;
                gap: 25px;
            }

            .doctor-photo {
                width: 140px;
                height: 140px;
            }

            .doctor-info {
                max-width: 100%;
            }

            .doctor-name {
                font-size: 22px;
                margin-bottom: 10px;
            }

            .doctor-credentials {
                font-size: 15px;
                margin-bottom: 18px;
            }

            .doctor-description {
                font-size: 14px;
                text-align: center;
                line-height: 1.5;
            }

            .doctor-description p {
                margin-bottom: 12px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                margin: 30px 0;
            }

            .stat-card {
                padding: 18px 12px;
                border-radius: 16px;
            }

            .stat-number {
                font-size: 22px;
                margin-bottom: 6px;
            }

            .stat-label {
                font-size: 12px;
                line-height: 1.2;
            }

            .benefits-section {
                margin: 35px 0;
            }

            .benefits-title {
                font-size: 22px;
                margin-bottom: 25px;
            }

            .benefits-grid {
                grid-template-columns: 1fr;
                gap: 12px;
                margin-bottom: 30px;
            }

            .benefit-item {
                padding: 16px;
                border-radius: 12px;
                gap: 12px;
            }

            .benefit-icon {
                font-size: 20px;
                min-width: 20px;
            }

            .benefit-text {
                font-size: 14px;
                line-height: 1.4;
            }

            .cta-section {
                padding: 25px 18px;
                border-radius: 18px;
                margin-top: 30px;
            }

            .cta-title {
                font-size: 20px;
                margin-bottom: 12px;
                line-height: 1.3;
            }

            .cta-subtitle {
                font-size: 14px;
                margin-bottom: 25px;
                line-height: 1.4;
            }

            .cta-button {
                padding: 16px 25px;
                font-size: 15px;
                border-radius: 12px;
                max-width: 100%;
                font-weight: 800;
                letter-spacing: 0.5px;
                line-height: 1.2;
            }

            .question-title {
                font-size: 20px;
                line-height: 1.2;
                margin-bottom: 12px;
            }

            .question-subtitle {
                font-size: 15px;
                margin-bottom: 25px;
            }

            .question-number {
                width: 45px;
                height: 45px;
                font-size: 18px;
                border-radius: 14px;
                margin-bottom: 15px;
            }

            .options-grid {
                grid-template-columns: 1fr;
                gap: 10px;
                margin-bottom: 35px;
            }

            .option-card {
                padding: 16px 14px;
                border-radius: 14px;
                min-height: 60px;
            }

            .option-icon {
                width: 50px;
                height: 50px;
                font-size: 22px;
                border-radius: 14px;
                margin: 0 auto 12px;
            }

            .option-title {
                font-size: 16px;
                margin-bottom: 6px;
            }

            .option-description {
                font-size: 12px;
                line-height: 1.3;
            }

            .action-buttons {
                flex-direction: column;
                gap: 10px;
            }

            .btn {
                width: 100%;
                padding: 14px 20px;
                font-size: 14px;
                border-radius: 12px;
                min-height: 48px;
            }

            .results-metrics {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .metric-card {
                padding: 16px 12px;
                border-radius: 14px;
            }

            .metric-icon {
                font-size: 24px;
                margin-bottom: 10px;
            }

            .metric-value {
                font-size: 20px;
                margin-bottom: 5px;
            }

            .metric-label {
                font-size: 13px;
                margin-bottom: 3px;
            }

            .metric-subtitle {
                font-size: 10px;
            }

            .form-grid {
                gap: 16px;
            }

            .input-field {
                padding: 14px 16px;
                font-size: 15px;
                border-radius: 10px;
                min-height: 48px;
            }

            .input-label {
                font-size: 13px;
                margin-bottom: 6px;
            }
            
            #social-notifications, #social-notifications-bottom {
                width: 220px !important;
                right: 8px !important;
            }
            
            #social-notifications {
                top: 8px !important;
            }
            
            #social-notifications-bottom {
                bottom: 8px !important;
            }

            .success-icon {
                font-size: 50px !important;
                margin-bottom: 12px !important;
            }
            
            .reveal-title {
                font-size: 24px !important;
                line-height: 1.1 !important;
                margin-bottom: 12px !important;
            }
            
            .reveal-subtitle {
                font-size: 14px !important;
                margin-bottom: 25px !important;
            }
            
            .result-value {
                font-size: 40px !important;
                margin-bottom: 6px !important;
            }
            
            .result-label {
                font-size: 16px !important;
                margin-bottom: 15px !important;
            }
            
            .mega-result-card {
                padding: 20px 15px !important;
                border-radius: 16px !important;
            }
            
            .cta-section {
                padding: 20px 15px !important;
                border-radius: 16px !important;
            }

            #landingUsersInfo {
                font-size: 11px;
                padding: 6px 12px;
                margin-left: 10px;
                gap: 6px;
            }
        }
    </style>
</head>
<body>
    <!-- ✨ CONTADOR DE USUÁRIOS ATIVOS FLUTUANTE -->
    <div id="activeUsersCounter">
        <div class="active-indicator"></div>
        <div class="counter-text">
            <span class="counter-number" id="activeCount">23</span> pessoas fazendo o quiz agora
        </div>
    </div>

    <div class="particles" id="particles"></div>

    <header class="header">
        <div class="header-content">
            <div class="trust-indicators">
                <div class="trust-item">
                    <span>🔒</span>
                    <span>Dados Seguros</span>
                </div>
                <div class="trust-item">
                    <span>⚡</span>
                    <span>Resultado em 2min</span>
                </div>
                <div class="trust-item">
                    <span>👥</span>
                    <span>+10.000 atendidos</span>
                </div>
            </div>
            <div class="logo">
                <div class="logo-icon">👩‍⚕️</div>
                <span>Dra. Giovana Nutricionista</span>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- ✅ LANDING PAGE ULTRA PERSUASIVA -->
<div class="landing-card" id="landingPage">
    <div class="badge">⚡ Resultado em 90 Segundos</div>
    
    <h1 class="main-title">Vamos montar sua dieta juntas?</h1>
    <p class="subtitle">
        <strong>Você só precisa responder 6 perguntas, clique no botão do final da tela</strong><br>
        Eu vou calcular as Calorias exatas + macros + 200 receitas baseado no SEU perfil
    </p>

    <div class="doctor-section">
        <div class="doctor-photo">
            <img src="Dra Giovana.png" alt="Dra. Giovana - Nutricionista" />
        </div>
        
        <div class="doctor-info">
            <h2 class="doctor-name">Dra. Giovana </h2>
            <p class="doctor-credentials">CRN-3 87654 • +10.000 Pessoas Transformadas</p>
            <div class="doctor-description">
                <p><strong>Especialista em Nutrição Personalizada.</strong> Criei um método científico que calcula suas necessidades exatas baseado em 6 informações-chave do seu perfil.</p>
                
                <p style="margin-top: 15px;"><strong>Resultado:</strong> Plano nutricional preciso que funciona porque é feito especificamente para VOCÊ.</p>
            </div>
        </div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">90s</div>
            <div class="stat-label">Para Completar</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">6</div>
            <div class="stat-label">Perguntas Apenas</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">+10k</div>
            <div class="stat-label">Já Transformaram</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">100%</div>
            <div class="stat-label">Personalizado</div>
        </div>
    </div>

    <div class="benefits-section">
        <h3 class="benefits-title">🚀 Você Vai Receber AGORA:</h3>
        
        <div class="benefits-grid">
            <div class="benefit-item">
                <div class="benefit-icon">🎯</div>
                <div class="benefit-text">
                    <strong>Suas Calorias Exatas:</strong> Calculadas para seu peso, idade e objetivo específico
                </div>
            </div>
            
            <div class="benefit-item">
                <div class="benefit-icon">⚖️</div>
                <div class="benefit-text">
                    <strong>Macros Perfeitos:</strong> Quantidade certa de proteína, carbo e gordura para VOCÊ
                </div>
            </div>
            
            <div class="benefit-item">
                <div class="benefit-icon">📊</div>
                <div class="benefit-text">
                    <strong>Projeção de Resultados:</strong> Quanto peso vai perder/ganhar e em quantos meses
                </div>
            </div>
            
            <div class="benefit-item">
                <div class="benefit-icon">🍽️</div>
                <div class="benefit-text">
                    <strong>200+ Receitas Adaptadas:</strong> Respeitando suas restrições e preferências
                </div>
            </div>
            
            <div class="benefit-item">
                <div class="benefit-icon">📱</div>
                <div class="benefit-text">
                    <strong>Lista de Compras Pronta:</strong> Ingredientes organizados por categoria
                </div>
            </div>
            
            <div class="benefit-item">
                <div class="benefit-icon">💚</div>
                <div class="benefit-text">
                    <strong>Adaptado à Sua Saúde:</strong> Considera diabetes, hipertensão, intolerâncias
                </div>
            </div>
        </div>
    </div>

    <!-- ✨ SEÇÃO DE URGÊNCIA ANTES DO CTA -->
    <div style="background: linear-gradient(135deg, rgba(255, 51, 102, 0.1), rgba(255, 193, 7, 0.1)); border: 2px solid rgba(255, 193, 7, 0.3); border-radius: 20px; padding: 25px; margin: 30px 0; text-align: center;">
        <h3 style="font-size: 20px; font-weight: 800; color: #FFD700; margin-bottom: 15px; line-height: 1.3;">
            ⏰ Milhares Já Estão Transformando Suas Vidas
        </h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
            <div style="background: rgba(0, 255, 136, 0.1); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 12px; padding: 15px;">
                <div style="font-size: 24px; font-weight: 900; color: var(--success);">+127</div>
                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.8);">Dietas criadas hoje</div>
            </div>
            <div style="background: rgba(44, 122, 44, 0.1); border: 1px solid rgba(44, 122, 44, 0.3); border-radius: 12px; padding: 15px;">
                <div style="font-size: 24px; font-weight: 900; color: var(--primary);">98%</div>
                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.8);">Conseguem resultados</div>
            </div>
            <div style="background: rgba(108, 192, 74, 0.1); border: 1px solid rgba(108, 192, 74, 0.3); border-radius: 12px; padding: 15px;">
                <div style="font-size: 24px; font-weight: 900; color: var(--accent);">2-4kg</div>
                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.8);">Perdem no 1º mês</div>
            </div>
        </div>
        <div style="background: rgba(0, 255, 136, 0.2); border: 1px solid rgba(0, 255, 136, 0.5); border-radius: 12px; padding: 15px;">
            <div style="font-size: 16px; font-weight: 800; color: var(--success); margin-bottom: 5px;">
                🔥 Não perca tempo com dietas genéricas
            </div>
            <div style="font-size: 14px; color: rgba(255, 255, 255, 0.9);">
                Sua dieta personalizada está a 6 perguntas de distância
            </div>
        </div>
    </div>

    <div class="cta-section">
        <h3 class="cta-title">🚀 Quero Minha Dieta Personalizada</h3>
        <p class="cta-subtitle">
            <strong>6 perguntas</strong> • <strong>90 segundos</strong> • <strong>Resultado na tela</strong><br>
            Suas calorias + macros + receitas calculados cientificamente
        </p>
        
        <!-- ✨ BENEFÍCIOS RÁPIDOS ANTES DO BOTÃO -->
        <div style="background: rgba(44, 122, 44, 0.1); border: 1px solid rgba(44, 122, 44, 0.3); border-radius: 16px; padding: 20px; margin: 20px 0; text-align: left;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="color: var(--success); font-size: 18px;">✅</span>
                    <span style="font-size: 14px; font-weight: 600;">Calorias exatas para seu objetivo</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="color: var(--success); font-size: 18px;">✅</span>
                    <span style="font-size: 14px; font-weight: 600;">Macros calculados cientificamente</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="color: var(--success); font-size: 18px;">✅</span>
                    <span style="font-size: 14px; font-weight: 600;">200+ receitas personalizadas</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="color: var(--success); font-size: 18px;">✅</span>
                    <span style="font-size: 14px; font-weight: 600;">Lista de compras organizada</span>
                </div>
            </div>
        </div>
        
        <button class="cta-button" id="startQuizBtn" style="animation: pulseBright 2s ease-in-out infinite; font-size: 19px; padding: 22px 40px;">
            🎯 INICIAR MINHA DIETA AGORA
        </button>
        
        <p class="disclaimer" style="margin-top: 15px; font-size: 13px;">
            ⚡ Resultado Instantâneo • 🔒 100% Seguro • 💚 Baseado em Ciência
        </p>
    </div>
</div>

        <!-- ✅ QUIZ SECTION -->
        <div class="quiz-card hidden" id="quizSection">
            <div class="progress-section">
                <div class="progress-header">
                    <div class="progress-text" id="progressText">Avaliação Nutricional - Etapa 1 de 9</div>
                    <div class="progress-doctor">
                        <div class="doctor-pulse"></div>
                        <span>Dra. Giovana</span>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <div id="questionContainer">
                <div class="question-header">
                    <div class="question-number" id="questionNumber">1</div>
                    <h1 class="question-title" id="questionTitle">Qual é o seu principal objetivo?</h1>
                    <p class="question-subtitle" id="questionSubtitle">
                        Para criar um plano nutricional personalizado, preciso entender qual é sua meta principal.
                    </p>
                </div>

                <div class="options-grid" id="optionsGrid">
                    <!-- Será preenchido dinamicamente -->
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" id="backBtn" style="display: none;">
                        ← Voltar
                    </button>
                    <button class="btn btn-primary" id="nextBtn" disabled>
                        Continuar →
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ✨ SISTEMA DE USUÁRIOS ATIVOS COM OSCILAÇÃO NATURAL
        class ActiveUsersManager {
            constructor() {
                this.baseNumbers = [16, 19, 23, 27, 30, 34, 38, 49]; // Números base que você mencionou
                this.currentIndex = 2; // Começar com 23
                this.isUpdating = false;
                this.updateInterval = null;
                this.variations = [-2, -1, 0, 1, 2, 3]; // Pequenas variações para realismo
                
                this.counterElement = document.getElementById('activeCount');
                
                this.init();
            }
            
            init() {
                // Inicializar com números diferentes para criar variedade
                this.updateDisplay(this.getRandomNumber());
                this.startOscillation();
                
                // Adicionar listeners para mudanças de página
                this.setupPageChangeListeners();
            }
            
            getRandomNumber() {
                const baseNumber = this.baseNumbers[this.currentIndex];
                const variation = this.variations[Math.floor(Math.random() * this.variations.length)];
                return Math.max(12, baseNumber + variation); // Nunca menos que 12
            }
            
            getNextNumber() {
                // Lógica inteligente para próximo número
                const shouldGoUp = Math.random() > 0.4; // 60% chance de subir
                
                if (shouldGoUp && this.currentIndex < this.baseNumbers.length - 1) {
                    this.currentIndex++;
                } else if (!shouldGoUp && this.currentIndex > 0) {
                    this.currentIndex--;
                } else {
                    // Se está nos extremos, força mudança na direção oposta
                    if (this.currentIndex === 0) this.currentIndex = 1;
                    else if (this.currentIndex === this.baseNumbers.length - 1) this.currentIndex = this.baseNumbers.length - 2;
                }
                
                return this.getRandomNumber();
            }
            
            updateDisplay(number) {
                if (this.isUpdating) return;
                
                this.isUpdating = true;
                
                // Animar contador principal se visível
                if (this.counterElement) {
                    this.animateNumber(this.counterElement, number);
                }
                
                setTimeout(() => {
                    this.isUpdating = false;
                }, 800);
            }
            
            animateNumber(element, newNumber) {
                element.classList.add('updating');
                
                setTimeout(() => {
                    element.textContent = newNumber;
                    element.classList.remove('updating');
                }, 150);
            }
            
            startOscillation() {
                // Primeira mudança após 3-8 segundos
                setTimeout(() => {
                    this.scheduleNextUpdate();
                }, Math.random() * 5000 + 3000);
            }
            
            scheduleNextUpdate() {
                if (this.updateInterval) {
                    clearTimeout(this.updateInterval);
                }
                
                // Intervalo variável entre 8-25 segundos para parecer natural
                const nextInterval = Math.random() * 17000 + 8000;
                
                this.updateInterval = setTimeout(() => {
                    const nextNumber = this.getNextNumber();
                    this.updateDisplay(nextNumber);
                    this.scheduleNextUpdate(); // Agendar próxima atualização
                }, nextInterval);
            }
            
            setupPageChangeListeners() {
                // Quando usuário inicia o quiz, simular aumento de atividade
                document.addEventListener('quizStarted', () => {
                    setTimeout(() => {
                        const boostNumber = this.getRandomNumber() + Math.floor(Math.random() * 4) + 2;
                        this.updateDisplay(Math.min(38, boostNumber)); // Máximo 38
                    }, Math.random() * 2000 + 1000);
                });
                
                // Quando usuário volta para landing page
                document.addEventListener('backToLanding', () => {
                    setTimeout(() => {
                        this.updateDisplay(this.getRandomNumber());
                    }, 500);
                });
            }
            
            // Simular entrada/saída de usuários em momentos específicos
            simulateUserActivity() {
                // Pequeno boost quando alguém chega nos resultados
                if (Math.random() > 0.7) { // 30% chance
                    setTimeout(() => {
                        const currentBase = this.baseNumbers[this.currentIndex];
                        const boostedNumber = currentBase + Math.floor(Math.random() * 3) + 1;
                        this.updateDisplay(Math.min(36, boostedNumber));
                    }, Math.random() * 3000 + 1000);
                }
            }
        }

        let currentQuestion = 0;
        let answers = {};
        let isOnLandingPage = true;
        let activeUsersManager;
        // ✅ FUNÇÃO PARA ENVIAR DADOS PARA GOOGLE SHEETS - VERSÃO JSONP (SEM CORS)
async function sendToGoogleSheets(userData) {
    try {
        // ✅ URL ATUALIZADA DO SEU GOOGLE APPS SCRIPT
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxzkKkSiEvFsc90ANEFLfvuXKxWIR5udYpB7yEWHxkzOdNzUc0Q1mEKPkeOQbL2ErUW/exec';
        
        console.log('📊 Enviando dados para Google Sheets via GET...');
        console.log('👤 Dados do usuário:', userData);
        
        // Converter dados para parâmetros de URL
        const params = new URLSearchParams();
        Object.keys(userData).forEach(key => {
            if (userData[key] !== null && userData[key] !== undefined) {
                params.append(key, userData[key]);
            }
        });
        
        const fullURL = `${GOOGLE_SCRIPT_URL}?${params.toString()}`;
        console.log('🔗 URL de envio:', fullURL);
        
        // ✅ PRIMEIRA TENTATIVA: Sem no-cors para capturar erros reais
        try {
            const response = await fetch(fullURL, {
                method: 'GET'
            });
            
            if (response.ok) {
                const result = await response.text();
                console.log('✅ Resposta do servidor:', result);
                console.log('✅ Dados enviados com sucesso para Google Sheets!');
                return true;
            } else {
                console.warn('⚠️ Resposta não OK:', response.status, response.statusText);
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
        } catch (corsError) {
            console.log('⚠️ CORS detectado, usando fallback no-cors...');
            console.log('📝 Erro original:', corsError.message);
            
            // ✅ FALLBACK: Com no-cors para contornar CORS
            await fetch(fullURL, {
                method: 'GET',
                mode: 'no-cors'
            });
            
            console.log('✅ Dados enviados via fallback no-cors');
            console.log('ℹ️ Verifique a planilha para confirmar se os dados foram salvos');
            return true;
        }
        
    } catch (error) {
        console.error('❌ Erro ao enviar para Google Sheets:', error);
        console.error('📍 Detalhes do erro:', {
            message: error.message,
            stack: error.stack,
            userData: userData
        });
        return false;
    }
}
                
        // ✅ Hash routing - Mapeamento de hash para cada pergunta
     const hashMap = [
    'frustracao',      // Pergunta 0
    'urgencia',        // Pergunta 1  
    'tentativas',      // Pergunta 2
    'dados-fisicos',   // Pergunta 3
    'realidade',       // Pergunta 4
    'contato'          // Pergunta 5
];

        // ✅ Função para atualizar URL e disparar PageView OTIMIZADO
        function updateURL(questionIndex) {
            let newHash = '';
            let pageName = '';
            
            if (questionIndex === 'landing') {
                newHash = '';
                pageName = 'Landing Page';
            } else if (questionIndex === 'analise') {
                newHash = 'analise';
                pageName = 'Análise Nutricional';
            } else if (questionIndex === 'resultado') {
                newHash = 'resultado';
                pageName = 'Resultados';
            } else if (questionIndex < hashMap.length) {
                newHash = hashMap[questionIndex];
                pageName = `Pergunta ${questionIndex + 1} - ${hashMap[questionIndex]}`;
            }
            
            // Atualizar URL
            if (window.location.hash !== '#' + newHash) {
                window.location.hash = newHash;
            }
            
            // ✅ ENVIAR VIEWCONTENT EM VEZ DE PAGEVIEW MANUAL (evita duplicação)
            eventsTracker.trackOnce('standard', 'ViewContent', {
                content_type: 'quiz_page',
                content_name: pageName,
                content_category: 'quiz_step',
                content_ids: [`page_${newHash || 'landing'}`],
                page_location: window.location.href,
                page_title: pageName
            });
            
            console.log(`📄 Página rastreada: ${pageName} (${window.location.href})`);
        }

        // ✅ Função para obter pergunta pelo hash
        function getQuestionFromHash() {
            const hash = window.location.hash.substring(1);
            if (!hash) return 'landing';
            if (hash === 'analise') return 'analise';
            if (hash === 'resultado') return 'resultado';
            const index = hashMap.indexOf(hash);
            return index >= 0 ? index : 'landing';
        }

        // ✅ SISTEMA DE PERSISTÊNCIA DE DADOS (com fallback)
        const DataStorage = {
            // Tenta usar localStorage, se não conseguir usa memória
            isLocalStorageAvailable: function() {
                try {
                    const testKey = 'test_' + Date.now();
                    localStorage.setItem(testKey, 'test');
                    localStorage.removeItem(testKey);
                    return true;
                } catch (e) {
                    return false;
                }
            },
            
            memoryStorage: {}, // Fallback em memória
            
            setItem: function(key, value) {
                const jsonValue = JSON.stringify(value);
                if (this.isLocalStorageAvailable()) {
                    try {
                        localStorage.setItem('dra_giovana_' + key, jsonValue);
                        console.log(`💾 Dados salvos no localStorage: ${key}`);
                        return true;
                    } catch (e) {
                        console.warn('Erro ao salvar no localStorage, usando memória:', e);
                    }
                }
                // Fallback para memória
                this.memoryStorage['dra_giovana_' + key] = jsonValue;
                console.log(`💾 Dados salvos na memória: ${key}`);
                return true;
            },
            
            getItem: function(key) {
                const fullKey = 'dra_giovana_' + key;
                if (this.isLocalStorageAvailable()) {
                    try {
                        const value = localStorage.getItem(fullKey);
                        if (value) {
                            console.log(`📄 Dados recuperados do localStorage: ${key}`);
                            return JSON.parse(value);
                        }
                    } catch (e) {
                        console.warn('Erro ao ler localStorage:', e);
                    }
                }
                // Fallback para memória
                const memValue = this.memoryStorage[fullKey];
                if (memValue) {
                    console.log(`📄 Dados recuperados da memória: ${key}`);
                    return JSON.parse(memValue);
                }
                return null;
            },
            
            removeItem: function(key) {
                const fullKey = 'dra_giovana_' + key;
                if (this.isLocalStorageAvailable()) {
                    try {
                        localStorage.removeItem(fullKey);
                    } catch (e) {
                        console.warn('Erro ao remover do localStorage:', e);
                    }
                }
                delete this.memoryStorage[fullKey];
                console.log(`🗑️ Dados removidos: ${key}`);
            },
            
            // ✅ Salvar dados do quiz para recuperação pós-pagamento
            saveQuizData: function(answers, results) {
                const quizData = {
                    answers: answers,
                    results: results,
                    completedAt: new Date().toISOString(),
                    sessionId: eventsTracker.sessionId,
                    userAgent: navigator.userAgent,
                    timestamp: Date.now()
                };
                
                this.setItem('quiz_data', quizData);
                this.setItem('user_profile', {
                    goal: answers.goal,
                    name: answers.contact?.name,
                    email: answers.contact?.email,
                    bmr: results.bmr,
                    targetCalories: results.targetCalories,
                    projectedWeightChange: results.projectedWeightChange
                });
                
                console.log('💾 Dados completos do quiz salvos para recuperação pós-pagamento');
                return quizData;
            },
            
            // ✅ Recuperar dados para personalização
            getQuizData: function() {
                return this.getItem('quiz_data');
            },
            
            getUserProfile: function() {
                return this.getItem('user_profile');
            },
            
            // ✅ Verificar se usuário já fez o quiz
            hasCompletedQuiz: function() {
                const data = this.getQuizData();
                return data && data.answers && data.results;
            }
        };
        
        // ✅ SISTEMA ANTI-DUPLICAÇÃO DE EVENTOS 100% COMPLIANCE META
        let eventsTracker = {
            sent: new Set(),
            sessionId: 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
            pageViewSent: false, // ✅ Controle específico para PageView
            
            // ✅ GERAR EVENT_ID DETERMINÍSTICO OTIMIZADO baseado no conteúdo do evento
            generateEventId: function(eventName, eventData = {}) {
                // Criar um ID único mas determinístico baseado no evento e dados do usuário
                const userIdentifier = eventData.email || eventData.external_id || this.sessionId;
                const timestamp = Math.floor(Date.now() / 1000); // Unix timestamp em segundos
                const eventContent = eventName + JSON.stringify(eventData) + timestamp.toString();
                
                // Usar hash simples para criar ID determinístico
                let hash = 0;
                for (let i = 0; i < eventContent.length; i++) {
                    const char = eventContent.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash; // Convert to 32bit integer
                }
                
                return 'evt_' + Math.abs(hash).toString(36) + '_' + timestamp;
            },
            
            // ✅ OBTER EXTERNAL_ID consistente do usuário
            getExternalId: function() {
                // Usar email se disponível, senão session ID
                if (answers.contact && answers.contact.email) {
                    return answers.contact.email.toLowerCase().trim();
                }
                // Fallback para session ID persistente
                return this.sessionId;
            },
            
            // Verificar se evento já foi enviado
            hasBeenSent: function(eventKey) {
                return this.sent.has(eventKey);
            },
            
            // Marcar evento como enviado
            markAsSent: function(eventKey) {
                this.sent.add(eventKey);
            },
            
            // ✅ TRACKING COM DEDUPLICAÇÃO 100% COMPLIANCE META
            trackOnce: function(eventType, eventName, parameters = {}) {
                try {
                    // ✅ EVITAR PAGEVIEW DUPLICADO - Meta Pixel já envia automaticamente
                    if (eventName === 'PageView' && this.pageViewSent) {
                        console.log('🔄 PageView automático já foi enviado pelo Meta Pixel - evitando duplicação');
                        return false;
                    }
                    
                    // ✅ ADICIONAR EXTERNAL_ID consistente
                    const externalId = this.getExternalId();
                    
                    // ✅ TIMESTAMP UNIX para compliance
                    const eventTime = Math.floor(Date.now() / 1000);
                    
                    // ✅ GERAR EVENT_ID DETERMINÍSTICO
                    const eventId = this.generateEventId(eventName, {
                        ...parameters,
                        external_id: externalId,
                        event_time: eventTime
                    });
                    
                    // Chave única para verificar duplicação LOCAL
                    const eventKey = `${eventName}_${eventId}_${eventTime}`;
                    
                    if (this.hasBeenSent(eventKey)) {
                        console.log(`🔄 Evento "${eventName}" já foi enviado - evitando duplicação`);
                        return false;
                    }
                    
                    if (typeof fbq !== 'undefined') {
                        // ✅ DADOS DO EVENTO 100% COMPLIANCE META
                        const eventData = {
                            ...parameters,
                            external_id: externalId,  // ✅ Identificador único do usuário
                            event_source_url: window.location.href,
                            client_user_agent: navigator.userAgent,
                            event_time: eventTime,    // ✅ Unix timestamp obrigatório
                            session_id: this.sessionId
                        };
                        
                        // ✅ Adicionar FBP e FBC apenas se conseguir obter (proteção sandbox)
                        try {
                            const fbp = this.getFbp();
                            const fbc = this.getFbc();
                            if (fbp) eventData.fbp = fbp;
                            if (fbc) eventData.fbc = fbc;
                        } catch (e) {
                            console.log('⚠️ Cookies não disponíveis em ambiente sandbox - continuando sem FBP/FBC');
                        }
                        
                        // ✅ OPÇÕES DE EVENTO COM DEDUPLICAÇÃO COMPLETA
                        const eventOptions = {
                            eventID: eventId,         // ✅ ID único para deduplicação server-side
                            event_time: eventTime     // ✅ Timestamp para ordenação de eventos
                        };
                        
                        try {
                            if (eventType === 'custom') {
                                fbq('trackCustom', eventName, eventData, eventOptions);
                            } else {
                                fbq('track', eventName, eventData, eventOptions);
                            }
                            
                            // ✅ Marcar PageView como enviado se for o caso
                            if (eventName === 'PageView') {
                                this.pageViewSent = true;
                            }
                            
                            this.markAsSent(eventKey);
                            console.log(`✅ Evento "${eventName}" enviado com 100% compliance Meta:`);
                            console.log(`   - Event ID: ${eventId}`);
                            console.log(`   - External ID: ${externalId}`);
                            console.log(`   - Event Time: ${eventTime}`);
                            console.log(`   - Ambiente: ${eventData.fbp ? 'Normal' : 'Sandbox'}`);
                            
                            return true;
                            
                        } catch (error) {
                            console.error(`❌ Erro ao enviar evento "${eventName}":`, error);
                            return false;
                        }
                    } else {
                        console.warn('⚠️ Facebook Pixel não encontrado');
                        return false;
                    }
                } catch (error) {
                    console.error(`❌ Erro geral no tracking "${eventName}":`, error);
                    return false;
                }
            },
            
            // ✅ FUNÇÃO ESPECIAL PARA EVENTOS CRÍTICOS DE CONVERSÃO
            trackConversion: function(eventName, value, currency = 'BRL', additionalData = {}) {
                const conversionData = {
                    value: value,
                    currency: currency,
                    predicted_ltv: value,
                    ...additionalData
                };
                
                return this.trackOnce('standard', eventName, conversionData);
            },
            
            // ✅ OBTER FACEBOOK BROWSER ID (fbp) - Compatível com sandbox
            getFbp: function() {
                try {
                    // Tentar obter do cookie _fbp
                    const fbpCookie = document.cookie
                        .split('; ')
                        .find(row => row.startsWith('_fbp='));
                    
                    if (fbpCookie) {
                        return fbpCookie.split('=')[1];
                    }
                } catch (e) {
                    console.log('📝 Ambiente sandboxed detectado - gerando FBP alternativo');
                }
                
                // Fallback para ambientes sandboxed - usar sessionStorage ou memória
                try {
                    const stored = DataStorage.getItem('fbp_fallback');
                    if (stored) return stored;
                } catch (e) {
                    // Se não conseguir usar storage, gerar um baseado na sessão
                }
                
                // Gerar FBP alternativo baseado na sessão
                const fbpValue = 'fb.1.' + Date.now() + '.' + Math.random().toString().slice(2);
                
                try {
                    // Tentar salvar no cookie se possível
                    document.cookie = `_fbp=${fbpValue}; path=/; max-age=7776000`;
                } catch (e) {
                    // Se não conseguir usar cookies, salvar no storage
                    DataStorage.setItem('fbp_fallback', fbpValue);
                }
                
                return fbpValue;
            },
            
            // ✅ OBTER FACEBOOK CLICK ID (fbc) - Compatível com sandbox
            getFbc: function() {
                // Verificar se tem fbclid na URL
                const urlParams = new URLSearchParams(window.location.search);
                const fbclid = urlParams.get('fbclid');
                
                if (fbclid) {
                    const fbcValue = 'fb.1.' + Date.now() + '.' + fbclid;
                    
                    try {
                        // Tentar salvar no cookie se possível
                        document.cookie = `_fbc=${fbcValue}; path=/; max-age=7776000`;
                    } catch (e) {
                        // Se não conseguir usar cookies, salvar no storage
                        DataStorage.setItem('fbc_fallback', fbcValue);
                        console.log('📝 FBC salvo em storage alternativo');
                    }
                    
                    return fbcValue;
                }
                
                try {
                    // Tentar obter do cookie _fbc
                    const fbcCookie = document.cookie
                        .split('; ')
                        .find(row => row.startsWith('_fbc='));
                    
                    if (fbcCookie) {
                        return fbcCookie.split('=')[1];
                    }
                } catch (e) {
                    // Fallback para storage se cookies não funcionarem
                    const stored = DataStorage.getItem('fbc_fallback');
                    if (stored) return stored;
                }
                
                return undefined;
            }
        };
        
       const questions = [
    // 1️⃣ PERGUNTA EMOCIONAL - Criar conexão emocional
    {
        title: "Qual é a sua MAIOR frustração com a alimentação?",
        subtitle: "Seja honesta comigo... Qual dessas situações mais te incomoda no dia a dia? Preciso entender sua dor para criar a solução perfeita.",
        type: "choice",
        options: [
            { 
                value: "no_results", 
                icon: "😔", 
                title: "Faço dieta mas não vejo resultados", 
                description: "Já tentei várias dietas, mas o peso não sai ou volta rapidamente" 
            },
            { 
                value: "no_energy", 
                icon: "😴", 
                title: "Sempre cansada e sem energia", 
                description: "Me sinto exausta, sem disposição para nada durante o dia" 
            },
            { 
                value: "clothes_tight", 
                icon: "👗", 
                title: "Roupas não servem mais", 
                description: "Minhas roupas estão apertadas e me sinto desconfortável" 
            },
            { 
                value: "no_control", 
                icon: "🍫", 
                title: "Não consigo controlar a fome", 
                description: "Tenho compulsão alimentar e como por ansiedade" 
            }
        ]
    },
    
    // 2️⃣ PERGUNTA DE OBJETIVO + URGÊNCIA
    {
        title: "Em quanto tempo você PRECISA ver resultados?",
        subtitle: "Cada objetivo tem uma estratégia diferente. Me conte qual é a SUA urgência para eu personalizar seu plano.",
        type: "choice",
        options: [
            { 
                value: "15_days", 
                icon: "⚡", 
                title: "15 dias (Urgente!)", 
                description: "Tenho um evento importante e preciso de resultados rápidos" 
            },
            { 
                value: "1_month", 
                icon: "🎯", 
                title: "1 mês", 
                description: "Quero ver mudanças significativas em 30 dias" 
            },
            { 
                value: "3_months", 
                icon: "📈", 
                title: "3 meses", 
                description: "Busco uma transformação consistente e duradoura" 
            },
            { 
                value: "6_months", 
                icon: "🏆", 
                title: "6 meses ou mais", 
                description: "Foco na mudança de hábitos e resultados a longo prazo" 
            }
        ]
    },

    // 3️⃣ PERGUNTA SOBRE TENTATIVAS ANTERIORES
    {
        title: "O que você já tentou que NÃO funcionou?",
        subtitle: "Vou garantir que seu novo plano seja diferente de tudo que você já tentou. Selecione o que mais se aplica:",
        type: "choice",
        options: [
            { 
                value: "restrictive_diets", 
                icon: "🚫", 
                title: "Dietas muito restritivas", 
                description: "Low carb radical, detox, jejum extremo que não consegui manter" 
            },
            { 
                value: "generic_apps", 
                icon: "📱", 
                title: "Apps genéricos", 
                description: "MyFitnessPal, FatSecret... nada personalizado de verdade" 
            },
            { 
                value: "expensive_nutri", 
                icon: "💰", 
                title: "Nutricionista caro", 
                description: "Paguei R$300-500 por consulta e recebi dieta 'de gaveta'" 
            },
            { 
                value: "no_support", 
                icon: "😢", 
                title: "Tentei sozinha", 
                description: "Sem orientação profissional, desisti por não saber o que fazer" 
            }
        ]
    },

    // 4️⃣ DADOS FÍSICOS SIMPLIFICADOS
    {
        title: "Me conte sobre seu perfil físico",
        subtitle: "Vou criar uma estimativa personalizada baseada no que você me contar. Não precisa ser exato, me dê uma ideia geral:",
        type: "choice",
        options: [
            { 
                value: "petite_lose", 
                icon: "👩", 
                title: "Baixinha e quero emagrecer", 
                description: "Entre 1,50-1,65m, peso entre 55-75kg, meta: perder uns 5-15kg" 
            },
            { 
                value: "average_lose", 
                icon: "🚶‍♀️", 
                title: "Altura média e quero emagrecer", 
                description: "Entre 1,60-1,75m, peso entre 65-85kg, meta: perder uns 8-20kg" 
            },
            { 
                value: "tall_lose", 
                icon: "🏃‍♀️", 
                title: "Mais alta e quero emagrecer", 
                description: "Acima de 1,70m, peso entre 75-95kg, meta: perder uns 10-25kg" 
            },
            { 
                value: "gain_muscle", 
                icon: "💪", 
                title: "Quero ganhar massa muscular", 
                description: "Qualquer altura, quero definir o corpo e ganhar músculos" 
            }
        ]
    },

    // 5️⃣ RESTRIÇÕES + ESTILO DE VIDA
    {
        title: "Qual é a sua realidade alimentar?",
        subtitle: "Vou criar um plano que SE ADAPTE à sua vida real, não o contrário. Me conte como é seu dia a dia:",
        type: "choice",
        options: [
            { 
                value: "busy_mom", 
                icon: "👶", 
                title: "Mãe corrida", 
                description: "Cuido dos filhos, pouco tempo para cozinhar coisas elaboradas" 
            },
            { 
                value: "work_long_hours", 
                icon: "💼", 
                title: "Trabalho muito", 
                description: "Saio cedo, chego tarde, como fora de casa frequentemente" 
            },
            { 
                value: "love_sweet", 
                icon: "🍰", 
                title: "Viciada em doces", 
                description: "Chocolate, bolo, sorvete... meu ponto fraco são os doces" 
            },
            { 
                value: "simple_cooking", 
                icon: "🍳", 
                title: "Quero receitas simples", 
                description: "Preciso de opções práticas, rápidas e sem complicação" 
            }
        ]
    },

    // 6️⃣ DADOS PARA CONTATO + COMPROMETIMENTO
    {
        title: "Última etapa: Vamos fazer isso acontecer!",
        subtitle: "Estou MUITO animada para te ajudar! Preciso desses dados para enviar seu protocolo personalizado e te acompanhar nessa jornada de transformação.",
        type: "form",
        fields: [
            { 
                name: "name", 
                label: "Como posso te chamar?", 
                type: "text", 
                placeholder: "Seu primeiro nome",
                helpText: "💕 Quero personalizar tudo com seu nome para criar conexão real"
            },
            { 
                name: "email", 
                label: "Seu melhor e-mail", 
                type: "email", 
                placeholder: "seuemail@gmail.com",
                helpText: "📧 Aqui vou enviar seu protocolo + receitas + dicas exclusivas"
            },
            { 
                name: "whatsapp", 
                label: "WhatsApp (opcional)", 
                type: "tel", 
                placeholder: "(11) 99999-9999",
                helpText: "📱 Para suporte direto e lembretes motivacionais"
            }
        ]
    }
];

        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            
            // ✨ INICIALIZAR SISTEMA DE USUÁRIOS ATIVOS
            activeUsersManager = new ActiveUsersManager();
            
            // ✅ INICIALIZAR SESSÃO ÚNICA PARA TRACKING (SEM SESSIONSTORAGE)
            console.log('🆔 Nova sessão iniciada:', eventsTracker.sessionId);
            
            // Mobile-specific initializations
            initializeMobileOptimizations();
            
            // ✅ VERIFICAR SE USUÁRIO JÁ COMPLETOU O QUIZ
            const existingData = DataStorage.getQuizData();
            if (existingData && existingData.answers && existingData.results) {
                console.log('🔄 Usuário retornando detectado - dados encontrados');
                answers = existingData.answers;
                
                // Se está na URL de resultado, mostrar resultados salvos
                const currentRoute = getQuestionFromHash();
                if (currentRoute === 'resultado') {
                    console.log('📊 Mostrando resultados salvos para usuário retornando');
                    setTimeout(() => {
                        showQuizSection();
                        showFinalResults();
                    }, 100);
                    return;
                }
            }
            
            // ✅ Verificar hash na URL ao carregar
            const initialRoute = getQuestionFromHash();
            
            if (initialRoute === 'landing') {
                showLandingPage();
            } else if (initialRoute === 'analise') {
                showQuizSection();
                showAnalysisProcess();
            } else if (initialRoute === 'resultado') {
                showQuizSection();
                showFinalResults();
            } else if (typeof initialRoute === 'number') {
                currentQuestion = initialRoute;
                isOnLandingPage = false;
                showQuizSection();
                loadQuestion(currentQuestion);
            }
            
            // ✅ Listener para mudanças de hash (botão voltar do navegador)
            window.addEventListener('hashchange', function() {
                const newRoute = getQuestionFromHash();
                
                if (newRoute === 'landing' && !isOnLandingPage) {
                    showLandingPage();
                    document.dispatchEvent(new CustomEvent('backToLanding'));
                } else if (newRoute === 'analise') {
                    showQuizSection();
                    showAnalysisProcess();
                } else if (newRoute === 'resultado') {
                    showQuizSection();
                    showFinalResults();
                } else if (typeof newRoute === 'number' && newRoute !== currentQuestion) {
                    currentQuestion = newRoute;
                    isOnLandingPage = false;
                    showQuizSection();
                    loadQuestion(currentQuestion);
                    
                    // Track navigation via browser back/forward
                    const navEventKey = `QuizBrowserNavigation_${currentQuestion}_${Date.now()}`;
                    eventsTracker.trackOnce('custom', navEventKey, {
                        question_number: currentQuestion + 1,
                        question_hash: hashMap[currentQuestion],
                        navigation_type: 'browser_button'
                    });
                }
            });
            
            // Adicionar event listener ao botão CORRIGIDO
            const startButton = document.getElementById('startQuizBtn');
            if (startButton) {
                startButton.addEventListener('click', startQuiz);
                console.log('✅ Event listener adicionado ao botão');
            } else {
                console.error('❌ Botão startQuizBtn não encontrado');
            }

            // ✅ Adicionar event listeners aos botões de navegação (COM PROTEÇÃO ANTI-DUPLICAÇÃO)
            const backBtn = document.getElementById('backBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            if (backBtn && !backBtn.dataset.listenerAdded) {
                backBtn.addEventListener('click', previousQuestion);
                backBtn.dataset.listenerAdded = 'true';
                console.log('✅ Event listener adicionado ao botão Voltar');
            }
            
            if (nextBtn && !nextBtn.dataset.listenerAdded) {
                nextBtn.addEventListener('click', nextQuestion);
                nextBtn.dataset.listenerAdded = 'true';
                console.log('✅ Event listener adicionado ao botão Continuar');
            }
            
            // Track page view inicial
            updateURL('landing');

            console.log('🚀 Sistema inicializado - Landing page da Dra. Giovana carregada');
            console.log('📱 Dispositivo móvel detectado:', isMobile());
            console.log('🔒 Sistema anti-duplicação 100% compliance Meta ativo');
            console.log('🆔 Event IDs únicos + timestamps para deduplicação server-side');
            console.log('💾 Sistema de persistência de dados com fallback ativo');
            console.log('📊 Rate limiting aplicado em eventos de engajamento');
            console.log('✅ Sequência correta de eventos de conversão: Lead → AddToCart → InitiateCheckout');
            console.log('✨ Sistema de usuários ativos com oscilação natural ativo');
        });

        function initializeMobileOptimizations() {
            const isMobileDevice = window.innerWidth <= 768 || /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobileDevice) {
                document.body.style.overscrollBehavior = 'none';
                
                let lastTouchEnd = 0;
                document.addEventListener('touchend', function (event) {
                    const now = (new Date()).getTime();
                    if (now - lastTouchEnd <= 300) {
                        event.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);

                window.addEventListener('orientationchange', function() {
                    setTimeout(() => {
                        window.scrollTo(0, 0);
                    }, 100);
                });

                console.log('📱 Otimizações mobile ativadas');
            }
        }

        function isMobile() {
            return window.innerWidth <= 768 || /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        function showLandingPage() {
            isOnLandingPage = true;
            document.getElementById('landingPage').classList.remove('hidden');
            document.getElementById('quizSection').classList.add('hidden');
            
            // ✨ Mostrar contador flutuante na landing page
            const counter = document.getElementById('activeUsersCounter');
            if (counter) {
                counter.style.display = 'flex';
            }
            
            updateURL('landing');
        }

        function showQuizSection() {
            isOnLandingPage = false;
            document.getElementById('landingPage').classList.add('hidden');
            document.getElementById('quizSection').classList.remove('hidden');
            
            // ✨ Manter contador flutuante visível no quiz também
            const counter = document.getElementById('activeUsersCounter');
            if (counter) {
                counter.style.display = 'flex';
            }
        }

        // ✅ FUNÇÃO CORRIGIDA - startQuiz COM 100% COMPLIANCE META
        function startQuiz() {
            console.log('🎯 Iniciando quiz com sistema 100% compliance Meta...');
            
            const button = document.getElementById('startQuizBtn');
            
            if (button) {
                button.classList.add('loading');
                button.innerHTML = '🚀 Iniciando...';
            }

            // ✨ DISPARAR EVENTO PARA SISTEMA DE USUÁRIOS ATIVOS
            document.dispatchEvent(new CustomEvent('quizStarted'));
            
            // ✨ SIMULAR ATIVIDADE NO CONTADOR
            if (activeUsersManager) {
                activeUsersManager.simulateUserActivity();
            }

            // ✅ EVENTO PRINCIPAL DE CONVERSÃO - Lead Generation
            const leadEvent = eventsTracker.trackOnce('standard', 'Lead', {
                content_name: 'Quiz Nutricional Iniciado',
                content_category: 'quiz_engagement',
                value: 0,
                currency: 'BRL',
                source: 'landing_page_cta',
                button_text: 'Iniciar Minha Dieta Personalizada'
            });

            // ✅ EVENTO CUSTOMIZADO PARA TRACKING INTERNO
            const customEvent = eventsTracker.trackOnce('custom', 'Iniciou_Formulario', {
                button_location: 'landing_page',
                button_text: 'Iniciar Minha Dieta Personalizada',
                source: 'landing_page_cta',
                content_name: 'Quiz Nutricional Inicio',
                content_category: 'quiz_engagement'
            });

            if (leadEvent) {
                console.log('🎉 EVENTO LEAD PRINCIPAL ENVIADO COM 100% COMPLIANCE!');
            }

            // Eventos adicionais de engajamento
            eventsTracker.trackOnce('custom', 'QuizStarted', {
                quiz_name: 'Avaliação Nutricional Dra Giovana',
                quiz_type: 'nutritional_assessment',
                starting_from: 'landing_page'
            });

            // Pequeno delay para feedback visual
            setTimeout(() => {
                currentQuestion = 0;
                showQuizSection();
                loadQuestion(currentQuestion);
                
                console.log('🚀 Quiz iniciado - Redirecionando para primeira pergunta');
                
                // Scroll suave para o topo
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });

                // Reset button state
                if (button) {
                    button.classList.remove('loading');
                    button.innerHTML = '🔥 Iniciar Minha Dieta Personalizada';
                }
            }, 500);
        }

        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = window.innerWidth > 768 ? 50 : 25;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particlesContainer.appendChild(particle);
            }
        }

        function loadQuestion(index) {
            const question = questions[index];
            const questionNumber = document.getElementById('questionNumber');
            const questionTitle = document.getElementById('questionTitle');
            const questionSubtitle = document.getElementById('questionSubtitle');
            const optionsGrid = document.getElementById('optionsGrid');
            const progressText = document.getElementById('progressText');
            const progressFill = document.getElementById('progressFill');
            const backBtn = document.getElementById('backBtn');
            const nextBtn = document.getElementById('nextBtn');

            const progress = ((index + 1) / questions.length) * 100;
            progressFill.style.width = progress + '%';
           progressText.textContent = `Avaliação Nutricional - Etapa ${index + 1} de 6`;

            questionNumber.textContent = index + 1;
            questionTitle.textContent = question.title;
            questionSubtitle.textContent = question.subtitle;

            backBtn.style.display = index > 0 ? 'block' : 'none';
            backBtn.dataset.processing = 'false'; // Resetar estado do botão voltar
            
            // ✅ RESETAR ESTADO DO BOTÃO CORRETAMENTE
            nextBtn.disabled = true;
            nextBtn.dataset.processing = 'false'; // Garantir que não está em processamento
            nextBtn.textContent = index === questions.length - 1 ? 'Finalizar Avaliação →' : 'Continuar →';

            // Track question view
            const questionEventKey = `QuizQuestionViewed_${index}`;
            eventsTracker.trackOnce('custom', questionEventKey, {
                question_number: index + 1,
                question_title: question.title,
                quiz_progress: Math.round(progress)
            });

            if (question.type === 'choice') {
                loadChoiceQuestion(question, optionsGrid);
            } else if (question.type === 'form') {
                loadFormQuestion(question, optionsGrid);
            }
        }

        function loadChoiceQuestion(question, container) {
            container.innerHTML = '';
            container.className = 'options-grid';

            question.options.forEach(option => {
                const optionCard = document.createElement('div');
                optionCard.className = 'option-card';
                if (question.multiSelect) {
                    optionCard.classList.add('multi-select');
                }
                optionCard.dataset.value = option.value;
                
                optionCard.innerHTML = `
                    <div class="option-icon">${option.icon}</div>
                    <div class="option-title">${option.title}</div>
                    <div class="option-description">${option.description}</div>
                `;

                // ✅ CORRIGIR PROBLEMA DO DUPLO CLIQUE - Event listener único e bem definido
                optionCard.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Evitar cliques múltiplos durante processamento
                    if (this.dataset.processing === 'true') {
                        return;
                    }
                    
                    this.dataset.processing = 'true';
                    
                    setTimeout(() => {
                        this.dataset.processing = 'false';
                    }, 300);

                    if (question.multiSelect) {
                        handleMultiSelectOption(this, option, container, question);
                    } else {
                        handleSingleSelectOption(this, option, container);
                    }
                });

                container.appendChild(optionCard);
            });
        }

        function handleSingleSelectOption(card, option, container) {
            // Remover seleção anterior
            container.querySelectorAll('.option-card').forEach(c => {
                c.classList.remove('selected');
            });
            
            // Selecionar esta opção
            card.classList.add('selected');
            
            // Salvar resposta
            const questionKey = getQuestionKey(currentQuestion);
            answers[questionKey] = option.value;
            
            // ✅ HABILITAR BOTÃO IMEDIATAMENTE SEM DELAY
            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn) {
                nextBtn.disabled = false;
                console.log(`✅ Opção selecionada: ${option.title} - Botão habilitado`);
            }

            // Track selection
            const selectionEventKey = `QuizOptionSelected_${currentQuestion}_${option.value}`;
            eventsTracker.trackOnce('custom', selectionEventKey, {
                question_number: currentQuestion + 1,
                option_value: option.value,
                option_title: option.title,
                is_multi_select: false
            });
        }

        function handleMultiSelectOption(card, option, container, question) {
    const isSelected = card.classList.contains('selected');
    const questionKey = getQuestionKey(currentQuestion);
    
    // Initialize answers array if not exists
    if (!answers[questionKey]) {
        answers[questionKey] = [];
    }
    
    // ✅ CORREÇÃO: Lógica simples para multi-select
    if (isSelected) {
        // Desselecionar
        card.classList.remove('selected');
        answers[questionKey] = answers[questionKey].filter(val => val !== option.value);
    } else {
        // Selecionar
        card.classList.add('selected');
        if (!answers[questionKey].includes(option.value)) {
            answers[questionKey].push(option.value);
        }
    }
    
    // ✅ CORREÇÃO: Verificar se há pelo menos uma seleção
    const hasSelection = answers[questionKey] && answers[questionKey].length > 0;
    const nextBtn = document.getElementById('nextBtn');
    if (nextBtn) {
        nextBtn.disabled = !hasSelection;
        console.log(`✅ Multi-select ${questionKey} - Seleções: ${answers[questionKey]} - Botão: ${hasSelection ? 'Habilitado' : 'Desabilitado'}`);
    }

    // Track selection for multi-select
    const selectionEventKey = `QuizOptionSelected_${currentQuestion}_${option.value}_${Date.now()}`;
    eventsTracker.trackOnce('custom', selectionEventKey, {
        question_number: currentQuestion + 1,
        option_value: option.value,
        option_title: option.title,
        is_multi_select: true,
        selection_action: isSelected ? 'deselected' : 'selected'
    });
}

        function loadFormQuestion(question, container) {
            container.innerHTML = '';
            container.className = 'form-grid';

            question.fields.forEach(field => {
                const inputGroup = document.createElement('div');
                inputGroup.className = 'input-group';
                
                inputGroup.innerHTML = `
                    <label class="input-label" for="${field.name}">${field.label}</label>
                    <input 
                        class="input-field" 
                        type="${field.type}" 
                        name="${field.name}" 
                        placeholder="${field.placeholder}"
                        ${field.type === 'number' ? 'min="1"' : ''}
                    >
                `;

                const input = inputGroup.querySelector('input');

                if (field.type === 'tel') {
                    input.addEventListener('input', function() {
                        let value = this.value.replace(/\D/g, '');
                        if (value.length >= 2) {
                            value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                        }
                        if (value.length >= 10) {
                            value = value.replace(/(\d{4,5})(\d{4})$/, '$1-$2');
                        }
                        this.value = value;
                    });
                }

                input.addEventListener('input', function() {
                    const questionKey = getQuestionKey(currentQuestion);
                    if (!answers[questionKey]) answers[questionKey] = {};
                    answers[questionKey][field.name] = this.value;
                    
                    checkFormCompletion(question);

                    // Track form field completion
                    if (this.value.trim() !== '') {
                        const fieldEventKey = `QuizFormFieldFilled_${currentQuestion}_${field.name}`;
                        eventsTracker.trackOnce('custom', fieldEventKey, {
                            question_number: currentQuestion + 1,
                            field_name: field.name,
                            field_type: field.type
                        });
                    }
                });

                container.appendChild(inputGroup);
            });
        }

        function checkFormCompletion(question) {
            const questionKey = getQuestionKey(currentQuestion);
            const questionAnswers = answers[questionKey] || {};
            
            const allFilled = question.fields.every(field => {
                const value = questionAnswers[field.name];
                return value && value.trim() !== '';
            });
            
            document.getElementById('nextBtn').disabled = !allFilled;

            // Track form completion
            if (allFilled) {
                const formEventKey = `QuizFormCompleted_${currentQuestion}`;
                eventsTracker.trackOnce('custom', formEventKey, {
                    question_number: currentQuestion + 1,
                    form_type: questionKey
                });
            }
        }

        function getQuestionKey(index) {
    const keys = ['frustration', 'urgency', 'attempts', 'physical', 'lifestyle', 'contact'];
    return keys[index] || `question_${index}`;
}

        function nextQuestion() {
            // ✅ PROTEÇÃO CONTRA CLIQUES MÚLTIPLOS
            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn && nextBtn.dataset.processing === 'true') {
                console.log('⚠️ Botão já está processando, ignorando clique');
                return;
            }
            
            if (nextBtn) {
                nextBtn.dataset.processing = 'true';
                nextBtn.disabled = true;
            }
            
            console.log(`➡️ Avançando da pergunta ${currentQuestion + 1} para ${currentQuestion + 2}`);

            // Track question completion COM RATE LIMITING
            if (currentQuestion % 3 === 0 || currentQuestion === questions.length - 1) {
                // Só rastrear a cada 3 perguntas + última para evitar spam
                const completionEventKey = `Quiz_Progress_${Math.ceil((currentQuestion + 1) / 3) * 3}`;
                eventsTracker.trackOnce('custom', completionEventKey, {
                    question_number: currentQuestion + 1,
                    quiz_progress: Math.round(((currentQuestion + 1) / questions.length) * 100),
                    progress_milestone: Math.ceil((currentQuestion + 1) / 3) * 3
                });
            }

            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                loadQuestion(currentQuestion);
                
                // Scroll suave para o topo
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            } else {
                // Track quiz completion
                eventsTracker.trackOnce('custom', 'QuizCompleted', {
                    total_questions: questions.length,
                    user_goal: answers.goal,
                    user_gender: answers.gender
                });
                
                showAnalysisProcess();
                
                // Scroll para o topo na tela de análise também
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }
            
            // Reabilitar botão após pequeno delay
            setTimeout(() => {
                if (nextBtn) {
                    nextBtn.dataset.processing = 'false';
                }
            }, 500);
        }

        function previousQuestion() {
            // ✅ PROTEÇÃO CONTRA CLIQUES MÚLTIPLOS
            const backBtn = document.getElementById('backBtn');
            if (backBtn && backBtn.dataset.processing === 'true') {
                console.log('⚠️ Botão voltar já está processando, ignorando clique');
                return;
            }
            
            if (currentQuestion > 0) {
                if (backBtn) {
                    backBtn.dataset.processing = 'true';
                }
                
                console.log(`⬅️ Voltando da pergunta ${currentQuestion + 1} para ${currentQuestion}`);
                
                currentQuestion--;
                loadQuestion(currentQuestion);
                
                // ✅ SCROLL AUTOMÁTICO PARA O TOPO - MESMO PADRÃO DA loadQuestion
setTimeout(() => {
    window.scrollTo({
        top: 0,
        behavior: 'smooth'
    });
}, 100);

                // Track backward navigation
                const backNavEventKey = `QuizNavigationBack_${currentQuestion}_${Date.now()}`;
                eventsTracker.trackOnce('custom', backNavEventKey, {
                    from_question: currentQuestion + 2,
                    to_question: currentQuestion + 1
                });
                
                // Reabilitar botão após pequeno delay
                setTimeout(() => {
                    if (backBtn) {
                        backBtn.dataset.processing = 'false';
                    }
                }, 500);
            }
        }

      function showAnalysisProcess() {
    // ✅ Atualizar URL para análise
    updateURL('analise');
    
    const container = document.getElementById('questionContainer');
    
    // ✅ ENVIAR DADOS PARA GOOGLE SHEETS QUANDO QUIZ FOR CONCLUÍDO
    const results = calculateResults();
    const contact = answers.contact || {};
    
    // Preparar dados para envio
    const userData = {
        name: contact.name || '',
        email: contact.email || '',
        phone: contact.phone || '',
        goal: answers.goal || '',
        gender: answers.gender || '',
        age: answers.age || '',
        activity: answers.activity || '',
        weight: answers.physical?.weight || '',
        height: answers.physical?.height || '',
        target_weight: answers.physical?.target_weight || '',
        bmr: results.bmr || '',
        target_calories: results.targetCalories || '',
        projected_weight_change: results.projectedWeightChange || '',
        months_to_goal: results.monthsToGoal || '',
        protein: results.protein || '',
        carbs: results.carbs || '',
        fats: results.fats || '',
        bmi: results.bmi || '',
        health_conditions: Array.isArray(answers.health) ? answers.health.join(', ') : (answers.health || ''),
        allergies: Array.isArray(answers.allergies) ? answers.allergies.join(', ') : (answers.allergies || ''),
        diet_type: answers.diet || ''
    };
    
    // Enviar para Google Sheets de forma assíncrona (não bloqueia a interface)
    sendToGoogleSheets(userData).then(success => {
        if (success) {
            console.log('📊 Lead salvo na planilha do Google Sheets!');
        } else {
            console.log('⚠️ Falha ao salvar na planilha, mas quiz continua funcionando');
        }
    });
    
    // Track analysis start
    eventsTracker.trackOnce('custom', 'AnalysisStarted', {
        user_data_collected: Object.keys(answers).length
    });
            container.innerHTML = `
                <div style="text-align: center; padding: 40px 0;">
                    <div style="font-size: 80px; margin-bottom: 20px; animation: doctorPulse 2s ease-in-out infinite;">👩‍⚕️</div>
                    <h1 style="font-size: 36px; font-weight: 900; margin-bottom: 20px; background: linear-gradient(135deg, var(--primary), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Dra. Giovana Analisando Seus Dados...</h1>
                    <p style="font-size: 18px; color: rgba(255, 255, 255, 0.8); line-height: 1.6; max-width: 600px; margin: 0 auto 40px;">
                        Estou processando suas informações para criar um 
                        <strong>plano nutricional personalizado</strong> baseado em evidências científicas.
                    </p>
                    
                    <!-- Progress Steps -->
                    <div style="max-width: 600px; margin: 0 auto 40px;">
                        <div id="step1" style="display: flex; align-items: center; gap: 20px; padding: 20px; margin-bottom: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; transition: all 0.3s ease;">
                            <div style="font-size: 24px;">📊</div>
                            <div style="flex: 1; text-align: left; font-weight: 600; color: var(--light);">Calculando metabolismo basal (TMB)</div>
                            <div id="step1-status" style="font-size: 14px; color: rgba(255, 255, 255, 0.7);">Aguardando...</div>
                        </div>
                        <div id="step2" style="display: flex; align-items: center; gap: 20px; padding: 20px; margin-bottom: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; transition: all 0.3s ease;">
                            <div style="font-size: 24px;">🎯</div>
                            <div style="flex: 1; text-align: left; font-weight: 600; color: var(--light);">Analisando condições de saúde</div>
                            <div id="step2-status" style="font-size: 14px; color: rgba(255, 255, 255, 0.7);">Aguardando...</div>
                        </div>
                        <div id="step3" style="display: flex; align-items: center; gap: 20px; padding: 20px; margin-bottom: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; transition: all 0.3s ease;">
                            <div style="font-size: 24px;">🧬</div>
                            <div style="flex: 1; text-align: left; font-weight: 600; color: var(--light);">Processando restrições alimentares</div>
                            <div id="step3-status" style="font-size: 14px; color: rgba(255, 255, 255, 0.7);">Aguardando...</div>
                        </div>
                        <div id="step4" style="display: flex; align-items: center; gap: 20px; padding: 20px; margin-bottom: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; transition: all 0.3s ease;">
                            <div style="font-size: 24px;">🥗</div>
                            <div style="flex: 1; text-align: left; font-weight: 600; color: var(--light);">Criando cardápio personalizado</div>
                            <div id="step4-status" style="font-size: 14px; color: rgba(255, 255, 255, 0.7);">Aguardando...</div>
                        </div>
                        <div id="step5" style="display: flex; align-items: center; gap: 20px; padding: 20px; margin-bottom: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; transition: all 0.3s ease;">
                            <div style="font-size: 24px;">📱</div>
                            <div style="flex: 1; text-align: left; font-weight: 600; color: var(--light);">Finalizando protocolo nutricional</div>
                            <div id="step5-status" style="font-size: 14px; color: rgba(255, 255, 255, 0.7);">Aguardando...</div>
                        </div>
                    </div>
                    
                    <!-- Interactive Elements -->
                    <div style="margin-bottom: 30px;">
                        <div style="background: rgba(0, 0, 0, 0.4); border-radius: 20px; padding: 20px; margin-bottom: 20px; border: 1px solid rgba(44, 122, 44, 0.3);">
                            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                <div style="font-size: 28px; animation: rotate 2s linear infinite;">👩‍⚕️</div>
                                <div>
                                    <div style="font-size: 16px; font-weight: 700; color: var(--accent);">Dra. Giovana trabalhando...</div>
                                    <div id="current-task" style="font-size: 14px; color: rgba(255, 255, 255, 0.8);">Iniciando análise...</div>
                                </div>
                            </div>
                            <div style="background: rgba(255, 255, 255, 0.1); height: 8px; border-radius: 4px; overflow: hidden;">
                                <div id="analysis-progress" style="height: 100%; background: linear-gradient(90deg, var(--primary), var(--accent)); width: 0%; transition: width 0.5s ease; border-radius: 4px;"></div>
                            </div>
                        </div>
                        
                        <!-- Fun Facts Display -->
                        <div id="fun-fact" style="background: rgba(108, 192, 74, 0.1); border: 1px solid rgba(108, 192, 74, 0.3); border-radius: 16px; padding: 20px; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <span style="font-size: 20px;">💡</span>
                                <span style="font-weight: 700; color: var(--accent);">Você sabia?</span>
                            </div>
                            <div id="fact-text" style="color: rgba(255, 255, 255, 0.9); line-height: 1.5; transition: opacity 0.3s ease;">
                                O metabolismo basal representa cerca de 60-70% do seu gasto energético total diário.
                            </div>
                        </div>
                        
                        <!-- Real-time Stats -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="background: rgba(44, 122, 44, 0.1); border: 1px solid rgba(44, 122, 44, 0.3); border-radius: 12px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: 900; color: var(--primary);" id="calc-bmr">Calculando...</div>
                                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.7);">TMB (cal/dia)</div>
                            </div>
                            <div style="background: rgba(108, 192, 74, 0.1); border: 1px solid rgba(108, 192, 74, 0.3); border-radius: 12px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: 900; color: var(--accent);" id="calc-protein">Processando...</div>
                                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.7);">Proteínas (g)</div>
                            </div>
                            <div style="background: rgba(0, 255, 136, 0.1); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 12px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: 900; color: var(--success);" id="calc-calories">Analisando...</div>
                                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.7);">Calorias Meta</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            simulateRealisticAnalysis();
        }

        function simulateRealisticAnalysis() {
            const tasks = [
                "Verificando dados antropométricos...",
                "Calculando taxa metabólica basal...",
                "Analisando nível de atividade física...",
                "Processando objetivo nutricional...",
                "Identificando restrições alimentares...",
                "Verificando condições de saúde...",
                "Criando perfil metabólico...",
                "Calculando necessidades calóricas...",
                "Definindo distribuição de macros...",
                "Personalizando cardápio...",
                "Finalizando protocolo..."
            ];

            const funFacts = [
                "O metabolismo basal representa cerca de 60-70% do seu gasto energético total diário.",
                "Cada grama de proteína fornece 4 calorias, assim como os carboidratos.",
                "O tecido muscular queima até 6x mais calorias que o tecido adiposo em repouso.",
                "Beber água gelada pode aumentar temporariamente seu metabolismo em até 30%.",
                "O corpo continua queimando calorias por até 24h após exercícios intensos.",
                "Comer proteína pode aumentar seu metabolismo em 15-30% por algumas horas.",
                "O cérebro consome cerca de 20% de todas as calorias que você queima diariamente."
            ];

            let currentStep = 0;
            let taskIndex = 0;
            let progress = 0;
            let factIndex = 0;

            const progressBar = document.getElementById('analysis-progress');
            const currentTask = document.getElementById('current-task');
            const factText = document.getElementById('fact-text');

            // Task rotation
            const taskInterval = setInterval(() => {
                if (taskIndex < tasks.length) {
                    currentTask.textContent = tasks[taskIndex];
                    taskIndex++;
                } else {
                    clearInterval(taskInterval);
                }
            }, 800);

            // Progress bar
            const progressInterval = setInterval(() => {
                if (progress < 100) {
                    progress += Math.random() * 15 + 5; // Random progress increments
                    if (progress > 100) progress = 100;
                    progressBar.style.width = progress + '%';
                } else {
                    clearInterval(progressInterval);
                }
            }, 600);

            // Fun facts rotation
            const factInterval = setInterval(() => {
                if (factIndex < funFacts.length - 1) {
                    factIndex++;
                    factText.style.opacity = '0';
                    setTimeout(() => {
                        factText.textContent = funFacts[factIndex];
                        factText.style.opacity = '1';
                    }, 300);
                } else {
                    clearInterval(factInterval);
                }
            }, 2500);

            // Step-by-step processing with realistic delays
            setTimeout(() => {
                processStep('step1', 'step1-status', 'Calculando TMB...', () => {
                    // Animate BMR calculation
                    animateNumber('calc-bmr', calculateResults().bmr, 1000);
                });
            }, 1200);

            setTimeout(() => {
                completeStep('step1', 'step1-status', '✓ TMB: ' + calculateResults().bmr + ' cal/dia');
                processStep('step2', 'step2-status', 'Analisando condições...');
            }, 2800);

            setTimeout(() => {
                completeStep('step2', 'step2-status', '✓ Condições identificadas');
                processStep('step3', 'step3-status', 'Processando restrições...');
            }, 4200);

            setTimeout(() => {
                completeStep('step3', 'step3-status', '✓ Restrições processadas');
                processStep('step4', 'step4-status', 'Criando cardápio...');
                // Animate protein calculation
                animateNumber('calc-protein', calculateResults().protein, 800);
            }, 5800);

            setTimeout(() => {
                completeStep('step4', 'step4-status', '✓ Cardápio personalizado');
                processStep('step5', 'step5-status', 'Finalizando...');
                // Animate calories calculation
                animateNumber('calc-calories', calculateResults().targetCalories, 1200);
            }, 7200);

            setTimeout(() => {
                completeStep('step5', 'step5-status', '✓ Protocolo finalizado');
                currentTask.textContent = 'Análise concluída com sucesso!';
                
                // Clean up intervals
                clearInterval(taskInterval);
                clearInterval(progressInterval);
                clearInterval(factInterval);
                
                // Track analysis completion
                eventsTracker.trackOnce('custom', 'AnalysisCompleted', {
                    user_bmr: calculateResults().bmr,
                    user_target_calories: calculateResults().targetCalories,
                    user_goal: answers.goal
                });
                
                // Show results after a brief pause
                setTimeout(() => {
                    showFinalResults();
                }, 1500);
            }, 8800);
        }

        function processStep(stepId, statusId, message, callback) {
            const step = document.getElementById(stepId);
            const status = document.getElementById(statusId);
            
            step.classList.add('processing');
            status.textContent = message;
            status.style.color = 'var(--primary)';
            
            if (callback) callback();
        }

        function completeStep(stepId, statusId, message) {
            const step = document.getElementById(stepId);
            const status = document.getElementById(statusId);
            
            step.classList.remove('processing');
            step.classList.add('completed');
            status.textContent = message;
            status.style.color = 'var(--success)';
        }

        function animateNumber(elementId, targetValue, duration) {
            const element = document.getElementById(elementId);
            const startValue = 0;
            const increment = targetValue / (duration / 50);
            let currentValue = startValue;
            
            const timer = setInterval(() => {
                currentValue += increment;
                if (currentValue >= targetValue) {
                    currentValue = targetValue;
                    clearInterval(timer);
                }
                element.textContent = Math.round(currentValue).toLocaleString();
                element.style.animation = 'countUp 0.3s ease-out';
            }, 50);
        }

        function calculateResults() {
            const physical = answers.physical || {};
            const weight = parseFloat(physical.weight) || 70;
            const height = parseFloat(physical.height) || 170;
            const targetWeight = parseFloat(physical.target_weight) || weight;
            const gender = answers.gender || 'male';
            const age = answers.age || '26-35';
            const activity = answers.activity || 'moderate';
            const goal = answers.goal || 'maintain';

            const ageRanges = {
                '18-25': 21.5,
                '26-35': 30.5,
                '36-45': 40.5,
                '46-55': 50.5,
                '55+': 60
            };
            const ageValue = ageRanges[age] || 30;

            let bmr;
            if (gender === 'male') {
                bmr = 10 * weight + 6.25 * height - 5 * ageValue + 5;
            } else {
                bmr = 10 * weight + 6.25 * height - 5 * ageValue - 161;
            }

            const activityMultipliers = {
                sedentary: 1.2,
                light: 1.375,
                moderate: 1.55,
                intense: 1.725
            };

            const tdee = Math.round(bmr * (activityMultipliers[activity] || 1.55));

            let targetCalories = tdee;
            let projectedWeightChange = 0;
            let monthsToGoal = 0;

            if (goal === 'lose_weight') {
                targetCalories = Math.round(tdee - 500);
                if (targetWeight && targetWeight < weight) {
                    projectedWeightChange = weight - targetWeight;
                    monthsToGoal = Math.ceil(projectedWeightChange / 2);
                } else {
                    projectedWeightChange = Math.min(weight * 0.1, 10);
                    monthsToGoal = Math.ceil(projectedWeightChange / 2);
                }
            } else if (goal === 'gain_muscle') {
                targetCalories = Math.round(tdee + 300);
                if (targetWeight && targetWeight > weight) {
                    projectedWeightChange = targetWeight - weight;
                    monthsToGoal = Math.ceil(projectedWeightChange / 1);
                } else {
                    projectedWeightChange = 5;
                    monthsToGoal = 5;
                }
            }

            const protein = Math.round(weight * 2.2);
            const fats = Math.round(targetCalories * 0.3 / 9);
            const carbs = Math.round((targetCalories - (protein * 4) - (fats * 9)) / 4);

            const bmi = weight / ((height / 100) ** 2);

            return {
                bmr: Math.round(bmr),
                tdee,
                targetCalories,
                protein,
                carbs,
                fats,
                projectedWeightChange: Math.round(projectedWeightChange * 10) / 10,
                monthsToGoal,
                bmi: Math.round(bmi * 10) / 10,
                currentWeight: weight,
                targetWeight: targetWeight || weight,
                height
            };
        }

       function showFinalResults() {
    // ✅ Atualizar URL para resultado
    updateURL('resultado');
    
    const results = calculateResults();
    const container = document.getElementById('questionContainer');
    
    document.getElementById('progressText').textContent = 'Avaliação Concluída!';
    
    // ✅ SALVAR DADOS PARA RECUPERAÇÃO PÓS-PAGAMENTO
    DataStorage.saveQuizData(answers, results);
    // ✅ SCROLL AUTOMÁTICO PARA O TOPO
setTimeout(() => {
    window.scrollTo({
        top: 0,
        behavior: 'smooth'
    });
}, 100);
    
    // ✨ SIMULAR BOOST NO CONTADOR DE USUÁRIOS ATIVOS
    if (activeUsersManager) {
        activeUsersManager.simulateUserActivity();
    }
    
    // Track results shown
    eventsTracker.trackOnce('custom', 'ResultsShown', {
        user_bmr: results.bmr,
        user_target_calories: results.targetCalories,
        projected_weight_change: results.projectedWeightChange,
        months_to_goal: results.monthsToGoal,
        user_goal: answers.goal
    });
    
    container.innerHTML = `
        <div class="results-container">
            <div class="success-icon">🎉</div>
            <h1 class="reveal-title">Análise Nutricional Completa!</h1>
            <p class="reveal-subtitle">
                A Dra. Giovana analisou seu perfil e criou um 
                <strong>plano nutricional científico</strong> personalizado para seus objetivos
            </p>
            
            <!-- ✨ AVISO IMPORTANTE NO TOPO -->
            <div style="background: linear-gradient(135deg, rgba(0, 255, 136, 0.15), rgba(44, 122, 44, 0.1)); border: 2px solid rgba(0, 255, 136, 0.4); border-radius: 20px; padding: 25px; margin: 30px 0; text-align: center; position: relative;">
                <div style="position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: var(--success); color: #000; padding: 6px 20px; border-radius: 15px; font-size: 12px; font-weight: 900;">
                    ⬇️ IMPORTANTE ⬇️
                </div>
                <h3 style="font-size: 18px; font-weight: 800; color: var(--success); margin-bottom: 10px; margin-top: 8px;">
                    🎯 Seu Protocolo Está Pronto!
                </h3>
                <p style="font-size: 15px; color: rgba(255, 255, 255, 0.9); margin-bottom: 15px; line-height: 1.4;">
                    Veja seus resultados abaixo e <strong>role até o final da página</strong> para garantir acesso ao seu plano completo.
                </p>
                <div style="background: rgba(0, 255, 136, 0.2); border-radius: 12px; padding: 12px; display: flex; align-items: center; justify-content: center; gap: 10px;">
                    <span style="font-size: 16px;">📋</span>
                    <span style="font-size: 14px; font-weight: 600;">Protocolo + 200 Receitas + Lista de Compras</span>
                    <span style="font-size: 16px;">⬇️</span>
                </div>
            </div>
            
            <!-- ✅ NOTIFICAÇÕES DE VENDAS - MANTIDAS -->
            <div id="social-notifications" style="position: fixed; top: 20px; right: 20px; z-index: 1000; width: 300px; max-height: 80vh; overflow: hidden;"></div>
            <div id="social-notifications-bottom" style="position: fixed; bottom: 20px; right: 20px; z-index: 1000; width: 300px; max-height: 80vh; overflow: hidden;"></div>
            
            <div class="results-grid">
                ${results.projectedWeightChange > 0 ? `
                <div class="mega-result-card">
                    <div class="result-badge">🎯 SUA TRANSFORMAÇÃO</div>
                    <div class="result-value">${results.projectedWeightChange}kg</div>
                    <div class="result-label">${answers.goal === 'lose_weight' ? 'SERÃO ELIMINADOS' : 'DE MASSA MAGRA'}</div>
                    <div class="timeline-row">
                        <span>⚡</span>
                        <span>Primeiros resultados: 7-14 dias</span>
                    </div>
                    <div class="timeline-row">
                        <span>🎯</span>
                        <span>Meta completa: ${results.monthsToGoal} ${results.monthsToGoal === 1 ? 'mês' : 'meses'}</span>
                    </div>
                </div>
                ` : ''}
                
                <div class="results-metrics">
                    <div class="metric-card calories">
                        <div class="metric-icon">🔥</div>
                        <div class="metric-value">${results.targetCalories}</div>
                        <div class="metric-label">Calorias Diárias</div>
                        <div class="metric-subtitle">Meta personalizada</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">🥩</div>
                        <div class="metric-value">${results.protein}g</div>
                        <div class="metric-label">Proteínas</div>
                        <div class="metric-subtitle">Síntese muscular</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">🌾</div>
                        <div class="metric-value">${results.carbs}g</div>
                        <div class="metric-label">Carboidratos</div>
                        <div class="metric-subtitle">Energia sustentada</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-icon">🥑</div>
                        <div class="metric-value">${results.fats}g</div>
                        <div class="metric-label">Gorduras</div>
                        <div class="metric-subtitle">Saúde hormonal</div>
                    </div>
                </div>
                
                <!-- ✨ SEÇÃO COMPACTA DE RESULTADOS DE CLIENTES -->
                <div style="background: linear-gradient(135deg, rgba(44, 122, 44, 0.15), rgba(108, 192, 74, 0.1)); border: 2px solid rgba(44, 122, 44, 0.3); border-radius: 20px; padding: 20px; margin-bottom: 25px; text-align: center;">
                    <h3 style="font-size: 20px; font-weight: 900; margin-bottom: 8px; background: linear-gradient(135deg, var(--success), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        🌟 Resultados Reais dos Clientes
                    </h3>
                    
                    <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-bottom: 15px;">
                        <div style="background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 12px; padding: 12px; max-width: 200px;">
                            <img src="whatsapp_chat (1).png" alt="Resultado Cliente 1" style="width: 100%; height: auto; border-radius: 8px; margin-bottom: 8px;">
                            <div style="font-size: 11px; color: var(--success);">📱 Amanda - "consegui resultados"</div>
                        </div>
                        <div style="background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(108, 192, 74, 0.3); border-radius: 12px; padding: 12px; max-width: 200px;">
                            <img src="whatsapp_chat (2).png" alt="Resultado Cliente 2" style="width: 100%; height: auto; border-radius: 8px; margin-bottom: 8px;">
                            <div style="font-size: 11px; color: var(--accent);">📱 Leticia - "meus resultados"</div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; text-align: center;">
                        <div>
                            <div style="font-size: 18px; font-weight: 900; color: var(--success);">+10k</div>
                            <div style="font-size: 10px; color: rgba(255, 255, 255, 0.8);">Transformados</div>
                        </div>
                        <div>
                            <div style="font-size: 18px; font-weight: 900; color: var(--accent);">98%</div>
                            <div style="font-size: 10px; color: rgba(255, 255, 255, 0.8);">Taxa Sucesso</div>
                        </div>
                        <div>
                            <div style="font-size: 18px; font-weight: 900; color: var(--primary);">4.9⭐</div>
                            <div style="font-size: 10px; color: rgba(255, 255, 255, 0.8);">Avaliação</div>
                        </div>
                    </div>
                </div>
                
                <!-- ✨ COMPARATIVO DE PREÇO SIMPLIFICADO -->
                <div style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 193, 7, 0.1)); border: 2px solid rgba(255, 215, 0, 0.3); border-radius: 16px; padding: 20px; margin-bottom: 20px; text-align: center;">
                    <h3 style="font-size: 18px; font-weight: 800; color: #FFD700; margin-bottom: 15px;">
                        💰 Comparativo Rápido
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 10px; align-items: center; margin-bottom: 15px;">
                        <div style="background: rgba(255, 51, 102, 0.15); border: 1px solid rgba(255, 51, 102, 0.3); border-radius: 10px; padding: 12px;">
                            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.8);">Nutricionista</div>
                            <div style="font-size: 20px; font-weight: 900; color: var(--danger);">R$ 400+</div>
                            <div style="font-size: 10px; color: rgba(255, 255, 255, 0.6);">Por consulta</div>
                        </div>
                        
                        <div style="font-size: 16px; color: #FFD700; font-weight: 900;">VS</div>
                        
                        <div style="background: rgba(0, 255, 136, 0.15); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 10px; padding: 12px; position: relative;">
                            <div style="position: absolute; top: -6px; right: -6px; background: var(--danger); color: white; padding: 2px 8px; border-radius: 10px; font-size: 8px; font-weight: 800;">OFERTA</div>
                            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.8);">Protocolo Dra. Giovana</div>
                            <div style="font-size: 20px; font-weight: 900; color: var(--success);">R$ 39,90</div>
                            <div style="font-size: 10px; color: rgba(255, 255, 255, 0.6);">Acesso vitalício</div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(0, 255, 136, 0.2); border-radius: 8px; padding: 10px;">
                        <div style="font-size: 14px; font-weight: 800; color: var(--success);">
                            💡 Economia de R$ 370+
                        </div>
                    </div>
                </div>
                
                <!-- ✨ INDICADOR VISUAL PARA ROLAR -->
                <div style="background: rgba(255, 51, 102, 0.1); border: 2px solid rgba(255, 51, 102, 0.4); border-radius: 16px; padding: 20px; margin-bottom: 25px; text-align: center; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, transparent, var(--danger), transparent); animation: slideIndicator 2s ease-in-out infinite;"></div>
                    
                    <h3 style="font-size: 18px; font-weight: 800; color: var(--danger); margin-bottom: 10px;">
                        ⬇️ SEU PROTOCOLO TE ESPERA ABAIXO ⬇️
                    </h3>
                    <p style="font-size: 14px; color: rgba(255, 255, 255, 0.9); margin-bottom: 15px;">
                        Role para baixo para garantir acesso ao seu plano completo personalizado
                    </p>
                    
                    <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 10px;">
                        <div style="background: rgba(0, 255, 136, 0.2); border-radius: 8px; padding: 8px 12px; display: flex; align-items: center; gap: 5px;">
                            <span>📋</span>
                            <span style="font-size: 12px; font-weight: 600;">Dieta Personalizada</span>
                        </div>
                        <div style="background: rgba(108, 192, 74, 0.2); border-radius: 8px; padding: 8px 12px; display: flex; align-items: center; gap: 5px;">
                            <span>👩‍🍳</span>
                            <span style="font-size: 12px; font-weight: 600;">200+ Receitas</span>
                        </div>
                    </div>
                    
                    <div style="font-size: 24px; animation: bounce 2s ease-in-out infinite;">⬇️</div>
                </div>
                
                <!-- ✅ CTA Section - MANTIDA COM BOTÃO PULSANDO -->
                <div class="cta-section">
                    <h3 style="font-size: 22px; font-weight: 800; margin-bottom: 12px; color: var(--light); line-height: 1.3;">🚀 Seu Plano Nutricional Personalizado</h3>
                    <p style="font-size: 14px; color: rgba(255, 255, 255, 0.8); margin-bottom: 20px; line-height: 1.4;">Protocolo científico baseado na sua avaliação completa</p>
                    
                    <div style="text-align: left; margin-bottom: 20px;">
                        <div style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 6px;">
                            <span style="color: var(--success); font-size: 16px; margin-top: 2px;">✅</span>
                            <span style="font-size: 13px; line-height: 1.4;">Receitas adaptadas às suas restrições</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 6px;">
                            <span style="color: var(--success); font-size: 16px; margin-top: 2px;">✅</span>
                            <span style="font-size: 13px; line-height: 1.4;">200+ receitas com instruções detalhadas</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 6px;">
                            <span style="color: var(--success); font-size: 16px; margin-top: 2px;">✅</span>
                            <span style="font-size: 13px; line-height: 1.4;">Lista de compras organizada</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 6px;">
                            <span style="color: var(--success); font-size: 16px; margin-top: 2px;">✅</span>
                            <span style="font-size: 13px; line-height: 1.4;">Garantia de resultados</span>
                        </div>
                    </div>
                    
                    <!-- ✅ URGENCY TIMER - MANTIDO -->
                    <div style="background: rgba(255, 51, 102, 0.1); border: 1px solid rgba(255, 51, 102, 0.3); border-radius: 16px; padding: 15px; margin-bottom: 20px; text-align: center;">
                        <div style="font-size: 14px; font-weight: 700; color: var(--danger); margin-bottom: 8px;">🔥 OFERTA EXPIRA EM:</div>
                        <div id="countdown" style="font-size: 20px; font-weight: 900; color: var(--danger); font-family: monospace;"></div>
                        <div style="font-size: 12px; color: rgba(255, 255, 255, 0.8); margin-top: 6px;">Restam apenas ${Math.floor(Math.random() * 8) + 3} vagas hoje</div>
                    </div>
                    
                    <!-- ✅ BOTÃO PULSANDO VERDE - MANTIDO -->
                    <div id="checkout-button-container" style="margin-bottom: 15px;">
                       <button id="checkout-btn" style="
    background: linear-gradient(135deg, #00ff64, #00e054, #00cc48);
    color: white;
    border: none;
    padding: 18px 30px;
    border-radius: 16px;
    font-size: 16px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    cursor: pointer;
    width: 100%;
    max-width: 350px;
    position: relative;
    overflow: hidden;
    outline: none;
    -webkit-tap-highlight-color: transparent;
    animation: pulseBright 2s ease-in-out infinite;
    box-shadow: 0 8px 32px rgba(0, 255, 100, 0.4), 0 0 20px rgba(0, 255, 100, 0.3);
" onclick="handleCheckoutClick()" onmouseover="this.style.animation='pulseBright 1.5s ease-in-out infinite'; this.style.transform='translateY(-6px) scale(1.03)'; this.style.boxShadow='0 20px 60px rgba(0, 255, 100, 0.6), 0 0 50px rgba(0, 255, 100, 0.5)'" onmouseout="this.style.animation='pulseBright 2s ease-in-out infinite'; this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 8px 32px rgba(0, 255, 100, 0.4), 0 0 20px rgba(0, 255, 100, 0.3)'">
    🔓 GARANTIR SUA DIETA POR R$ 39,90
</button>
                    </div>
                    
                    <div style="margin-top: 12px; font-size: 12px; color: rgba(255, 255, 255, 0.7); line-height: 1.3;">
                        ✅ Acesso imediato • 💳 Pagamento seguro • 🔒 Garantia 30 dias
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ✅ ANIMAÇÕES CSS - MANTIDAS -->
        <style>
            @keyframes slideIndicator {
                0% { transform: translateX(-100%); }
                100% { transform: translateX(100%); }
            }
            
            @keyframes bounce {
                0%, 100% { transform: translateY(0); }
                50% { transform: translateY(-10px); }
            }
        </style>
    `;
    
    // ✅ CHAMADAS DAS FUNCÕES IMPORTANTES - MANTIDAS
    startSocialProofNotifications(); // ← Notificações de vendas
    startCountdownTimer(); // ← Contador de tempo
}

        function startSocialProofNotifications() {
            const names = [
                "Ana Paula - São Paulo", "Carlos - Rio de Janeiro", "Mariana - Belo Horizonte", 
                "Roberto - Salvador", "Juliana - Brasília", "Pedro - Fortaleza", 
                "Camila - Porto Alegre", "Lucas - Curitiba", "Fernanda - Recife", 
                "Rafael - Goiânia", "Patrícia - Florianópolis", "Bruno - Manaus",
                "Isabella - Natal", "Diego - João Pessoa", "Larissa - Campo Grande",
                "Thiago - Vitória", "Amanda - Aracaju", "Gabriel - Teresina"
            ];

            const actions = [
                "acabou de adquirir o Protocolo Nutricional",
                "completou a avaliação e garantiu seu plano",
                "se inscreveu no programa da Dra. Giovana",
                "aderiu ao protocolo personalizado",
                "confirmou seu acesso ao plano nutricional"
            ];

            const containerTop = document.getElementById('social-notifications');
            const containerBottom = document.getElementById('social-notifications-bottom');
            let notificationCount = 0;

            function showNotification(isBottom = false) {
                if (notificationCount >= 24) return;

                const container = isBottom ? containerBottom : containerTop;
                const name = names[Math.floor(Math.random() * names.length)];
                const action = actions[Math.floor(Math.random() * actions.length)];
                const timeAgo = Math.floor(Math.random() * 15) + 1;

                const notification = document.createElement('div');
                notification.style.cssText = `
                  background: rgba(0, 0, 0, 0.9);
                 border: 1px solid rgba(0, 255, 136, 0.3);
                 border-radius: 8px;
                 padding: 8px 10px;
                 margin-bottom: 6px;
                 box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
                 transform: translateX(100%);
                 transition: all 0.4s ease;
                 backdrop-filter: blur(10px);
                 position: relative;
                 z-index: 1001;
                 max-width: 250px;
`               ;
                notification.innerHTML = `
                 <div style="display: flex; align-items: center; gap: 8px;">
                 <div style="width: 28px; height: 28px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px;">👤</div>
                 <div style="flex: 1;">
                 <div style="font-size: 11px; font-weight: 600; color: var(--light); margin-bottom: 1px; line-height: 1.2;">${name}</div>
                 <div style="font-size: 9px; color: rgba(255, 255, 255, 0.8); line-height: 1.2;">${action}</div>
                 <div style="font-size: 8px; color: rgba(255, 255, 255, 0.6); margin-top: 1px;">há ${timeAgo}min</div>
                 </div>
                 <div style="color: var(--success); font-size: 12px;">✓</div>
    </div>
`;

                container.appendChild(notification);

                // Animate in
                setTimeout(() => {
                    notification.style.transform = 'translateX(0)';
                }, 100);

                // Remove after some time
                setTimeout(() => {
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 400);
                }, 6000);

                notificationCount++;
            }

            // Show first notification immediately (top)
            setTimeout(() => showNotification(false), 2000);
            
            // Show first notification bottom after a delay
            setTimeout(() => showNotification(true), 4000);

            // Then show notifications at random intervals alternating between top and bottom
            const interval = setInterval(() => {
                if (notificationCount < 24) {
                    const isBottom = Math.random() > 0.5;
                    showNotification(isBottom);
                } else {
                    clearInterval(interval);
                }
            }, Math.random() * 6000 + 4000);
        }

        function startCountdownTimer() {
            let timeLeft = 9 * 60; // 9 minutes in seconds
            const countdownElement = document.getElementById('countdown');

            function updateCountdown() {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                countdownElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft > 0) {
                    timeLeft--;
                } else {
                    countdownElement.textContent = "OFERTA EXPIRADA";
                    countdownElement.style.color = "#ff3366";
                }
            }

            updateCountdown();
            setInterval(updateCountdown, 1000);
        }

        // ✅ CHECKOUT FUNCTION COM 100% COMPLIANCE META
        function handleCheckoutClick() {
            console.log('🛒 Checkout iniciado com sistema 100% compliance Meta...');

            // ✅ SALVAR DADOS COM SISTEMA ROBUSTO PARA RECUPERAÇÃO PÓS-PAGAMENTO
            try {
                const results = calculateResults();
                
                // Salvar dados completos para recuperação
                const savedData = DataStorage.saveQuizData(answers, results);
                
                // Também salvar dados específicos para checkout
                DataStorage.setItem('checkout_data', {
                    answers: answers,
                    results: results,
                    checkoutInitiatedAt: new Date().toISOString(),
                    checkoutSessionId: eventsTracker.sessionId,
                    userAgent: navigator.userAgent,
                    referrer: document.referrer,
                    pageUrl: window.location.href,
                    userProfile: {
                        goal: answers.goal,
                        gender: answers.gender,
                        age: answers.age,
                        activity: answers.activity,
                        name: answers.contact?.name,
                        email: answers.contact?.email,
                        bmr: results.bmr,
                        targetCalories: results.targetCalories,
                        projectedWeightChange: results.projectedWeightChange,
                        monthsToGoal: results.monthsToGoal
                    }
                });
                
                console.log('💾 Dados salvos para recuperação pós-pagamento:', savedData);
                
            } catch (error) {
                console.error('Erro ao salvar dados para recuperação:', error);
            }

            // ✅ EVENTOS META 100% COMPLIANCE - SEQUÊNCIA CORRETA
            try {
                const results = calculateResults();
                
                // ✅ 1. ADDTOCART - Primeiro evento da sequência de checkout
                const addToCartSuccess = eventsTracker.trackConversion('AddToCart', 39.90, 'BRL', {
                    content_type: 'product',
                    content_name: 'Protocolo Nutricional Dra Giovana',
                    content_ids: ['protocolo_nutricional_001'],
                    content_category: 'Health & Wellness',
                    num_items: 1,
                    user_goal: answers.goal,
                    user_gender: answers.gender
                });
                
                // ✅ 2. INITIATECHECKOUT - Segundo evento da sequência
                const initiateCheckoutSuccess = eventsTracker.trackConversion('InitiateCheckout', 39.90, 'BRL', {
                    content_type: 'product',
                    content_name: 'Protocolo Nutricional Dra Giovana',
                    content_ids: ['protocolo_nutricional_001'],
                    content_category: 'Health & Wellness',
                    num_items: 1,
                    checkout_step: 1,
                    user_goal: answers.goal,
                    user_gender: answers.gender,
                    user_age: answers.age,
                    user_bmr: results.bmr,
                    user_target_calories: results.targetCalories
                });
                
                // ✅ 3. EVENTO CUSTOMIZADO PARA TRACKING INTERNO
                eventsTracker.trackOnce('custom', 'Checkout_Button_Clicked', {
                    price: 39.90,
                    product_name: 'Protocolo Nutricional',
                    product_id: 'protocolo_nutricional_001',
                    checkout_url: 'https://pay.cakto.com.br/4ckeveg_405527',
                    user_profile: {
                        goal: answers.goal,
                        gender: answers.gender,
                        age: answers.age,
                        activity: answers.activity
                    }
                });
                
                if (addToCartSuccess && initiateCheckoutSuccess) {
                    console.log('✅ SEQUÊNCIA COMPLETA DE CHECKOUT ENVIADA COM 100% COMPLIANCE META');
                    console.log('   - AddToCart: ✅');
                    console.log('   - InitiateCheckout: ✅');
                } else {
                    console.warn('⚠️ Alguns eventos de checkout falharam - verificar logs acima');
                }
                
            } catch (e) {
                console.error('❌ Erro no tracking de checkout:', e);
            }

            // Visual feedback
            const button = document.getElementById('checkout-btn');
            if (button) {
                button.style.background = 'linear-gradient(135deg, #228B22, #32CD32)';
                button.innerHTML = '🚀 Redirecionando...';
                button.disabled = true;
            }

            // Multiple redirect attempts for better compatibility
            setTimeout(() => {
                try {
                    // Try window.open first
                    const newWindow = window.open('https://pay.cakto.com.br/4ckeveg_405527', '_blank');
                    
                    // Fallback if popup was blocked
                    if (!newWindow || newWindow.closed || typeof newWindow.closed == 'undefined') {
                        window.location.href = 'https://pay.cakto.com.br/4ckeveg_405527';
                    }
                } catch (e) {
                    // Ultimate fallback
                    window.location.href = 'https://pay.cakto.com.br/4ckeveg_405527';
                }
                
                // Reset button after delay
                setTimeout(() => {
                    if (button) {
                        button.style.background = 'linear-gradient(135deg, var(--primary), var(--secondary))';
                        button.innerHTML = '🔓 GARANTIR ACESSO POR R$ 39,90';
                        button.disabled = false;
                    }
                }, 3000);
            }, 200);
        }

        // Track scroll depth COM RATE LIMITING - evitar spam de eventos
        let maxScrollDepth = 0;
        let scrollEventsTracked = new Set();
        window.addEventListener('scroll', function() {
            const scrollPercent = Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100);
            
            if (scrollPercent > maxScrollDepth) {
                maxScrollDepth = scrollPercent;
                
                // Track scroll milestones - COM RATE LIMITING
                const milestones = [25, 50, 75, 90];
                for (const milestone of milestones) {
                    if (scrollPercent >= milestone && !scrollEventsTracked.has(milestone)) {
                        scrollEventsTracked.add(milestone);
                        eventsTracker.trackOnce('custom', `Scroll_Depth_${milestone}`, {
                            scroll_depth: milestone,
                            page_type: isOnLandingPage ? 'landing' : 'quiz'
                        });
                        break; // Só enviar um evento por vez
                    }
                }
            }
        });

        // Track time on page COM RATE LIMITING - evitar spam de eventos
        let timeOnPage = 0;
        let timeEventsTracked = new Set();
        setInterval(() => {
            timeOnPage += 10; // Aumentei para 10s para reduzir frequency
            
            // Track time milestones - COM RATE LIMITING
            const milestones = [30, 60, 120, 300];
            for (const milestone of milestones) {
                if (timeOnPage >= milestone && !timeEventsTracked.has(milestone)) {
                    timeEventsTracked.add(milestone);
                    eventsTracker.trackOnce('custom', `Time_On_Page_${milestone}s`, {
                        time_seconds: milestone,
                        page_type: isOnLandingPage ? 'landing' : 'quiz'
                    });
                    break; // Só enviar um evento por vez
                }
            }
        }, 10000); // Mudei para 10 segundos

        // Track page exit intent - COM RATE LIMITING
        let exitIntentTracked = false;
        document.addEventListener('mouseleave', function(e) {
            if (e.clientY <= 0 && !exitIntentTracked) {
                exitIntentTracked = true;
                eventsTracker.trackOnce('custom', 'Exit_Intent', {
                    time_on_page: timeOnPage,
                    max_scroll_depth: maxScrollDepth,
                    current_question: currentQuestion + 1,
                    page_type: isOnLandingPage ? 'landing' : 'quiz'
                });
            }
        });

    </script>
</body>
</html>
