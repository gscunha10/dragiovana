<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Dieta Personalizada - Dra. Giovana Nutricionista</title>
    
    <!-- Meta Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1002938195345180');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1002938195345180&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2c7a2c;
            --secondary: #4a9f4a;
            --accent: #6cc04a;
            --dark: #0a0a0a;
            --light: #ffffff;
            --gray: #1a1a1a;
            --success: #00ff88;
            --danger: #ff3366;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: 
                radial-gradient(circle at 20% 80%, rgba(44, 122, 44, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(108, 192, 74, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(74, 159, 74, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            color: var(--light);
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--accent);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
            opacity: 0.3;
        }

        .particle:nth-child(odd) {
            background: var(--primary);
            animation-duration: 8s;
        }

        .particle:nth-child(3n) {
            background: var(--secondary);
            animation-duration: 10s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.3; }
            50% { transform: translateY(-100px) rotate(180deg); opacity: 0.8; }
        }

        .header {
            position: relative;
            z-index: 100;
            padding: 20px 0;
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(44, 122, 44, 0.2);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 0 4px 20px rgba(44, 122, 44, 0.3);
        }

        .trust-indicators {
            display: flex;
            align-items: center;
            gap: 20px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .trust-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            min-height: calc(100vh - 80px);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 10;
        }

        .landing-card, .quiz-card {
            background: rgba(26, 26, 26, 0.9);
            backdrop-filter: blur(30px);
            border-radius: 32px;
            padding: 50px;
            width: 100%;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(44, 122, 44, 0.2);
            box-shadow: 
                0 32px 64px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transform: translateY(20px);
            opacity: 0;
            animation: slideInUp 1s ease-out 0.2s forwards;
            text-align: center;
        }

        @keyframes slideInUp {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .landing-card::before, .quiz-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--primary), var(--accent), var(--secondary));
            border-radius: 32px;
            padding: 2px;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: xor;
            -webkit-mask-composite: xor;
            opacity: 0.6;
            animation: borderGlow 3s ease-in-out infinite alternate;
        }

        @keyframes borderGlow {
            0% { opacity: 0.3; }
            100% { opacity: 0.8; }
        }

        .badge {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            margin-bottom: 30px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .main-title {
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--light), rgba(255, 255, 255, 0.8));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }

        .subtitle {
            font-size: 22px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 40px;
            line-height: 1.4;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .doctor-section {
            margin: 50px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .doctor-photo {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            position: relative;
            animation: float-gentle 3s ease-in-out infinite;
            overflow: hidden;
            box-shadow: 
                0 20px 40px rgba(44, 122, 44, 0.3),
                inset 0 4px 8px rgba(255, 255, 255, 0.1);
        }

        .doctor-photo::after {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 50%;
            z-index: -1;
            opacity: 0.5;
            animation: pulse 2s ease-in-out infinite;
        }

        .doctor-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            border: 4px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes float-gentle {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .doctor-info {
            max-width: 600px;
        }

        .doctor-name {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--accent), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .doctor-credentials {
            font-size: 18px;
            color: var(--accent);
            margin-bottom: 25px;
            font-weight: 600;
        }

        .doctor-description {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
            text-align: left;
            margin-bottom: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(44, 122, 44, 0.2);
        }

        .stat-number {
            font-size: 28px;
            font-weight: 900;
            color: var(--accent);
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 600;
        }

        .benefits-section {
            margin: 50px 0;
            text-align: left;
        }

        .benefits-title {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 30px;
            text-align: center;
            background: linear-gradient(135deg, var(--accent), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .benefit-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            border: 1px solid rgba(44, 122, 44, 0.2);
            transition: all 0.3s ease;
        }

        .benefit-item:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
            background: rgba(44, 122, 44, 0.1);
        }

        .benefit-icon {
            font-size: 24px;
            min-width: 24px;
        }

        .benefit-text {
            font-size: 15px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.4;
        }

        .cta-section {
            background: linear-gradient(135deg, rgba(44, 122, 44, 0.15), rgba(108, 192, 74, 0.1));
            border: 2px solid rgba(44, 122, 44, 0.3);
            border-radius: 24px;
            padding: 40px;
            margin-top: 40px;
        }

        .cta-title {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 15px;
            color: var(--light);
        }

        .cta-subtitle {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .cta-button {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(44, 122, 44, 0.4);
            width: 100%;
            max-width: 400px;
            position: relative;
            overflow: hidden;
        }

        .cta-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }

        .cta-button:hover::before {
            left: 100%;
        }

        .cta-button:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 12px 48px rgba(44, 122, 44, 0.6);
        }

        .disclaimer {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 20px;
            line-height: 1.4;
        }

        /* QUIZ STYLES */
        .progress-section {
            margin-bottom: 40px;
            position: relative;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .progress-text {
            font-size: 14px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .progress-doctor {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--accent);
            font-weight: 600;
        }

        .doctor-pulse {
            width: 8px;
            height: 8px;
            background: var(--accent);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
            border-radius: 10px;
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0%;
            position: relative;
            box-shadow: 0 0 20px rgba(44, 122, 44, 0.5);
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .question-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .question-number {
            width: 60px;
            height: 60px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 800;
            margin: 0 auto 20px;
            box-shadow: 0 8px 32px rgba(44, 122, 44, 0.4);
            position: relative;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .question-number::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 22px;
            z-index: -1;
            opacity: 0.3;
        }

        .question-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--light), rgba(255, 255, 255, 0.8));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }

        .question-subtitle {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.5;
            max-width: 600px;
            margin: 0 auto;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 50px;
        }

        .option-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            text-align: center;
        }

        .option-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .option-card:hover::before {
            left: 100%;
        }

        .option-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: var(--primary);
            box-shadow: 
                0 20px 40px rgba(44, 122, 44, 0.2),
                0 0 0 1px rgba(44, 122, 44, 0.1);
            background: rgba(44, 122, 44, 0.1);
        }

        .option-card.selected {
            transform: translateY(-8px) scale(1.05);
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(44, 122, 44, 0.2), rgba(108, 192, 74, 0.1));
            box-shadow: 
                0 24px 48px rgba(44, 122, 44, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .option-card.selected .option-icon {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            transform: scale(1.1);
            box-shadow: 0 8px 32px rgba(44, 122, 44, 0.4);
        }

        .option-icon {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            margin: 0 auto 20px;
            transition: all 0.4s ease;
            position: relative;
        }

        .option-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--light);
        }

        .option-description {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.5;
        }

        .form-grid {
            display: grid;
            gap: 25px;
            margin-bottom: 50px;
        }

        .input-group {
            position: relative;
        }

        .input-label {
            display: block;
            font-size: 16px;
            font-weight: 600;
            color: var(--light);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .input-field {
            width: 100%;
            padding: 20px 24px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            font-size: 18px;
            color: var(--light);
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(44, 122, 44, 0.1);
            box-shadow: 0 0 0 4px rgba(44, 122, 44, 0.1);
            transform: translateY(-2px);
        }

        .input-field::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
        }

        .btn {
            padding: 18px 36px;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
            border: 2px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 8px 32px rgba(44, 122, 44, 0.4);
            position: relative;
            border: 2px solid transparent;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 12px 48px rgba(44, 122, 44, 0.6);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .results-container {
            text-align: center;
            animation: revealAnimation 1s ease-out;
        }

        .success-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: successBounce 1s ease-out;
        }

        @keyframes successBounce {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .reveal-title {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--success), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .reveal-subtitle {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 40px;
            line-height: 1.5;
        }

        .results-grid {
            display: grid;
            gap: 30px;
        }

        .mega-result-card {
            background: rgba(20, 20, 20, 0.95);
            border: 3px solid var(--primary);
            border-radius: 32px;
            padding: 40px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(44, 122, 44, 0.3);
            text-align: center;
        }

        .result-badge {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            margin-bottom: 20px;
        }

        .result-value {
            font-size: 72px;
            font-weight: 900;
            color: var(--danger);
            text-shadow: 0 0 30px rgba(255, 51, 102, 0.5);
            margin-bottom: 10px;
            animation: numberPulse 2s ease-in-out infinite;
        }

        .result-label {
            font-size: 24px;
            font-weight: 800;
            color: var(--accent);
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timeline-row {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(0, 0, 0, 0.4);
            padding: 12px 20px;
            border-radius: 12px;
            border: 1px solid rgba(44, 122, 44, 0.3);
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .results-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(44, 122, 44, 0.2);
        }

        .metric-card.calories {
            border-color: var(--primary);
            background: rgba(44, 122, 44, 0.1);
        }

        .metric-icon {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .metric-value {
            font-size: 32px;
            font-weight: 900;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .metric-label {
            font-size: 16px;
            font-weight: 700;
            color: var(--light);
            margin-bottom: 5px;
        }

        .metric-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }

        .cta-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(44, 122, 44, 0.4);
            width: 100%;
            max-width: 400px;
        }

        .cta-primary:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 12px 48px rgba(44, 122, 44, 0.6);
        }

        /* HIDE CLASSES */
        .hidden {
            display: none !important;
        }

        .cta-button.loading {
            pointer-events: none;
            opacity: 0.8;
        }

        .cta-button.loading::after {
            content: '';
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes revealAnimation {
            from { opacity: 0; transform: scale(0.9) translateY(30px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        
        @keyframes numberPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes doctorPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes processingGlow {
            0%, 100% { 
                border-color: rgba(44, 122, 44, 0.3); 
                box-shadow: 0 0 20px rgba(44, 122, 44, 0.2); 
            }
            50% { 
                border-color: rgba(44, 122, 44, 0.8); 
                box-shadow: 0 0 30px rgba(44, 122, 44, 0.5); 
            }
        }
        
        .processing {
            animation: processingGlow 2s ease-in-out infinite !important;
            background: rgba(44, 122, 44, 0.15) !important;
            border-color: rgba(44, 122, 44, 0.5) !important;
        }
        
        .completed {
            background: rgba(0, 255, 136, 0.15) !important;
            border-color: rgba(0, 255, 136, 0.5) !important;
        }
        
        @keyframes countUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .header {
                padding: 15px 0;
            }

            .header-content {
                flex-direction: column;
                gap: 12px;
                padding: 0 15px;
            }

            .trust-indicators {
                order: -1;
                flex-wrap: wrap;
                justify-content: center;
                gap: 15px;
            }

            .trust-item {
                font-size: 11px;
            }

            .logo {
                font-size: 20px;
            }

            .logo-icon {
                width: 35px;
                height: 35px;
                font-size: 18px;
            }

            .container {
                padding: 15px 12px;
                min-height: calc(100vh - 60px);
            }

            .landing-card, .quiz-card {
                padding: 25px 20px;
                border-radius: 20px;
                box-shadow: 
                    0 20px 40px rgba(0, 0, 0, 0.3),
                    inset 0 1px 0 rgba(255, 255, 255, 0.1);
            }

            .badge {
                font-size: 12px;
                padding: 6px 16px;
                margin-bottom: 25px;
            }

            .main-title {
                font-size: 28px;
                margin-bottom: 15px;
                line-height: 1.2;
            }

            .subtitle {
                font-size: 16px;
                margin-bottom: 25px;
                line-height: 1.4;
            }

            .doctor-section {
                margin: 35px 0;
                gap: 25px;
            }

            .doctor-photo {
                width: 140px;
                height: 140px;
            }

            .doctor-info {
                max-width: 100%;
            }

            .doctor-name {
                font-size: 22px;
                margin-bottom: 10px;
            }

            .doctor-credentials {
                font-size: 15px;
                margin-bottom: 18px;
            }

            .doctor-description {
                font-size: 14px;
                text-align: center;
                line-height: 1.5;
            }

            .doctor-description p {
                margin-bottom: 12px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                margin: 30px 0;
            }

            .stat-card {
                padding: 18px 12px;
                border-radius: 16px;
            }

            .stat-number {
                font-size: 22px;
                margin-bottom: 6px;
            }

            .stat-label {
                font-size: 12px;
                line-height: 1.2;
            }

            .benefits-section {
                margin: 35px 0;
            }

            .benefits-title {
                font-size: 22px;
                margin-bottom: 25px;
            }

            .benefits-grid {
                grid-template-columns: 1fr;
                gap: 12px;
                margin-bottom: 30px;
            }

            .benefit-item {
                padding: 16px;
                border-radius: 12px;
                gap: 12px;
            }

            .benefit-icon {
                font-size: 20px;
                min-width: 20px;
            }

            .benefit-text {
                font-size: 14px;
                line-height: 1.4;
            }

            .cta-section {
                padding: 25px 18px;
                border-radius: 18px;
                margin-top: 30px;
            }

            .cta-title {
                font-size: 20px;
                margin-bottom: 12px;
                line-height: 1.3;
            }

            .cta-subtitle {
                font-size: 14px;
                margin-bottom: 25px;
                line-height: 1.4;
            }

            .cta-button {
                padding: 16px 25px;
                font-size: 15px;
                border-radius: 12px;
                max-width: 100%;
                font-weight: 800;
                letter-spacing: 0.5px;
                line-height: 1.2;
            }

            .question-title {
                font-size: 20px;
                line-height: 1.2;
                margin-bottom: 12px;
            }

            .question-subtitle {
                font-size: 15px;
                margin-bottom: 25px;
            }

            .question-number {
                width: 45px;
                height: 45px;
                font-size: 18px;
                border-radius: 14px;
                margin-bottom: 15px;
            }

            .options-grid {
                grid-template-columns: 1fr;
                gap: 10px;
                margin-bottom: 35px;
            }

            .option-card {
                padding: 16px 14px;
                border-radius: 14px;
                min-height: 60px;
            }

            .option-icon {
                width: 50px;
                height: 50px;
                font-size: 22px;
                border-radius: 14px;
                margin: 0 auto 12px;
            }

            .option-title {
                font-size: 16px;
                margin-bottom: 6px;
            }

            .option-description {
                font-size: 12px;
                line-height: 1.3;
            }

            .action-buttons {
                flex-direction: column;
                gap: 10px;
            }

            .btn {
                width: 100%;
                padding: 14px 20px;
                font-size: 14px;
                border-radius: 12px;
                min-height: 48px;
            }

            .results-metrics {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .metric-card {
                padding: 16px 12px;
                border-radius: 14px;
            }

            .metric-icon {
                font-size: 24px;
                margin-bottom: 10px;
            }

            .metric-value {
                font-size: 20px;
                margin-bottom: 5px;
            }

            .metric-label {
                font-size: 13px;
                margin-bottom: 3px;
            }

            .metric-subtitle {
                font-size: 10px;
            }

            .form-grid {
                gap: 16px;
            }

            .input-field {
                padding: 14px 16px;
                font-size: 15px;
                border-radius: 10px;
                min-height: 48px;
            }

            .input-label {
                font-size: 13px;
                margin-bottom: 6px;
            }
            
            #social-notifications, #social-notifications-bottom {
                width: 220px !important;
                right: 8px !important;
            }
            
            #social-notifications {
                top: 8px !important;
            }
            
            #social-notifications-bottom {
                bottom: 8px !important;
            }

            .success-icon {
                font-size: 50px !important;
                margin-bottom: 12px !important;
            }
            
            .reveal-title {
                font-size: 24px !important;
                line-height: 1.1 !important;
                margin-bottom: 12px !important;
            }
            
            .reveal-subtitle {
                font-size: 14px !important;
                margin-bottom: 25px !important;
            }
            
            .result-value {
                font-size: 40px !important;
                margin-bottom: 6px !important;
            }
            
            .result-label {
                font-size: 16px !important;
                margin-bottom: 15px !important;
            }
            
            .mega-result-card {
                padding: 20px 15px !important;
                border-radius: 16px !important;
            }
            
            .cta-section {
                padding: 20px 15px !important;
                border-radius: 16px !important;
            }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>

    <header class="header">
        <div class="header-content">
            <div class="trust-indicators">
                <div class="trust-item">
                    <span>üîí</span>
                    <span>Dados Seguros</span>
                </div>
                <div class="trust-item">
                    <span>‚ö°</span>
                    <span>Resultado em 2min</span>
                </div>
                <div class="trust-item">
                    <span>üë•</span>
                    <span>+10.000 atendidos</span>
                </div>
            </div>
            <div class="logo">
                <div class="logo-icon">üë©‚Äç‚öïÔ∏è</div>
                <span>Dra. Giovana Nutricionista</span>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- ‚úÖ LANDING PAGE -->
        <div class="landing-card" id="landingPage">
            <div class="badge">‚ú® Nutricionista Especialista</div>
            
            <h1 class="main-title">Descubra Sua Dieta Personalizada</h1>
            <p class="subtitle">
                Responda algumas perguntas simples e receba um plano nutricional 
                <strong>cient√≠fico e personalizado</strong> criado especialmente para seus objetivos
            </p>

            <div class="doctor-section">
                <div class="doctor-photo">
                    <img src="Dra Giovana.png" alt="Dra. Giovana Silva - Nutricionista" />
                </div>
                
                <div class="doctor-info">
                    <h2 class="doctor-name">Dra. Giovana Silva</h2>
                    <p class="doctor-credentials">CRN-3 87654 ‚Ä¢ Nutricionista Cl√≠nica Especialista</p>
                    <div class="doctor-description">
                        <p><strong>Graduada em Nutri√ß√£o</strong> pela Universidade Federal, com especializa√ß√£o em Nutri√ß√£o Cl√≠nica e Esportiva. Mais de 8 anos ajudando pessoas a transformarem seus h√°bitos alimentares e conquistarem seus objetivos de sa√∫de.</p>
                        
                        <p style="margin-top: 15px;"><strong>Minha miss√£o:</strong> Democratizar o acesso √† nutri√ß√£o de qualidade, criando planos alimentares personalizados que respeitam sua rotina, prefer√™ncias e condi√ß√µes de sa√∫de.</p>
                    </div>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">+10.000</div>
                    <div class="stat-label">Pessoas Transformadas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">98%</div>
                    <div class="stat-label">Taxa de Sucesso</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">8 Anos</div>
                    <div class="stat-label">de Experi√™ncia</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">4.9‚≠ê</div>
                    <div class="stat-label">Avalia√ß√£o M√©dia</div>
                </div>
            </div>

            <div class="benefits-section">
                <h3 class="benefits-title">üéØ O que voc√™ vai receber:</h3>
                
                <div class="benefits-grid">
                    <div class="benefit-item">
                        <div class="benefit-icon">üìä</div>
                        <div class="benefit-text">
                            <strong>An√°lise Completa:</strong> Avalia√ß√£o detalhada do seu perfil metab√≥lico e necessidades nutricionais
                        </div>
                    </div>
                    
                    <div class="benefit-item">
                        <div class="benefit-icon">ü•ó</div>
                        <div class="benefit-text">
                            <strong>Card√°pio Personalizado:</strong> Receitas adaptadas √†s suas restri√ß√µes, prefer√™ncias e objetivo
                        </div>
                    </div>
                    
                    <div class="benefit-item">
                        <div class="benefit-icon">üì±</div>
                        <div class="benefit-text">
                            <strong>Lista de Compras:</strong> Todos os alimentos organizados para facilitar suas compras
                        </div>
                    </div>
                    
                    <div class="benefit-item">
                        <div class="benefit-icon">‚öñÔ∏è</div>
                        <div class="benefit-text">
                            <strong>C√°lculo de Macros:</strong> Quantidade exata de prote√≠nas, carboidratos e gorduras
                        </div>
                    </div>
                    
                    <div class="benefit-item">
                        <div class="benefit-icon">üçΩÔ∏è</div>
                        <div class="benefit-text">
                            <strong>200+ Receitas:</strong> Op√ß√µes deliciosas e variadas para n√£o enjoar da dieta
                        </div>
                    </div>
                    
                    <div class="benefit-item">
                        <div class="benefit-icon">üíö</div>
                        <div class="benefit-text">
                            <strong>Adapta√ß√£o √† Sa√∫de:</strong> Consideramos suas condi√ß√µes m√©dicas e alergias
                        </div>
                    </div>
                </div>
            </div>

            <div class="cta-section">
                <h3 class="cta-title">üöÄ Pronta para Transformar sua Alimenta√ß√£o?</h3>
                <p class="cta-subtitle">
                    S√£o apenas 9 perguntas simples e em 2 minutos voc√™ ter√° seu plano nutricional completo
                </p>
                
                <button class="cta-button" id="startQuizBtn">
                    üî• Iniciar Minha Dieta Personalizada
                </button>
                
                <p class="disclaimer">
                    ‚úÖ 100% Gratuito ‚Ä¢ ‚ö° Resultado Imediato ‚Ä¢ üîí Dados Protegidos
                </p>
            </div>
        </div>

        <!-- ‚úÖ QUIZ SECTION -->
        <div class="quiz-card hidden" id="quizSection">
            <div class="progress-section">
                <div class="progress-header">
                    <div class="progress-text" id="progressText">Avalia√ß√£o Nutricional - Etapa 1 de 9</div>
                    <div class="progress-doctor">
                        <div class="doctor-pulse"></div>
                        <span>Dra. Giovana</span>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <div id="questionContainer">
                <div class="question-header">
                    <div class="question-number" id="questionNumber">1</div>
                    <h1 class="question-title" id="questionTitle">Qual √© o seu principal objetivo?</h1>
                    <p class="question-subtitle" id="questionSubtitle">
                        Para criar um plano nutricional personalizado, preciso entender qual √© sua meta principal.
                    </p>
                </div>

                <div class="options-grid" id="optionsGrid">
                    <!-- Ser√° preenchido dinamicamente -->
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" id="backBtn" style="display: none;">
                        ‚Üê Voltar
                    </button>
                    <button class="btn btn-primary" id="nextBtn" disabled>
                        Continuar ‚Üí
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentQuestion = 0;
        let answers = {};
        let isOnLandingPage = true;
        
        // ‚úÖ Hash routing - Mapeamento de hash para cada pergunta
        const hashMap = [
            'objetivo',    // Pergunta 0
            'genero',      // Pergunta 1
            'idade',       // Pergunta 2
            'atividade',   // Pergunta 3
            'fisico',      // Pergunta 4
            'saude',       // Pergunta 5
            'alergias',    // Pergunta 6
            'dieta',       // Pergunta 7
            'contato'      // Pergunta 8
        ];

        // ‚úÖ Fun√ß√£o para atualizar URL e disparar PageView
        function updateURL(questionIndex) {
            let newHash = '';
            let pageName = '';
            
            if (questionIndex === 'landing') {
                newHash = '';
                pageName = 'Landing Page';
            } else if (questionIndex === 'analise') {
                newHash = 'analise';
                pageName = 'An√°lise Nutricional';
            } else if (questionIndex === 'resultado') {
                newHash = 'resultado';
                pageName = 'Resultados';
            } else if (questionIndex < hashMap.length) {
                newHash = hashMap[questionIndex];
                pageName = `Pergunta ${questionIndex + 1} - ${hashMap[questionIndex]}`;
            }
            
            // Atualizar URL
            if (window.location.hash !== '#' + newHash) {
                window.location.hash = newHash;
            }
            
            // ‚úÖ DISPARAR PAGEVIEW PARA CADA "P√ÅGINA"
            eventsTracker.trackOnce('standard', `PageView_${newHash || 'landing'}`, {
                content_type: 'quiz_page',
                content_name: pageName,
                content_category: 'quiz_step',
                page_location: window.location.href,
                page_title: pageName
            });
            
            console.log(`üìÑ P√°gina rastreada: ${pageName} (${window.location.href})`);
        }

        // ‚úÖ Fun√ß√£o para obter pergunta pelo hash
        function getQuestionFromHash() {
            const hash = window.location.hash.substring(1);
            if (!hash) return 'landing';
            if (hash === 'analise') return 'analise';
            if (hash === 'resultado') return 'resultado';
            const index = hashMap.indexOf(hash);
            return index >= 0 ? index : 'landing';
        }

        // ‚úÖ SISTEMA DE PERSIST√äNCIA DE DADOS (com fallback)
        const DataStorage = {
            // Tenta usar localStorage, se n√£o conseguir usa mem√≥ria
            isLocalStorageAvailable: function() {
                try {
                    const testKey = 'test_' + Date.now();
                    localStorage.setItem(testKey, 'test');
                    localStorage.removeItem(testKey);
                    return true;
                } catch (e) {
                    return false;
                }
            },
            
            memoryStorage: {}, // Fallback em mem√≥ria
            
            setItem: function(key, value) {
                const jsonValue = JSON.stringify(value);
                if (this.isLocalStorageAvailable()) {
                    try {
                        localStorage.setItem('dra_giovana_' + key, jsonValue);
                        console.log(`üíæ Dados salvos no localStorage: ${key}`);
                        return true;
                    } catch (e) {
                        console.warn('Erro ao salvar no localStorage, usando mem√≥ria:', e);
                    }
                }
                // Fallback para mem√≥ria
                this.memoryStorage['dra_giovana_' + key] = jsonValue;
                console.log(`üíæ Dados salvos na mem√≥ria: ${key}`);
                return true;
            },
            
            getItem: function(key) {
                const fullKey = 'dra_giovana_' + key;
                if (this.isLocalStorageAvailable()) {
                    try {
                        const value = localStorage.getItem(fullKey);
                        if (value) {
                            console.log(`üìÑ Dados recuperados do localStorage: ${key}`);
                            return JSON.parse(value);
                        }
                    } catch (e) {
                        console.warn('Erro ao ler localStorage:', e);
                    }
                }
                // Fallback para mem√≥ria
                const memValue = this.memoryStorage[fullKey];
                if (memValue) {
                    console.log(`üìÑ Dados recuperados da mem√≥ria: ${key}`);
                    return JSON.parse(memValue);
                }
                return null;
            },
            
            removeItem: function(key) {
                const fullKey = 'dra_giovana_' + key;
                if (this.isLocalStorageAvailable()) {
                    try {
                        localStorage.removeItem(fullKey);
                    } catch (e) {
                        console.warn('Erro ao remover do localStorage:', e);
                    }
                }
                delete this.memoryStorage[fullKey];
                console.log(`üóëÔ∏è Dados removidos: ${key}`);
            },
            
            // ‚úÖ Salvar dados do quiz para recupera√ß√£o p√≥s-pagamento
            saveQuizData: function(answers, results) {
                const quizData = {
                    answers: answers,
                    results: results,
                    completedAt: new Date().toISOString(),
                    sessionId: eventsTracker.sessionId,
                    userAgent: navigator.userAgent,
                    timestamp: Date.now()
                };
                
                this.setItem('quiz_data', quizData);
                this.setItem('user_profile', {
                    goal: answers.goal,
                    name: answers.contact?.name,
                    email: answers.contact?.email,
                    bmr: results.bmr,
                    targetCalories: results.targetCalories,
                    projectedWeightChange: results.projectedWeightChange
                });
                
                console.log('üíæ Dados completos do quiz salvos para recupera√ß√£o p√≥s-pagamento');
                return quizData;
            },
            
            // ‚úÖ Recuperar dados para personaliza√ß√£o
            getQuizData: function() {
                return this.getItem('quiz_data');
            },
            
            getUserProfile: function() {
                return this.getItem('user_profile');
            },
            
            // ‚úÖ Verificar se usu√°rio j√° fez o quiz
            hasCompletedQuiz: function() {
                const data = this.getQuizData();
                return data && data.answers && data.results;
            }
        };
        
        // ‚úÖ SISTEMA ANTI-DUPLICA√á√ÉO DE EVENTOS (SEM SESSIONSTORAGE)
        let eventsTracker = {
            sent: new Set(),
            sessionId: 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
            
            // Gera ID √∫nico para cada evento
            generateEventId: function() {
                return 'evt_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            },
            
            // Verifica se evento j√° foi enviado (apenas na mem√≥ria)
            hasBeenSent: function(eventName) {
                return this.sent.has(eventName);
            },
            
            // Marca evento como enviado (apenas na mem√≥ria)
            markAsSent: function(eventName) {
                this.sent.add(eventName);
            },
            
            // Dispara evento apenas se n√£o foi enviado antes COM EVENT_ID √öNICO
            trackOnce: function(eventType, eventName, parameters = {}) {
                if (this.hasBeenSent(eventName)) {
                    console.log(`üîÑ Evento "${eventName}" j√° foi enviado - evitando duplica√ß√£o`);
                    return false;
                }
                
                if (typeof fbq !== 'undefined') {
                    // ‚úÖ ADICIONAR EVENT_ID √öNICO para evitar duplica√ß√£o no Facebook
                    const eventId = this.generateEventId();
                    const eventData = {
                        ...parameters,
                        event_id: eventId, // Facebook requer este campo para deduplicar
                        session_id: this.sessionId
                    };
                    
                    if (eventType === 'custom') {
                        fbq('trackCustom', eventName, eventData, {
                            eventID: eventId // Tamb√©m passar como op√ß√£o
                        });
                    } else {
                        fbq('track', eventName, eventData, {
                            eventID: eventId // Tamb√©m passar como op√ß√£o
                        });
                    }
                    
                    this.markAsSent(eventName);
                    console.log(`‚úÖ Evento "${eventName}" enviado com event_id √∫nico: ${eventId}`);
                    return true;
                } else {
                    console.warn('‚ö†Ô∏è Facebook Pixel n√£o encontrado');
                    return false;
                }
            }
        };
        
        const questions = [
            {
                title: "Qual √© o seu principal objetivo?",
                subtitle: "Para criar um plano nutricional personalizado, preciso entender qual √© sua meta principal.",
                type: "choice",
                options: [
                    { value: "lose_weight", icon: "üî•", title: "Perder Peso", description: "Eliminar gordura corporal de forma saud√°vel e sustent√°vel" },
                    { value: "gain_muscle", icon: "üí™", title: "Ganhar Massa Muscular", description: "Construir m√∫sculos magros e defini√ß√£o corporal" },
                    { value: "maintain", icon: "‚öñÔ∏è", title: "Manter Peso", description: "Equilibrar a alimenta√ß√£o e manter o peso atual" },
                    { value: "health", icon: "üå±", title: "Melhorar Sa√∫de", description: "Otimizar nutri√ß√£o para mais energia e bem-estar" }
                ]
            },
            {
                title: "Qual √© o seu sexo biol√≥gico?",
                subtitle: "Homens e mulheres t√™m necessidades metab√≥licas diferentes, isso me ajuda a calcular suas necessidades cal√≥ricas.",
                type: "choice",
                options: [
                    { value: "male", icon: "üë®", title: "Masculino", description: "Metabolismo masculino" },
                    { value: "female", icon: "üë©", title: "Feminino", description: "Metabolismo feminino" }
                ]
            },
            {
                title: "Qual √© a sua faixa et√°ria?",
                subtitle: "A idade influencia diretamente seu metabolismo basal e necessidades nutricionais espec√≠ficas.",
                type: "choice",
                options: [
                    { value: "18-25", icon: "üöÄ", title: "18-25 anos", description: "Metabolismo acelerado" },
                    { value: "26-35", icon: "üíº", title: "26-35 anos", description: "Vida adulta ativa" },
                    { value: "36-45", icon: "üéØ", title: "36-45 anos", description: "Metabolismo est√°vel" },
                    { value: "46-55", icon: "üßò", title: "46-55 anos", description: "Foco em longevidade" },
                    { value: "55+", icon: "üåü", title: "55+ anos", description: "Nutri√ß√£o para maturidade" }
                ]
            },
            {
                title: "Qual √© o seu n√≠vel de atividade f√≠sica?",
                subtitle: "Preciso saber quanto voc√™ se exercita para calcular corretamente suas necessidades cal√≥ricas di√°rias.",
                type: "choice",
                options: [
                    { value: "sedentary", icon: "üõãÔ∏è", title: "Sedent√°rio", description: "Pouco ou nenhum exerc√≠cio" },
                    { value: "light", icon: "üö∂", title: "Leve", description: "Exerc√≠cio leve 1-3 dias/semana" },
                    { value: "moderate", icon: "üèÉ", title: "Moderado", description: "Exerc√≠cio moderado 3-5 dias/semana" },
                    { value: "intense", icon: "üí™", title: "Intenso", description: "Exerc√≠cio intenso 6-7 dias/semana" }
                ]
            },
            {
                title: "Informa√ß√µes Antropom√©tricas",
                subtitle: "Estes dados s√£o fundamentais para calcular seu metabolismo basal e determinar suas necessidades nutricionais.",
                type: "form",
                fields: [
                    { name: "weight", label: "Peso Atual (kg)", type: "number", placeholder: "Ex: 70" },
                    { name: "height", label: "Altura (cm)", type: "number", placeholder: "Ex: 170" },
                    { name: "target_weight", label: "Peso Desejado (kg)", type: "number", placeholder: "Ex: 65" }
                ]
            },
            {
                title: "Condi√ß√µes de Sa√∫de e Hist√≥rico M√©dico",
                subtitle: "√â fundamental conhecer seu hist√≥rico de sa√∫de para personalizar um plano nutricional seguro e eficaz para voc√™.",
                type: "choice",
                multiSelect: true,
                options: [
                    { value: "healthy", icon: "üíö", title: "Sem Condi√ß√µes Especiais", description: "N√£o possuo condi√ß√µes de sa√∫de que afetem minha alimenta√ß√£o" },
                    { value: "diabetes", icon: "ü©∏", title: "Diabetes", description: "Tenho diabetes tipo 1 ou 2" },
                    { value: "hypertension", icon: "‚ù§Ô∏è", title: "Hipertens√£o", description: "Press√£o arterial elevada" },
                    { value: "thyroid", icon: "ü¶ã", title: "Problemas na Tireoide", description: "Hipotireoidismo ou hipertireoidismo" },
                    { value: "digestive", icon: "ü§±", title: "Problemas Digestivos", description: "Gastrite, refluxo, s√≠ndrome do intestino irrit√°vel" },
                    { value: "kidney", icon: "ü´ò", title: "Problemas Renais", description: "Insufici√™ncia renal ou c√°lculos renais" },
                    { value: "heart", icon: "üíì", title: "Problemas Card√≠acos", description: "Colesterol alto, triglic√©rides, problemas cardiovasculares" }
                ]
            },
            {
                title: "Alergias e Intoler√¢ncias Alimentares",
                subtitle: "Preciso saber sobre qualquer alergia ou intoler√¢ncia para garantir que seu plano seja 100% seguro para voc√™.",
                type: "choice",
                multiSelect: true,
                options: [
                    { value: "no_allergies", icon: "‚úÖ", title: "Sem Alergias", description: "N√£o tenho alergias ou intoler√¢ncias conhecidas" },
                    { value: "lactose", icon: "ü•õ", title: "Intoler√¢ncia √† Lactose", description: "Tenho dificuldade para digerir latic√≠nios" },
                    { value: "gluten", icon: "üåæ", title: "Intoler√¢ncia ao Gl√∫ten", description: "Doen√ßa cel√≠aca ou sensibilidade ao gl√∫ten" },
                    { value: "nuts", icon: "ü•ú", title: "Alergia a Oleaginosas", description: "Alergia a amendoim, castanhas, nozes" },
                    { value: "seafood", icon: "ü¶ê", title: "Alergia a Frutos do Mar", description: "Alergia a camar√£o, peixe, crust√°ceos" },
                    { value: "eggs", icon: "ü•ö", title: "Alergia a Ovos", description: "Alergia √† prote√≠na do ovo" },
                    { value: "soy", icon: "ü´ò", title: "Alergia √† Soja", description: "Alergia ou intoler√¢ncia √† soja" }
                ]
            },
            {
                title: "Prefer√™ncias e Estilo Alimentar",
                subtitle: "Vou personalizar seu card√°pio respeitando suas prefer√™ncias alimentares e estilo de vida.",
                type: "choice",
                options: [
                    { value: "no_restrictions", icon: "üçΩÔ∏è", title: "Sem Restri√ß√µes", description: "Como todos os tipos de alimentos" },
                    { value: "vegetarian", icon: "ü•ó", title: "Vegetariano", description: "N√£o como carne, mas consumo ovos e latic√≠nios" },
                    { value: "vegan", icon: "üå±", title: "Vegano", description: "Apenas alimentos de origem vegetal" },
                    { value: "low_carb", icon: "ü•©", title: "Low Carb", description: "Prefiro reduzir carboidratos" },
                    { value: "mediterranean", icon: "ü´í", title: "Mediterr√¢nea", description: "Foco em azeite, peixes, vegetais" },
                    { value: "paleo", icon: "ü¶¥", title: "Paleo", description: "Alimentos n√£o processados, como nossos ancestrais" }
                ]
            },
            {
                title: "Dados para Acompanhamento",
                subtitle: "Para enviar seu plano personalizado e fazer o acompanhamento da sua evolu√ß√£o nutricional.",
                type: "form",
                fields: [
                    { name: "name", label: "Nome Completo", type: "text", placeholder: "Seu nome completo" },
                    { name: "email", label: "E-mail", type: "email", placeholder: "seu@email.com" },
                    { name: "phone", label: "WhatsApp", type: "tel", placeholder: "(11) 99999-9999" }
                ]
            }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            
            // ‚úÖ INICIALIZAR SESS√ÉO √öNICA PARA TRACKING (SEM SESSIONSTORAGE)
            console.log('üÜî Nova sess√£o iniciada:', eventsTracker.sessionId);
            
            // Mobile-specific initializations
            initializeMobileOptimizations();
            
            // ‚úÖ VERIFICAR SE USU√ÅRIO J√Å COMPLETOU O QUIZ
            const existingData = DataStorage.getQuizData();
            if (existingData && existingData.answers && existingData.results) {
                console.log('üîÑ Usu√°rio retornando detectado - dados encontrados');
                answers = existingData.answers;
                
                // Se est√° na URL de resultado, mostrar resultados salvos
                const currentRoute = getQuestionFromHash();
                if (currentRoute === 'resultado') {
                    console.log('üìä Mostrando resultados salvos para usu√°rio retornando');
                    setTimeout(() => {
                        showQuizSection();
                        showFinalResults();
                    }, 100);
                    return;
                }
            }
            
            // ‚úÖ Verificar hash na URL ao carregar
            const initialRoute = getQuestionFromHash();
            
            if (initialRoute === 'landing') {
                showLandingPage();
            } else if (initialRoute === 'analise') {
                showQuizSection();
                showAnalysisProcess();
            } else if (initialRoute === 'resultado') {
                showQuizSection();
                showFinalResults();
            } else if (typeof initialRoute === 'number') {
                currentQuestion = initialRoute;
                isOnLandingPage = false;
                showQuizSection();
                loadQuestion(currentQuestion);
            }
            
            // ‚úÖ Listener para mudan√ßas de hash (bot√£o voltar do navegador)
            window.addEventListener('hashchange', function() {
                const newRoute = getQuestionFromHash();
                
                if (newRoute === 'landing' && !isOnLandingPage) {
                    showLandingPage();
                } else if (newRoute === 'analise') {
                    showQuizSection();
                    showAnalysisProcess();
                } else if (newRoute === 'resultado') {
                    showQuizSection();
                    showFinalResults();
                } else if (typeof newRoute === 'number' && newRoute !== currentQuestion) {
                    currentQuestion = newRoute;
                    isOnLandingPage = false;
                    showQuizSection();
                    loadQuestion(currentQuestion);
                    
                    // Track navigation via browser back/forward
                    const navEventKey = `QuizBrowserNavigation_${currentQuestion}_${Date.now()}`;
                    eventsTracker.trackOnce('custom', navEventKey, {
                        question_number: currentQuestion + 1,
                        question_hash: hashMap[currentQuestion],
                        navigation_type: 'browser_button'
                    });
                }
            });
            
            // Adicionar event listener ao bot√£o CORRIGIDO
            const startButton = document.getElementById('startQuizBtn');
            if (startButton) {
                startButton.addEventListener('click', startQuiz);
                console.log('‚úÖ Event listener adicionado ao bot√£o');
            } else {
                console.error('‚ùå Bot√£o startQuizBtn n√£o encontrado');
            }

            // ‚úÖ Adicionar event listeners aos bot√µes de navega√ß√£o (COM PROTE√á√ÉO ANTI-DUPLICA√á√ÉO)
            const backBtn = document.getElementById('backBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            if (backBtn && !backBtn.dataset.listenerAdded) {
                backBtn.addEventListener('click', previousQuestion);
                backBtn.dataset.listenerAdded = 'true';
                console.log('‚úÖ Event listener adicionado ao bot√£o Voltar');
            }
            
            if (nextBtn && !nextBtn.dataset.listenerAdded) {
                nextBtn.addEventListener('click', nextQuestion);
                nextBtn.dataset.listenerAdded = 'true';
                console.log('‚úÖ Event listener adicionado ao bot√£o Continuar');
            }
            
            // Track page view inicial
            updateURL('landing');

            console.log('üöÄ Sistema inicializado - Landing page da Dra. Giovana carregada');
            console.log('üì± Dispositivo m√≥vel detectado:', isMobile());
            console.log('üîí Sistema anti-duplica√ß√£o de eventos ativo (em mem√≥ria)');
            console.log('üÜî Event IDs √∫nicos habilitados para compliance com Facebook');
            console.log('üíæ Sistema de persist√™ncia de dados ativo');
        });

        function initializeMobileOptimizations() {
            const isMobileDevice = window.innerWidth <= 768 || /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobileDevice) {
                document.body.style.overscrollBehavior = 'none';
                
                let lastTouchEnd = 0;
                document.addEventListener('touchend', function (event) {
                    const now = (new Date()).getTime();
                    if (now - lastTouchEnd <= 300) {
                        event.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);

                window.addEventListener('orientationchange', function() {
                    setTimeout(() => {
                        window.scrollTo(0, 0);
                    }, 100);
                });

                console.log('üì± Otimiza√ß√µes mobile ativadas');
            }
        }

        function isMobile() {
            return window.innerWidth <= 768 || /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        function showLandingPage() {
            isOnLandingPage = true;
            document.getElementById('landingPage').classList.remove('hidden');
            document.getElementById('quizSection').classList.add('hidden');
            updateURL('landing');
        }

        function showQuizSection() {
            isOnLandingPage = false;
            document.getElementById('landingPage').classList.add('hidden');
            document.getElementById('quizSection').classList.remove('hidden');
        }

        // ‚úÖ FUN√á√ÉO CORRIGIDA - startQuiz (SEM SESSIONSTORAGE)
        function startQuiz() {
            console.log('üéØ Tentando disparar evento "Iniciou formulario"...');
            
            // Pegar refer√™ncia do bot√£o corretamente
            const button = document.getElementById('startQuizBtn');
            
            if (button) {
                // Feedback visual para mobile
                button.classList.add('loading');
                button.innerHTML = 'üöÄ Iniciando...';
            }

            // ‚úÖ EVENTO DE CONVERS√ÉO "Iniciou formulario" - COM EVENT_ID √öNICO
            const eventSent = eventsTracker.trackOnce('custom', 'Iniciou formulario', {
                button_location: 'landing_page',
                button_text: 'Iniciar Minha Dieta Personalizada',
                source: 'landing_page_cta',
                timestamp: new Date().toISOString(),
                user_agent: navigator.userAgent,
                page_url: window.location.href,
                session_id: eventsTracker.sessionId
            });

            if (eventSent) {
                console.log('üéâ EVENTO DE CONVERS√ÉO "Iniciou formulario" ENVIADO COM EVENT_ID √öNICO!');
            }

            // Eventos adicionais de tracking (tamb√©m com event_id √∫nico)
            eventsTracker.trackOnce('standard', 'ViewContent', {
                content_type: 'quiz',
                content_name: 'Quiz In√≠cio',
                content_category: 'landing_page',
                content_ids: ['quiz_nutricional_inicio']
            });
            
            eventsTracker.trackOnce('custom', 'QuizStartButton', {
                button_location: 'landing_page',
                button_text: 'Iniciar Minha Dieta Personalizada'
            });
            
            eventsTracker.trackOnce('custom', 'QuizStarted', {
                quiz_name: 'Avalia√ß√£o Nutricional Dra Giovana',
                quiz_type: 'nutritional_assessment',
                starting_from: 'landing_page'
            });

            // Pequeno delay para feedback visual
            setTimeout(() => {
                currentQuestion = 0;
                showQuizSection();
                loadQuestion(currentQuestion);
                
                console.log('üöÄ Quiz iniciado - Redirecionando para primeira pergunta');
                
                // Scroll suave para o topo
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });

                // Reset button state
                if (button) {
                    button.classList.remove('loading');
                    button.innerHTML = 'üî• Iniciar Minha Dieta Personalizada';
                }
            }, 500);
        }

        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = window.innerWidth > 768 ? 50 : 25;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particlesContainer.appendChild(particle);
            }
        }

        function loadQuestion(index) {
            const question = questions[index];
            const questionNumber = document.getElementById('questionNumber');
            const questionTitle = document.getElementById('questionTitle');
            const questionSubtitle = document.getElementById('questionSubtitle');
            const optionsGrid = document.getElementById('optionsGrid');
            const progressText = document.getElementById('progressText');
            const progressFill = document.getElementById('progressFill');
            const backBtn = document.getElementById('backBtn');
            const nextBtn = document.getElementById('nextBtn');

            const progress = ((index + 1) / questions.length) * 100;
            progressFill.style.width = progress + '%';
            progressText.textContent = `Avalia√ß√£o Nutricional - Etapa ${index + 1} de ${questions.length}`;

            questionNumber.textContent = index + 1;
            questionTitle.textContent = question.title;
            questionSubtitle.textContent = question.subtitle;

            backBtn.style.display = index > 0 ? 'block' : 'none';
            backBtn.dataset.processing = 'false'; // Resetar estado do bot√£o voltar
            
            // ‚úÖ RESETAR ESTADO DO BOT√ÉO CORRETAMENTE
            nextBtn.disabled = true;
            nextBtn.dataset.processing = 'false'; // Garantir que n√£o est√° em processamento
            nextBtn.textContent = index === questions.length - 1 ? 'Finalizar Avalia√ß√£o ‚Üí' : 'Continuar ‚Üí';

            // Track question view
            const questionEventKey = `QuizQuestionViewed_${index}`;
            eventsTracker.trackOnce('custom', questionEventKey, {
                question_number: index + 1,
                question_title: question.title,
                quiz_progress: Math.round(progress)
            });

            if (question.type === 'choice') {
                loadChoiceQuestion(question, optionsGrid);
            } else if (question.type === 'form') {
                loadFormQuestion(question, optionsGrid);
            }
        }

        function loadChoiceQuestion(question, container) {
            container.innerHTML = '';
            container.className = 'options-grid';

            question.options.forEach(option => {
                const optionCard = document.createElement('div');
                optionCard.className = 'option-card';
                if (question.multiSelect) {
                    optionCard.classList.add('multi-select');
                }
                optionCard.dataset.value = option.value;
                
                optionCard.innerHTML = `
                    <div class="option-icon">${option.icon}</div>
                    <div class="option-title">${option.title}</div>
                    <div class="option-description">${option.description}</div>
                `;

                // ‚úÖ CORRIGIR PROBLEMA DO DUPLO CLIQUE - Event listener √∫nico e bem definido
                optionCard.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Evitar cliques m√∫ltiplos durante processamento
                    if (this.dataset.processing === 'true') {
                        return;
                    }
                    
                    this.dataset.processing = 'true';
                    
                    setTimeout(() => {
                        this.dataset.processing = 'false';
                    }, 300);

                    if (question.multiSelect) {
                        handleMultiSelectOption(this, option, container, question);
                    } else {
                        handleSingleSelectOption(this, option, container);
                    }
                });

                container.appendChild(optionCard);
            });
        }

        function handleSingleSelectOption(card, option, container) {
            // Remover sele√ß√£o anterior
            container.querySelectorAll('.option-card').forEach(c => {
                c.classList.remove('selected');
            });
            
            // Selecionar esta op√ß√£o
            card.classList.add('selected');
            
            // Salvar resposta
            const questionKey = getQuestionKey(currentQuestion);
            answers[questionKey] = option.value;
            
            // ‚úÖ HABILITAR BOT√ÉO IMEDIATAMENTE SEM DELAY
            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn) {
                nextBtn.disabled = false;
                console.log(`‚úÖ Op√ß√£o selecionada: ${option.title} - Bot√£o habilitado`);
            }

            // Track selection
            const selectionEventKey = `QuizOptionSelected_${currentQuestion}_${option.value}`;
            eventsTracker.trackOnce('custom', selectionEventKey, {
                question_number: currentQuestion + 1,
                option_value: option.value,
                option_title: option.title,
                is_multi_select: false
            });
        }

        function handleMultiSelectOption(card, option, container, question) {
            const isSelected = card.classList.contains('selected');
            const questionKey = getQuestionKey(currentQuestion);
            
            // Initialize answers array if not exists
            if (!answers[questionKey]) {
                answers[questionKey] = [];
            }
            
            // Special logic for health conditions
            if (questionKey === 'health') {
                if (option.value === 'healthy' && !isSelected) {
                    // If selecting "healthy", deselect all others
                    container.querySelectorAll('.option-card').forEach(c => {
                        c.classList.remove('selected');
                    });
                    card.classList.add('selected');
                    answers[questionKey] = ['healthy'];
                } else if (option.value !== 'healthy' && !isSelected) {
                    // If selecting any condition, remove "healthy"
                    const healthyCard = container.querySelector('[data-value="healthy"]');
                    if (healthyCard) {
                        healthyCard.classList.remove('selected');
                    }
                    
                    card.classList.add('selected');
                    answers[questionKey] = answers[questionKey].filter(val => val !== 'healthy');
                    if (!answers[questionKey].includes(option.value)) {
                        answers[questionKey].push(option.value);
                    }
                } else {
                    // Toggle selection
                    card.classList.toggle('selected');
                    
                    if (isSelected) {
                        answers[questionKey] = answers[questionKey].filter(val => val !== option.value);
                    } else {
                        answers[questionKey].push(option.value);
                    }
                }
            }
            // Special logic for allergies
            else if (questionKey === 'allergies') {
                if (option.value === 'no_allergies' && !isSelected) {
                    container.querySelectorAll('.option-card').forEach(c => {
                        c.classList.remove('selected');
                    });
                    card.classList.add('selected');
                    answers[questionKey] = ['no_allergies'];
                } else if (option.value !== 'no_allergies' && !isSelected) {
                    const noAllergiesCard = container.querySelector('[data-value="no_allergies"]');
                    if (noAllergiesCard) {
                        noAllergiesCard.classList.remove('selected');
                    }
                    
                    card.classList.add('selected');
                    answers[questionKey] = answers[questionKey].filter(val => val !== 'no_allergies');
                    if (!answers[questionKey].includes(option.value)) {
                        answers[questionKey].push(option.value);
                    }
                } else {
                    card.classList.toggle('selected');
                    
                    if (isSelected) {
                        answers[questionKey] = answers[questionKey].filter(val => val !== option.value);
                    } else {
                        answers[questionKey].push(option.value);
                    }
                }
            }
            
            const hasSelection = container.querySelectorAll('.option-card.selected').length > 0;
            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn) {
                nextBtn.disabled = !hasSelection;
                console.log(`‚úÖ Multi-select - Sele√ß√µes: ${hasSelection ? 'Sim' : 'N√£o'} - Bot√£o: ${hasSelection ? 'Habilitado' : 'Desabilitado'}`);
            }

            // Track selection for multi-select
            const selectionEventKey = `QuizOptionSelected_${currentQuestion}_${option.value}_${Date.now()}`;
            eventsTracker.trackOnce('custom', selectionEventKey, {
                question_number: currentQuestion + 1,
                option_value: option.value,
                option_title: option.title,
                is_multi_select: true,
                selection_action: isSelected ? 'deselected' : 'selected'
            });
        }

        function loadFormQuestion(question, container) {
            container.innerHTML = '';
            container.className = 'form-grid';

            question.fields.forEach(field => {
                const inputGroup = document.createElement('div');
                inputGroup.className = 'input-group';
                
                inputGroup.innerHTML = `
                    <label class="input-label" for="${field.name}">${field.label}</label>
                    <input 
                        class="input-field" 
                        type="${field.type}" 
                        name="${field.name}" 
                        placeholder="${field.placeholder}"
                        ${field.type === 'number' ? 'min="1"' : ''}
                    >
                `;

                const input = inputGroup.querySelector('input');

                if (field.type === 'tel') {
                    input.addEventListener('input', function() {
                        let value = this.value.replace(/\D/g, '');
                        if (value.length >= 2) {
                            value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                        }
                        if (value.length >= 10) {
                            value = value.replace(/(\d{4,5})(\d{4})$/, '$1-$2');
                        }
                        this.value = value;
                    });
                }

                input.addEventListener('input', function() {
                    const questionKey = getQuestionKey(currentQuestion);
                    if (!answers[questionKey]) answers[questionKey] = {};
                    answers[questionKey][field.name] = this.value;
                    
                    checkFormCompletion(question);

                    // Track form field completion
                    if (this.value.trim() !== '') {
                        const fieldEventKey = `QuizFormFieldFilled_${currentQuestion}_${field.name}`;
                        eventsTracker.trackOnce('custom', fieldEventKey, {
                            question_number: currentQuestion + 1,
                            field_name: field.name,
                            field_type: field.type
                        });
                    }
                });

                container.appendChild(inputGroup);
            });
        }

        function checkFormCompletion(question) {
            const questionKey = getQuestionKey(currentQuestion);
            const questionAnswers = answers[questionKey] || {};
            
            const allFilled = question.fields.every(field => {
                const value = questionAnswers[field.name];
                return value && value.trim() !== '';
            });
            
            document.getElementById('nextBtn').disabled = !allFilled;

            // Track form completion
            if (allFilled) {
                const formEventKey = `QuizFormCompleted_${currentQuestion}`;
                eventsTracker.trackOnce('custom', formEventKey, {
                    question_number: currentQuestion + 1,
                    form_type: questionKey
                });
            }
        }

        function getQuestionKey(index) {
            const keys = ['goal', 'gender', 'age', 'activity', 'physical', 'health', 'allergies', 'diet', 'contact'];
            return keys[index] || `question_${index}`;
        }

        function nextQuestion() {
            // ‚úÖ PROTE√á√ÉO CONTRA CLIQUES M√öLTIPLOS
            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn && nextBtn.dataset.processing === 'true') {
                console.log('‚ö†Ô∏è Bot√£o j√° est√° processando, ignorando clique');
                return;
            }
            
            if (nextBtn) {
                nextBtn.dataset.processing = 'true';
                nextBtn.disabled = true;
            }
            
            console.log(`‚û°Ô∏è Avan√ßando da pergunta ${currentQuestion + 1} para ${currentQuestion + 2}`);

            // Track question completion
            const completionEventKey = `QuizQuestionCompleted_${currentQuestion}`;
            eventsTracker.trackOnce('custom', completionEventKey, {
                question_number: currentQuestion + 1,
                quiz_progress: Math.round(((currentQuestion + 1) / questions.length) * 100)
            });

            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                loadQuestion(currentQuestion);
                
                // Scroll suave para o topo
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            } else {
                // Track quiz completion
                eventsTracker.trackOnce('custom', 'QuizCompleted', {
                    total_questions: questions.length,
                    user_goal: answers.goal,
                    user_gender: answers.gender
                });
                
                showAnalysisProcess();
                
                // Scroll para o topo na tela de an√°lise tamb√©m
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }
            
            // Reabilitar bot√£o ap√≥s pequeno delay
            setTimeout(() => {
                if (nextBtn) {
                    nextBtn.dataset.processing = 'false';
                }
            }, 500);
        }

        function previousQuestion() {
            // ‚úÖ PROTE√á√ÉO CONTRA CLIQUES M√öLTIPLOS
            const backBtn = document.getElementById('backBtn');
            if (backBtn && backBtn.dataset.processing === 'true') {
                console.log('‚ö†Ô∏è Bot√£o voltar j√° est√° processando, ignorando clique');
                return;
            }
            
            if (currentQuestion > 0) {
                if (backBtn) {
                    backBtn.dataset.processing = 'true';
                }
                
                console.log(`‚¨ÖÔ∏è Voltando da pergunta ${currentQuestion + 1} para ${currentQuestion}`);
                
                currentQuestion--;
                loadQuestion(currentQuestion);
                
                // Scroll suave para o topo
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });

                // Track backward navigation
                const backNavEventKey = `QuizNavigationBack_${currentQuestion}_${Date.now()}`;
                eventsTracker.trackOnce('custom', backNavEventKey, {
                    from_question: currentQuestion + 2,
                    to_question: currentQuestion + 1
                });
                
                // Reabilitar bot√£o ap√≥s pequeno delay
                setTimeout(() => {
                    if (backBtn) {
                        backBtn.dataset.processing = 'false';
                    }
                }, 500);
            }
        }

        function showAnalysisProcess() {
            // ‚úÖ Atualizar URL para an√°lise
            updateURL('analise');
            
            const container = document.getElementById('questionContainer');
            
            // Track analysis start
            eventsTracker.trackOnce('custom', 'AnalysisStarted', {
                user_data_collected: Object.keys(answers).length
            });
            
            container.innerHTML = `
                <div style="text-align: center; padding: 40px 0;">
                    <div style="font-size: 80px; margin-bottom: 20px; animation: doctorPulse 2s ease-in-out infinite;">üë©‚Äç‚öïÔ∏è</div>
                    <h1 style="font-size: 36px; font-weight: 900; margin-bottom: 20px; background: linear-gradient(135deg, var(--primary), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Dra. Giovana Analisando Seus Dados...</h1>
                    <p style="font-size: 18px; color: rgba(255, 255, 255, 0.8); line-height: 1.6; max-width: 600px; margin: 0 auto 40px;">
                        Estou processando suas informa√ß√µes para criar um 
                        <strong>plano nutricional personalizado</strong> baseado em evid√™ncias cient√≠ficas.
                    </p>
                    
                    <!-- Progress Steps -->
                    <div style="max-width: 600px; margin: 0 auto 40px;">
                        <div id="step1" style="display: flex; align-items: center; gap: 20px; padding: 20px; margin-bottom: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; transition: all 0.3s ease;">
                            <div style="font-size: 24px;">üìä</div>
                            <div style="flex: 1; text-align: left; font-weight: 600; color: var(--light);">Calculando metabolismo basal (TMB)</div>
                            <div id="step1-status" style="font-size: 14px; color: rgba(255, 255, 255, 0.7);">Aguardando...</div>
                        </div>
                        <div id="step2" style="display: flex; align-items: center; gap: 20px; padding: 20px; margin-bottom: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; transition: all 0.3s ease;">
                            <div style="font-size: 24px;">üéØ</div>
                            <div style="flex: 1; text-align: left; font-weight: 600; color: var(--light);">Analisando condi√ß√µes de sa√∫de</div>
                            <div id="step2-status" style="font-size: 14px; color: rgba(255, 255, 255, 0.7);">Aguardando...</div>
                        </div>
                        <div id="step3" style="display: flex; align-items: center; gap: 20px; padding: 20px; margin-bottom: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; transition: all 0.3s ease;">
                            <div style="font-size: 24px;">üß¨</div>
                            <div style="flex: 1; text-align: left; font-weight: 600; color: var(--light);">Processando restri√ß√µes alimentares</div>
                            <div id="step3-status" style="font-size: 14px; color: rgba(255, 255, 255, 0.7);">Aguardando...</div>
                        </div>
                        <div id="step4" style="display: flex; align-items: center; gap: 20px; padding: 20px; margin-bottom: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; transition: all 0.3s ease;">
                            <div style="font-size: 24px;">ü•ó</div>
                            <div style="flex: 1; text-align: left; font-weight: 600; color: var(--light);">Criando card√°pio personalizado</div>
                            <div id="step4-status" style="font-size: 14px; color: rgba(255, 255, 255, 0.7);">Aguardando...</div>
                        </div>
                        <div id="step5" style="display: flex; align-items: center; gap: 20px; padding: 20px; margin-bottom: 15px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; transition: all 0.3s ease;">
                            <div style="font-size: 24px;">üì±</div>
                            <div style="flex: 1; text-align: left; font-weight: 600; color: var(--light);">Finalizando protocolo nutricional</div>
                            <div id="step5-status" style="font-size: 14px; color: rgba(255, 255, 255, 0.7);">Aguardando...</div>
                        </div>
                    </div>
                    
                    <!-- Interactive Elements -->
                    <div style="margin-bottom: 30px;">
                        <div style="background: rgba(0, 0, 0, 0.4); border-radius: 20px; padding: 20px; margin-bottom: 20px; border: 1px solid rgba(44, 122, 44, 0.3);">
                            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                <div style="font-size: 28px; animation: rotate 2s linear infinite;">üë©‚Äç‚öïÔ∏è</div>
                                <div>
                                    <div style="font-size: 16px; font-weight: 700; color: var(--accent);">Dra. Giovana trabalhando...</div>
                                    <div id="current-task" style="font-size: 14px; color: rgba(255, 255, 255, 0.8);">Iniciando an√°lise...</div>
                                </div>
                            </div>
                            <div style="background: rgba(255, 255, 255, 0.1); height: 8px; border-radius: 4px; overflow: hidden;">
                                <div id="analysis-progress" style="height: 100%; background: linear-gradient(90deg, var(--primary), var(--accent)); width: 0%; transition: width 0.5s ease; border-radius: 4px;"></div>
                            </div>
                        </div>
                        
                        <!-- Fun Facts Display -->
                        <div id="fun-fact" style="background: rgba(108, 192, 74, 0.1); border: 1px solid rgba(108, 192, 74, 0.3); border-radius: 16px; padding: 20px; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <span style="font-size: 20px;">üí°</span>
                                <span style="font-weight: 700; color: var(--accent);">Voc√™ sabia?</span>
                            </div>
                            <div id="fact-text" style="color: rgba(255, 255, 255, 0.9); line-height: 1.5; transition: opacity 0.3s ease;">
                                O metabolismo basal representa cerca de 60-70% do seu gasto energ√©tico total di√°rio.
                            </div>
                        </div>
                        
                        <!-- Real-time Stats -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="background: rgba(44, 122, 44, 0.1); border: 1px solid rgba(44, 122, 44, 0.3); border-radius: 12px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: 900; color: var(--primary);" id="calc-bmr">Calculando...</div>
                                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.7);">TMB (cal/dia)</div>
                            </div>
                            <div style="background: rgba(108, 192, 74, 0.1); border: 1px solid rgba(108, 192, 74, 0.3); border-radius: 12px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: 900; color: var(--accent);" id="calc-protein">Processando...</div>
                                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.7);">Prote√≠nas (g)</div>
                            </div>
                            <div style="background: rgba(0, 255, 136, 0.1); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 12px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: 900; color: var(--success);" id="calc-calories">Analisando...</div>
                                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.7);">Calorias Meta</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            simulateRealisticAnalysis();
        }

        function simulateRealisticAnalysis() {
            const tasks = [
                "Verificando dados antropom√©tricos...",
                "Calculando taxa metab√≥lica basal...",
                "Analisando n√≠vel de atividade f√≠sica...",
                "Processando objetivo nutricional...",
                "Identificando restri√ß√µes alimentares...",
                "Verificando condi√ß√µes de sa√∫de...",
                "Criando perfil metab√≥lico...",
                "Calculando necessidades cal√≥ricas...",
                "Definindo distribui√ß√£o de macros...",
                "Personalizando card√°pio...",
                "Finalizando protocolo..."
            ];

            const funFacts = [
                "O metabolismo basal representa cerca de 60-70% do seu gasto energ√©tico total di√°rio.",
                "Cada grama de prote√≠na fornece 4 calorias, assim como os carboidratos.",
                "O tecido muscular queima at√© 6x mais calorias que o tecido adiposo em repouso.",
                "Beber √°gua gelada pode aumentar temporariamente seu metabolismo em at√© 30%.",
                "O corpo continua queimando calorias por at√© 24h ap√≥s exerc√≠cios intensos.",
                "Comer prote√≠na pode aumentar seu metabolismo em 15-30% por algumas horas.",
                "O c√©rebro consome cerca de 20% de todas as calorias que voc√™ queima diariamente."
            ];

            let currentStep = 0;
            let taskIndex = 0;
            let progress = 0;
            let factIndex = 0;

            const progressBar = document.getElementById('analysis-progress');
            const currentTask = document.getElementById('current-task');
            const factText = document.getElementById('fact-text');

            // Task rotation
            const taskInterval = setInterval(() => {
                if (taskIndex < tasks.length) {
                    currentTask.textContent = tasks[taskIndex];
                    taskIndex++;
                } else {
                    clearInterval(taskInterval);
                }
            }, 800);

            // Progress bar
            const progressInterval = setInterval(() => {
                if (progress < 100) {
                    progress += Math.random() * 15 + 5; // Random progress increments
                    if (progress > 100) progress = 100;
                    progressBar.style.width = progress + '%';
                } else {
                    clearInterval(progressInterval);
                }
            }, 600);

            // Fun facts rotation
            const factInterval = setInterval(() => {
                if (factIndex < funFacts.length - 1) {
                    factIndex++;
                    factText.style.opacity = '0';
                    setTimeout(() => {
                        factText.textContent = funFacts[factIndex];
                        factText.style.opacity = '1';
                    }, 300);
                } else {
                    clearInterval(factInterval);
                }
            }, 2500);

            // Step-by-step processing with realistic delays
            setTimeout(() => {
                processStep('step1', 'step1-status', 'Calculando TMB...', () => {
                    // Animate BMR calculation
                    animateNumber('calc-bmr', calculateResults().bmr, 1000);
                });
            }, 1200);

            setTimeout(() => {
                completeStep('step1', 'step1-status', '‚úì TMB: ' + calculateResults().bmr + ' cal/dia');
                processStep('step2', 'step2-status', 'Analisando condi√ß√µes...');
            }, 2800);

            setTimeout(() => {
                completeStep('step2', 'step2-status', '‚úì Condi√ß√µes identificadas');
                processStep('step3', 'step3-status', 'Processando restri√ß√µes...');
            }, 4200);

            setTimeout(() => {
                completeStep('step3', 'step3-status', '‚úì Restri√ß√µes processadas');
                processStep('step4', 'step4-status', 'Criando card√°pio...');
                // Animate protein calculation
                animateNumber('calc-protein', calculateResults().protein, 800);
            }, 5800);

            setTimeout(() => {
                completeStep('step4', 'step4-status', '‚úì Card√°pio personalizado');
                processStep('step5', 'step5-status', 'Finalizando...');
                // Animate calories calculation
                animateNumber('calc-calories', calculateResults().targetCalories, 1200);
            }, 7200);

            setTimeout(() => {
                completeStep('step5', 'step5-status', '‚úì Protocolo finalizado');
                currentTask.textContent = 'An√°lise conclu√≠da com sucesso!';
                
                // Clean up intervals
                clearInterval(taskInterval);
                clearInterval(progressInterval);
                clearInterval(factInterval);
                
                // Track analysis completion
                eventsTracker.trackOnce('custom', 'AnalysisCompleted', {
                    user_bmr: calculateResults().bmr,
                    user_target_calories: calculateResults().targetCalories,
                    user_goal: answers.goal
                });
                
                // Show results after a brief pause
                setTimeout(() => {
                    showFinalResults();
                }, 1500);
            }, 8800);
        }

        function processStep(stepId, statusId, message, callback) {
            const step = document.getElementById(stepId);
            const status = document.getElementById(statusId);
            
            step.classList.add('processing');
            status.textContent = message;
            status.style.color = 'var(--primary)';
            
            if (callback) callback();
        }

        function completeStep(stepId, statusId, message) {
            const step = document.getElementById(stepId);
            const status = document.getElementById(statusId);
            
            step.classList.remove('processing');
            step.classList.add('completed');
            status.textContent = message;
            status.style.color = 'var(--success)';
        }

        function animateNumber(elementId, targetValue, duration) {
            const element = document.getElementById(elementId);
            const startValue = 0;
            const increment = targetValue / (duration / 50);
            let currentValue = startValue;
            
            const timer = setInterval(() => {
                currentValue += increment;
                if (currentValue >= targetValue) {
                    currentValue = targetValue;
                    clearInterval(timer);
                }
                element.textContent = Math.round(currentValue).toLocaleString();
                element.style.animation = 'countUp 0.3s ease-out';
            }, 50);
        }

        function calculateResults() {
            const physical = answers.physical || {};
            const weight = parseFloat(physical.weight) || 70;
            const height = parseFloat(physical.height) || 170;
            const targetWeight = parseFloat(physical.target_weight) || weight;
            const gender = answers.gender || 'male';
            const age = answers.age || '26-35';
            const activity = answers.activity || 'moderate';
            const goal = answers.goal || 'maintain';

            const ageRanges = {
                '18-25': 21.5,
                '26-35': 30.5,
                '36-45': 40.5,
                '46-55': 50.5,
                '55+': 60
            };
            const ageValue = ageRanges[age] || 30;

            let bmr;
            if (gender === 'male') {
                bmr = 10 * weight + 6.25 * height - 5 * ageValue + 5;
            } else {
                bmr = 10 * weight + 6.25 * height - 5 * ageValue - 161;
            }

            const activityMultipliers = {
                sedentary: 1.2,
                light: 1.375,
                moderate: 1.55,
                intense: 1.725
            };

            const tdee = Math.round(bmr * (activityMultipliers[activity] || 1.55));

            let targetCalories = tdee;
            let projectedWeightChange = 0;
            let monthsToGoal = 0;

            if (goal === 'lose_weight') {
                targetCalories = Math.round(tdee - 500);
                if (targetWeight && targetWeight < weight) {
                    projectedWeightChange = weight - targetWeight;
                    monthsToGoal = Math.ceil(projectedWeightChange / 2);
                } else {
                    projectedWeightChange = Math.min(weight * 0.1, 10);
                    monthsToGoal = Math.ceil(projectedWeightChange / 2);
                }
            } else if (goal === 'gain_muscle') {
                targetCalories = Math.round(tdee + 300);
                if (targetWeight && targetWeight > weight) {
                    projectedWeightChange = targetWeight - weight;
                    monthsToGoal = Math.ceil(projectedWeightChange / 1);
                } else {
                    projectedWeightChange = 5;
                    monthsToGoal = 5;
                }
            }

            const protein = Math.round(weight * 2.2);
            const fats = Math.round(targetCalories * 0.3 / 9);
            const carbs = Math.round((targetCalories - (protein * 4) - (fats * 9)) / 4);

            const bmi = weight / ((height / 100) ** 2);

            return {
                bmr: Math.round(bmr),
                tdee,
                targetCalories,
                protein,
                carbs,
                fats,
                projectedWeightChange: Math.round(projectedWeightChange * 10) / 10,
                monthsToGoal,
                bmi: Math.round(bmi * 10) / 10,
                currentWeight: weight,
                targetWeight: targetWeight || weight,
                height
            };
        }

        function showFinalResults() {
            // ‚úÖ Atualizar URL para resultado
            updateURL('resultado');
            
            const results = calculateResults();
            const container = document.getElementById('questionContainer');
            
            document.getElementById('progressText').textContent = 'Avalia√ß√£o Conclu√≠da!';
            
            // ‚úÖ SALVAR DADOS PARA RECUPERA√á√ÉO P√ìS-PAGAMENTO
            DataStorage.saveQuizData(answers, results);
            
            // Track results shown
            eventsTracker.trackOnce('custom', 'ResultsShown', {
                user_bmr: results.bmr,
                user_target_calories: results.targetCalories,
                projected_weight_change: results.projectedWeightChange,
                months_to_goal: results.monthsToGoal,
                user_goal: answers.goal
            });
            
            container.innerHTML = `
                <div class="results-container">
                    <div class="success-icon">üéâ</div>
                    <h1 class="reveal-title">An√°lise Nutricional Completa!</h1>
                    <p class="reveal-subtitle">
                        A Dra. Giovana analisou seu perfil e criou um 
                        <strong>plano nutricional cient√≠fico</strong> personalizado para seus objetivos
                    </p>
                    
                    <!-- Social Proof Notifications -->
                    <div id="social-notifications" style="position: fixed; top: 20px; right: 20px; z-index: 1000; width: 300px; max-height: 80vh; overflow: hidden;"></div>
                    <div id="social-notifications-bottom" style="position: fixed; bottom: 20px; right: 20px; z-index: 1000; width: 300px; max-height: 80vh; overflow: hidden;"></div>
                    
                    <div class="results-grid">
                        ${results.projectedWeightChange > 0 ? `
                        <div class="mega-result-card">
                            <div class="result-badge">üéØ PROJE√á√ÉO DE TRANSFORMA√á√ÉO</div>
                            <div class="result-value">${results.projectedWeightChange}kg</div>
                            <div class="result-label">${answers.goal === 'lose_weight' ? 'SER√ÉO ELIMINADOS' : 'DE MASSA MAGRA'}</div>
                            <div class="timeline-row">
                                <span>‚ö°</span>
                                <span>Primeiros resultados: 7-14 dias</span>
                            </div>
                            <div class="timeline-row">
                                <span>üéØ</span>
                                <span>Meta completa: ${results.monthsToGoal} ${results.monthsToGoal === 1 ? 'm√™s' : 'meses'}</span>
                            </div>
                        </div>
                        ` : ''}
                        
                        <div class="results-metrics">
                            <div class="metric-card calories">
                                <div class="metric-icon">üî•</div>
                                <div class="metric-value">${results.targetCalories}</div>
                                <div class="metric-label">Calorias Di√°rias</div>
                                <div class="metric-subtitle">Meta personalizada</div>
                            </div>
                            
                            <div class="metric-card">
                                <div class="metric-icon">ü•©</div>
                                <div class="metric-value">${results.protein}g</div>
                                <div class="metric-label">Prote√≠nas</div>
                                <div class="metric-subtitle">S√≠ntese muscular</div>
                            </div>
                            
                            <div class="metric-card">
                                <div class="metric-icon">üåæ</div>
                                <div class="metric-value">${results.carbs}g</div>
                                <div class="metric-label">Carboidratos</div>
                                <div class="metric-subtitle">Energia sustentada</div>
                            </div>
                            
                            <div class="metric-card">
                                <div class="metric-icon">ü•ë</div>
                                <div class="metric-value">${results.fats}g</div>
                                <div class="metric-label">Gorduras</div>
                                <div class="metric-subtitle">Sa√∫de hormonal</div>
                            </div>
                        </div>
                        
                        <!-- Resultados dos Clientes -->
                        <div style="background: linear-gradient(135deg, rgba(44, 122, 44, 0.15), rgba(108, 192, 74, 0.1)); border: 2px solid rgba(44, 122, 44, 0.3); border-radius: 24px; padding: 25px; margin-bottom: 30px; text-align: center; position: relative; overflow: hidden;">
                            <h3 style="font-size: 24px; font-weight: 900; margin-bottom: 10px; background: linear-gradient(135deg, var(--success), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; line-height: 1.3;">
                                üåü VEJA OS RESULTADOS DOS NOSSOS CLIENTES!
                            </h3>
                            <p style="font-size: 16px; color: rgba(255, 255, 255, 0.8); margin-bottom: 25px; line-height: 1.4;">
                                <strong>+10.000 pessoas</strong> j√° transformaram suas vidas com o Protocolo da Dra. Giovana
                            </p>
                            
                            <!-- Depoimentos em formato mobile otimizado -->
                            <div style="display: flex; flex-direction: column; gap: 20px; margin-bottom: 20px; align-items: center;">
                                <!-- Depoimento 1 -->
                                <div style="background: rgba(0, 0, 0, 0.6); border: 2px solid rgba(0, 255, 136, 0.3); border-radius: 16px; padding: 20px; max-width: 300px; width: 100%; backdrop-filter: blur(10px);">
                                    <div style="display: flex; justify-content: center; margin-bottom: 15px;">
                                        <img src="whatsapp_chat (1).png" alt="Resultado Cliente 1" style="width: 100%; max-width: 260px; height: auto; object-fit: contain; border-radius: 12px;">
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 14px; font-weight: 700; color: var(--success); margin-bottom: 8px;">üì± Cliente Real - Amanda Nunes</div>
                                        <div style="font-size: 13px; color: rgba(255, 255, 255, 0.9); line-height: 1.4;">
                                            <strong>"segui certinho a dieta"</strong> consegui ter os resultados esperados.
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Depoimento 2 -->
                                <div style="background: rgba(0, 0, 0, 0.6); border: 2px solid rgba(108, 192, 74, 0.3); border-radius: 16px; padding: 20px; max-width: 300px; width: 100%; backdrop-filter: blur(10px);">
                                    <div style="display: flex; justify-content: center; margin-bottom: 15px;">
                                        <img src="whatsapp_chat (2).png" alt="Resultado Cliente 2" style="width: 100%; max-width: 260px; height: auto; object-fit: contain; border-radius: 12px;">
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 14px; font-weight: 700; color: var(--accent); margin-bottom: 8px;">üì± Cliente Real - Leticia Rocha</div>
                                        <div style="font-size: 13px; color: rgba(255, 255, 255, 0.9); line-height: 1.4;">
                                            <strong>"Segue os meus resultados"</strong> ap√≥s seguir o seu planejamento.
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Depoimento 3 -->
                                <div style="background: rgba(0, 0, 0, 0.6); border: 2px solid rgba(44, 122, 44, 0.3); border-radius: 16px; padding: 20px; max-width: 300px; width: 100%; backdrop-filter: blur(10px);">
                                    <div style="display: flex; justify-content: center; margin-bottom: 15px;">
                                        <img src="whatsapp_chat (3).png" alt="Resultado Cliente 3" style="width: 100%; max-width: 260px; height: auto; object-fit: contain; border-radius: 12px;">
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 14px; font-weight: 700; color: var(--primary); margin-bottom: 8px;">üì± Cliente Real - Pamela Rocha</div>
                                        <div style="font-size: 13px; color: rgba(255, 255, 255, 0.9); line-height: 1.4;">
                                            <strong>"eu ameiii o resultado"</strong> que tive
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Stats -->
                            <div style="background: rgba(0, 0, 0, 0.4); border-radius: 16px; padding: 20px;">
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; text-align: center;">
                                    <div>
                                        <div style="font-size: 20px; font-weight: 900; color: var(--success);">+10.000</div>
                                        <div style="font-size: 11px; color: rgba(255, 255, 255, 0.8); line-height: 1.2;">Pessoas Transformadas</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 20px; font-weight: 900; color: var(--accent);">98%</div>
                                        <div style="font-size: 11px; color: rgba(255, 255, 255, 0.8); line-height: 1.2;">Taxa de Sucesso</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 20px; font-weight: 900; color: var(--primary);">4.9‚≠ê</div>
                                        <div style="font-size: 11px; color: rgba(255, 255, 255, 0.8); line-height: 1.2;">Avalia√ß√£o M√©dia</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Price Comparison -->
                        <div style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 193, 7, 0.1)); border: 2px solid rgba(255, 215, 0, 0.3); border-radius: 20px; padding: 25px; margin-bottom: 25px; text-align: center;">
                            <h3 style="font-size: 20px; font-weight: 800; color: #FFD700; margin-bottom: 20px; display: flex; align-items: center; justify-content: center; gap: 8px; line-height: 1.3;">
                                üí∞ Comparativo de Investimento
                            </h3>
                            
                            <!-- Compara√ß√£o Vertical para Mobile -->
                            <div style="display: flex; flex-direction: column; gap: 20px; margin-bottom: 20px;">
                                <!-- Nutricionista Presencial -->
                                <div style="background: rgba(255, 51, 102, 0.1); border: 2px solid rgba(255, 51, 102, 0.3); border-radius: 16px; padding: 20px;">
                                    <div style="font-size: 14px; color: rgba(255, 255, 255, 0.8); margin-bottom: 8px;">Nutricionista Presencial</div>
                                    <div style="font-size: 24px; font-weight: 900; color: var(--danger); margin-bottom: 5px;">R$ 350-500</div>
                                    <div style="font-size: 12px; color: rgba(255, 255, 255, 0.6); margin-bottom: 10px;">Por consulta</div>
                                    <div style="font-size: 12px; color: rgba(255, 255, 255, 0.7); line-height: 1.4;">
                                        ‚Ä¢ Apenas 1 consulta<br>
                                        ‚Ä¢ Card√°pio gen√©rico<br>
                                        ‚Ä¢ Sem acompanhamento<br>
                                        ‚Ä¢ Total: R$ 1.500-2.000
                                    </div>
                                </div>
                                
                                <!-- VS -->
                                <div style="font-size: 24px; color: #FFD700; font-weight: 900; padding: 10px;">VS</div>
                                
                                <!-- Protocolo Dra. Giovana -->
                                <div style="background: rgba(0, 255, 136, 0.1); border: 2px solid rgba(0, 255, 136, 0.3); border-radius: 16px; padding: 20px; position: relative; overflow: hidden;">
                                    <div style="position: absolute; top: -3px; right: -3px; background: var(--danger); color: white; padding: 4px 12px; border-radius: 15px; font-size: 10px; font-weight: 800; transform: rotate(12deg);">OFERTA!</div>
                                    <div style="font-size: 14px; color: rgba(255, 255, 255, 0.8); margin-bottom: 8px;">Protocolo Dra. Giovana</div>
                                    <div style="font-size: 24px; font-weight: 900; color: var(--success); margin-bottom: 5px;">R$ 29,90</div>
                                    <div style="font-size: 12px; color: rgba(255, 255, 255, 0.6); margin-bottom: 10px;">Acesso vital√≠cio</div>
                                    <div style="font-size: 12px; color: rgba(255, 255, 255, 0.7); line-height: 1.4;">
                                        ‚Ä¢ Plano personalizado<br>
                                        ‚Ä¢ 200+ receitas<br>
                                        ‚Ä¢ Suporte 90 dias<br>
                                        ‚Ä¢ Atualiza√ß√µes gr√°tis
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: rgba(0, 255, 136, 0.2); border: 1px solid rgba(0, 255, 136, 0.5); border-radius: 12px; padding: 15px;">
                                <div style="font-size: 16px; font-weight: 800; color: var(--success); margin-bottom: 5px;">
                                    üí° Voc√™ economiza mais de R$ 1.470!
                                </div>
                                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.9); line-height: 1.4;">
                                    Invista apenas R$ 29,90 e tenha acesso ao mesmo protocolo profissional com acompanhamento personalizado
                                </div>
                            </div>
                        </div>
                        
                        <!-- CTA Section -->
                        <div class="cta-section">
                            <h3 style="font-size: 22px; font-weight: 800; margin-bottom: 12px; color: var(--light); line-height: 1.3;">üöÄ Seu Plano Nutricional Personalizado</h3>
                            <p style="font-size: 14px; color: rgba(255, 255, 255, 0.8); margin-bottom: 25px; line-height: 1.4;">Protocolo cient√≠fico baseado na sua avalia√ß√£o completa</p>
                            
                            <div style="text-align: left; margin-bottom: 25px;">
                                <div style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 8px;">
                                    <span style="color: var(--success); font-size: 16px; margin-top: 2px;">‚úÖ</span>
                                    <span style="font-size: 13px; line-height: 1.4;">Receitas adaptadas √†s suas restri√ß√µes alimentares</span>
                                </div>
                                <div style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 8px;">
                                    <span style="color: var(--success); font-size: 16px; margin-top: 2px;">‚úÖ</span>
                                    <span style="font-size: 13px; line-height: 1.4;">Lista completa de alimentos permitidos/proibidos</span>
                                </div>
                                <div style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 8px;">
                                    <span style="color: var(--success); font-size: 16px; margin-top: 2px;">‚úÖ</span>
                                    <span style="font-size: 13px; line-height: 1.4;">200+ receitas com instru√ß√µes passo a passo</span>
                                </div>
                                <div style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 8px;">
                                    <span style="color: var(--success); font-size: 16px; margin-top: 2px;">‚úÖ</span>
                                    <span style="font-size: 13px; line-height: 1.4;">Garantia de resultados ou dinheiro de volta</span>
                                </div>
                            </div>
                            
                            <!-- Urgency Timer -->
                            <div style="background: rgba(255, 51, 102, 0.1); border: 1px solid rgba(255, 51, 102, 0.3); border-radius: 16px; padding: 20px; margin-bottom: 20px; text-align: center;">
                                <div style="font-size: 14px; font-weight: 700; color: var(--danger); margin-bottom: 8px;">üî• OFERTA ESPECIAL EXPIRA EM:</div>
                                <div id="countdown" style="font-size: 20px; font-weight: 900; color: var(--danger); font-family: monospace;"></div>
                                <div style="font-size: 12px; color: rgba(255, 255, 255, 0.8); margin-top: 6px;">Restam apenas ${Math.floor(Math.random() * 8) + 3} vagas hoje</div>
                            </div>
                            
                            <div id="checkout-button-container" style="margin-bottom: 15px;">
                                <button id="checkout-btn" style="
                                    background: linear-gradient(135deg, var(--primary), var(--secondary));
                                    color: white;
                                    border: none;
                                    padding: 18px 30px;
                                    border-radius: 16px;
                                    font-size: 16px;
                                    font-weight: 800;
                                    text-transform: uppercase;
                                    letter-spacing: 0.5px;
                                    cursor: pointer;
                                    transition: all 0.3s ease;
                                    box-shadow: 0 8px 32px rgba(44, 122, 44, 0.4);
                                    width: 100%;
                                    max-width: 350px;
                                    position: relative;
                                    overflow: hidden;
                                    outline: none;
                                    -webkit-tap-highlight-color: transparent;
                                " onclick="handleCheckoutClick()" onmouseover="this.style.transform='translateY(-4px) scale(1.02)'; this.style.boxShadow='0 12px 48px rgba(44, 122, 44, 0.6)'" onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 8px 32px rgba(44, 122, 44, 0.4)'">
                                    üîì GARANTIR ACESSO POR R$ 29,90
                                </button>
                            </div>
                            
                            <div style="margin-top: 12px; font-size: 12px; color: rgba(255, 255, 255, 0.7); line-height: 1.3;">
                                ‚úÖ Acesso imediato ‚Ä¢ üí≥ Pagamento seguro ‚Ä¢ üîí Garantia 30 dias
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Start social proof notifications
            startSocialProofNotifications();
            
            // Start countdown timer
            startCountdownTimer();
        }

        function startSocialProofNotifications() {
            const names = [
                "Ana Paula - S√£o Paulo", "Carlos - Rio de Janeiro", "Mariana - Belo Horizonte", 
                "Roberto - Salvador", "Juliana - Bras√≠lia", "Pedro - Fortaleza", 
                "Camila - Porto Alegre", "Lucas - Curitiba", "Fernanda - Recife", 
                "Rafael - Goi√¢nia", "Patr√≠cia - Florian√≥polis", "Bruno - Manaus",
                "Isabella - Natal", "Diego - Jo√£o Pessoa", "Larissa - Campo Grande",
                "Thiago - Vit√≥ria", "Amanda - Aracaju", "Gabriel - Teresina"
            ];

            const actions = [
                "acabou de adquirir o Protocolo Nutricional",
                "completou a avalia√ß√£o e garantiu seu plano",
                "se inscreveu no programa da Dra. Giovana",
                "aderiu ao protocolo personalizado",
                "confirmou seu acesso ao plano nutricional"
            ];

            const containerTop = document.getElementById('social-notifications');
            const containerBottom = document.getElementById('social-notifications-bottom');
            let notificationCount = 0;

            function showNotification(isBottom = false) {
                if (notificationCount >= 24) return;

                const container = isBottom ? containerBottom : containerTop;
                const name = names[Math.floor(Math.random() * names.length)];
                const action = actions[Math.floor(Math.random() * actions.length)];
                const timeAgo = Math.floor(Math.random() * 15) + 1;

                const notification = document.createElement('div');
                notification.style.cssText = `
                    background: rgba(0, 0, 0, 0.9);
                    border: 1px solid rgba(0, 255, 136, 0.3);
                    border-radius: 12px;
                    padding: 15px;
                    margin-bottom: 10px;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
                    transform: translateX(100%);
                    transition: all 0.4s ease;
                    backdrop-filter: blur(10px);
                    position: relative;
                    z-index: 1001;
                `;

                notification.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 40px; height: 40px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px;">üë§</div>
                        <div style="flex: 1;">
                            <div style="font-size: 14px; font-weight: 600; color: var(--light); margin-bottom: 2px;">${name}</div>
                            <div style="font-size: 12px; color: rgba(255, 255, 255, 0.8);">${action}</div>
                            <div style="font-size: 11px; color: rgba(255, 255, 255, 0.6); margin-top: 2px;">h√° ${timeAgo} ${timeAgo === 1 ? 'minuto' : 'minutos'}</div>
                        </div>
                        <div style="color: var(--success); font-size: 16px;">‚úì</div>
                    </div>
                `;

                container.appendChild(notification);

                // Animate in
                setTimeout(() => {
                    notification.style.transform = 'translateX(0)';
                }, 100);

                // Remove after some time
                setTimeout(() => {
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 400);
                }, 6000);

                notificationCount++;
            }

            // Show first notification immediately (top)
            setTimeout(() => showNotification(false), 2000);
            
            // Show first notification bottom after a delay
            setTimeout(() => showNotification(true), 4000);

            // Then show notifications at random intervals alternating between top and bottom
            const interval = setInterval(() => {
                if (notificationCount < 24) {
                    const isBottom = Math.random() > 0.5;
                    showNotification(isBottom);
                } else {
                    clearInterval(interval);
                }
            }, Math.random() * 6000 + 4000);
        }

        function startCountdownTimer() {
            let timeLeft = 15 * 60; // 15 minutes in seconds
            const countdownElement = document.getElementById('countdown');

            function updateCountdown() {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                countdownElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft > 0) {
                    timeLeft--;
                } else {
                    countdownElement.textContent = "OFERTA EXPIRADA";
                    countdownElement.style.color = "#ff3366";
                }
            }

            updateCountdown();
            setInterval(updateCountdown, 1000);
        }

        // Enhanced checkout function with Facebook compliant events + Data Persistence
        function handleCheckoutClick() {
           console.log('Checkout button clicked');

            // ‚úÖ SALVAR DADOS COM SISTEMA ROBUSTO PARA RECUPERA√á√ÉO P√ìS-PAGAMENTO
            try {
                const results = calculateResults();
                
                // Salvar dados completos para recupera√ß√£o
                const savedData = DataStorage.saveQuizData(answers, results);
                
                // Tamb√©m salvar dados espec√≠ficos para checkout
                DataStorage.setItem('checkout_data', {
                    answers: answers,
                    results: results,
                    checkoutInitiatedAt: new Date().toISOString(),
                    checkoutSessionId: eventsTracker.sessionId,
                    userAgent: navigator.userAgent,
                    referrer: document.referrer,
                    pageUrl: window.location.href,
                    userProfile: {
                        goal: answers.goal,
                        gender: answers.gender,
                        age: answers.age,
                        activity: answers.activity,
                        name: answers.contact?.name,
                        email: answers.contact?.email,
                        bmr: results.bmr,
                        targetCalories: results.targetCalories,
                        projectedWeightChange: results.projectedWeightChange,
                        monthsToGoal: results.monthsToGoal
                    }
                });
                
                console.log('üíæ Dados salvos para recupera√ß√£o p√≥s-pagamento:', savedData);
                
            } catch (error) {
                console.error('Erro ao salvar dados para recupera√ß√£o:', error);
            }

            // ‚úÖ EVENTOS FACEBOOK COMPLIANCE - COM EVENT_ID √öNICO
            try {
                const results = calculateResults();
                
                // Gerar um event_id √∫nico para esta sess√£o de checkout
                const checkoutEventId = eventsTracker.generateEventId();
                
                // InitiateCheckout - evento padr√£o do Facebook
                eventsTracker.trackOnce('standard', 'InitiateCheckout', {
                    content_type: 'product',
                    content_name: 'Protocolo Nutricional Dra Giovana',
                    content_ids: ['protocolo_nutricional_001'],
                    content_category: 'Health & Wellness',
                    value: 29.90,
                    currency: 'BRL',
                    num_items: 1,
                    predicted_ltv: 29.90,
                    user_goal: answers.goal,
                    user_bmr: results.bmr,
                    user_target_calories: results.targetCalories
                });
                
                // AddToCart - evento padr√£o do Facebook  
                eventsTracker.trackOnce('standard', 'AddToCart', {
                    content_type: 'product',
                    content_name: 'Protocolo Nutricional Dra Giovana',
                    content_ids: ['protocolo_nutricional_001'],
                    content_category: 'Health & Wellness',
                    value: 29.90,
                    currency: 'BRL',
                    num_items: 1
                });
                
                // Evento customizado para tracking interno
                eventsTracker.trackOnce('custom', 'CheckoutButtonClicked', {
                    price: 29.90,
                    product_name: 'Protocolo Nutricional',
                    product_id: 'protocolo_nutricional_001',
                    checkout_url: 'https://pay.cakto.com.br/4ckeveg_405527',
                    user_profile: {
                        goal: answers.goal,
                        gender: answers.gender,
                        age: answers.age,
                        activity: answers.activity
                    }
                });
                
            } catch (e) {
                console.log('Pixel tracking error:', e);
            }

            // Visual feedback
            const button = document.getElementById('checkout-btn');
            if (button) {
                button.style.background = 'linear-gradient(135deg, #228B22, #32CD32)';
                button.innerHTML = 'üöÄ Redirecionando...';
                button.disabled = true;
            }

            // Multiple redirect attempts for better compatibility
            setTimeout(() => {
                try {
                    // Try window.open first
                    const newWindow = window.open('https://pay.cakto.com.br/4ckeveg_405527', '_blank');
                    
                    // Fallback if popup was blocked
                    if (!newWindow || newWindow.closed || typeof newWindow.closed == 'undefined') {
                        window.location.href = 'https://pay.cakto.com.br/4ckeveg_405527';
                    }
                } catch (e) {
                    // Ultimate fallback
                    window.location.href = 'https://pay.cakto.com.br/4ckeveg_405527';
                }
                
                // Reset button after delay
                setTimeout(() => {
                    if (button) {
                        button.style.background = 'linear-gradient(135deg, var(--primary), var(--secondary))';
                        button.innerHTML = 'üîì GARANTIR ACESSO POR R$ 29,90';
                        button.disabled = false;
                    }
                }, 3000);
            }, 200);
        }

        // Track scroll depth for engagement measurement - com controle de duplica√ß√£o
        let maxScrollDepth = 0;
        window.addEventListener('scroll', function() {
            const scrollPercent = Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100);
            
            if (scrollPercent > maxScrollDepth) {
                maxScrollDepth = scrollPercent;
                
                // Track scroll milestones - evitar duplica√ß√£o
                if (scrollPercent >= 25 && maxScrollDepth < 25) {
                    eventsTracker.trackOnce('custom', 'ScrollDepth25', {});
                } else if (scrollPercent >= 50 && maxScrollDepth < 50) {
                    eventsTracker.trackOnce('custom', 'ScrollDepth50', {});
                } else if (scrollPercent >= 75 && maxScrollDepth < 75) {
                    eventsTracker.trackOnce('custom', 'ScrollDepth75', {});
                } else if (scrollPercent >= 90 && maxScrollDepth < 90) {
                    eventsTracker.trackOnce('custom', 'ScrollDepth90', {});
                }
            }
        });

        // Track time on page - com controle de duplica√ß√£o
        let timeOnPage = 0;
        setInterval(() => {
            timeOnPage += 5;
            
            // Track time milestones - evitar duplica√ß√£o
            if (timeOnPage === 30) {
                eventsTracker.trackOnce('custom', 'TimeOnPage30Seconds', {});
            } else if (timeOnPage === 60) {
                eventsTracker.trackOnce('custom', 'TimeOnPage1Minute', {});
            } else if (timeOnPage === 120) {
                eventsTracker.trackOnce('custom', 'TimeOnPage2Minutes', {});
            } else if (timeOnPage === 300) {
                eventsTracker.trackOnce('custom', 'TimeOnPage5Minutes', {});
            }
        }, 5000);

        // Track page exit intent - evitar duplica√ß√£o
        document.addEventListener('mouseleave', function(e) {
            if (e.clientY <= 0) {
                eventsTracker.trackOnce('custom', 'ExitIntent', {
                    time_on_page: timeOnPage,
                    max_scroll_depth: maxScrollDepth,
                    current_question: currentQuestion + 1
                });
            }
        });

    </script>
</body>
</html>